<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://example.com">
  <title>Prelude | cppblog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Purpose?">
<meta property="og:type" content="article">
<meta property="og:title" content="Prelude">
<meta property="og:url" content="http://example.com/2099/11/11/prelude/index.html">
<meta property="og:site_name" content="cppblog">
<meta property="og:description" content="Purpose?">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2099/11/11/prelude/x.jpeg">
<meta property="og:image" content="http://example.com/2099/11/11/prelude/wintnl.jpeg">
<meta property="og:image" content="http://example.com/2099/11/11/prelude/tds.png">
<meta property="og:image" content="http://example.com/2099/11/11/prelude/processcb.png">
<meta property="og:image" content="http://example.com/2099/11/11/prelude/localtypeview.png">
<meta property="og:image" content="http://example.com/2099/11/11/prelude/foldersexample.png">
<meta property="og:image" content="http://example.com/2099/11/11/prelude/vtableinmemory.png">
<meta property="og:image" content="http://example.com/2099/11/11/prelude/undef.png">
<meta property="og:image" content="http://example.com/2099/11/11/prelude/tracing_undef.png">
<meta property="og:image" content="http://example.com/2099/11/11/prelude/defined.png">
<meta property="article:published_time" content="2099-11-11T08:00:00.000Z">
<meta property="article:modified_time" content="2025-03-17T12:52:48.293Z">
<meta property="article:author" content="cp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2099/11/11/prelude/x.jpeg">
  
    <link rel="alternative" href="/atom.xml" title="cppblog" type="application/atom+xml">
  
  
  <link rel="stylesheet" type="text/css" href="/./main.0cf68a.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #4d4d4d"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="https://raw.githubusercontent.com/Y3A/y3a.github.io/master/cat.jpg" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/">cp</a></h1>
		</hgroup>
		
		<p class="header-subtitle">be better.</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">Home</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">All Posts</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">Links</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">About</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/Y3A" title="github"><i class="icon-github"></i></a>
		        
					<a class="mail" target="_blank" href="mailto:chiefpiectf@gmail.com" title="mail"><i class="icon-mail"></i></a>
		        
					<a class="twitter" target="_blank" href="https://twitter.com/cplearns2h4ck" title="twitter"><i class="icon-twitter"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #4d4d4d"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="https://raw.githubusercontent.com/Y3A/y3a.github.io/master/cat.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">cp</h1>
			</hgroup>
			
			<p class="header-subtitle"><i class="icon icon-quo-left"></i>be better.<i class="icon icon-quo-right"></i></p>
			
			
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/Y3A" title="github"><i class="icon-github"></i></a>
			        
						<a class="mail" target="_blank" href="mailto:chiefpiectf@gmail.com" title="mail"><i class="icon-mail"></i></a>
			        
						<a class="twitter" target="_blank" href="https://twitter.com/cplearns2h4ck" title="twitter"><i class="icon-twitter"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 50%">
				
				
					<li style="width: 100%"><a href="/">Home</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            <article id="post-prelude" class="article article-type-post " itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Prelude
    </h1>
  

        
        <a href="/2099/11/11/prelude/" class="archive-article-date">
  	<time datetime="2099-11-11T08:00:00.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2099-11-11</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Purpose?</p>
<span id="more"></span>

<h2 id="2022-12-26"><a href="#2022-12-26" class="headerlink" title="2022-12-26"></a>2022-12-26</h2><p>Hello visitor, hope you’re having a great day today.</p>
<p>Recently I’ve come to the realisation that I’m slightly more willing to share about myself than I used to perceive.</p>
<p>This post will serve as a stickynote right at the top, both as a diary and an answer to “why are you doing this”.</p>
<p>The sole purpose of this blog used to be for me to document some of my learnings so I can recap in the future(served me well to this point).</p>
<p>However, I narcissistically suppose I’ll attain some sort of clarity in the field of offensive security eventually, and thought it’ll be nice to leave some sort of trail behind so visitors can reference or judge the path I took.</p>
<p>That being said, I’m an entry level learner at this point of time, so hopefully I don’t jinx myself and end up with career in sales or something.</p>
<p>Lastly, I have an interest in Vulnerability Research as well as Red Teaming, and am more than happy to find like minded friends to chat. Ways to get to me are all around this website.</p>
<p>peace and equality.</p>
<h2 id="2022-12-28"><a href="#2022-12-28" class="headerlink" title="2022-12-28"></a>2022-12-28</h2><p>Recent two days have been quite unproductive since my favourite game released a new mode…</p>
<p>I was only able to make little progress experimenting with KLEE, analysed a few toy programs and wrote 1/2 an article.</p>
<p>The more I play with tools the more admiration I have for their creators. Goals of 2023++, which is to attain a working proficiency in cpp.</p>
<p>Holiday is ending so hope I can control myself and properly analyse libxlsxwriter in the next few days and churn out a blog post before 2023.</p>
<p>Another thing on my mind is to constantly remind myself to change the footer of this blog on the first day of the new year. Shows my lack of concern for the real life to a certain extent.</p>
<p>bugs shall come.</p>
<h2 id="2022-12-31"><a href="#2022-12-31" class="headerlink" title="2022-12-31"></a>2022-12-31</h2><p>-1th day of the new year!</p>
<p>Feeling slightly unsatisfied with the state of life now, but changes come slowly.</p>
<p>2022 isn’t a terrible year for me on paper, got accepted into a desirable college and earned 2 certs in infosec.</p>
<p>Everything comes at a price though, and 8760 hours of a 19 year old should be traded for more in return.</p>
<p>That’s a wrap for the 19th regardless, and hopefully the hours of a 20 year old will be put into better use.</p>
<p>Main resolutions are:</p>
<ul>
<li>master cpp to a wizard proficiency.</li>
<li>lose some(a bit(quite a lot(a ton)) of) weight!</li>
<li>learn the japanese language to a research paper reading level</li>
<li>read some books on humanities</li>
</ul>
<p>and of course do hacking, which has been so much a part of my life that it doesn’t have to enter the resolutions pane</p>
<p>Also, cut down on socialising and relationships that are quite taxing on the brain. I’m not the best at context switching.</p>
<p>Sounds so much like a 死肥宅’s writing the more I re-read this…</p>
<p>But if you get the chance to experience my set of life in your next few draws you might realise it’s not at all what it seems like, it’s much more comfortable.</p>
<p>The keyword of 2022 is <code>anticipation</code>.</p>
<p>…</p>
<p>Calender flipped as I was typing, and the building opposite erupted with screams.</p>
<p>Times like this I appreciate the compartmentalisation of modern housing, where every household is its small bubble and honestly that’s all one has to care about.</p>
<p>Yeah empathy is another problem to work on, and the 4th shall aid in that.</p>
<p>freedom and a sprinkle of grit.</p>
<h2 id="2023-01-09"><a href="#2023-01-09" class="headerlink" title="2023-01-09"></a>2023-01-09</h2><p>First babble of the new year!</p>
<p>Have little time to update on security things as the past 9 days were spent on studying Japanese religiously.</p>
<p>Kind of in a dilemma now, because I tend to only do well if I hyperfocus on a subject, but the security community keeps attracting my attention! (Also, want to complete my symbolic execution series asap)</p>
<p>On the other hand learning a new language is pretty exciting too, and it feels more like a sciency subject than humanities.</p>
<p>My learning strategy works in 3 parts. Grammar, Vocabulary and Expressions.</p>
<p>Grammar learning will be mostly from books and blog posts(yes JAPANESE blog posts). I do make notes but no one probably came to this blog to learn japanese so I’ll pass on that.</p>
<p>Vocab will be scenario based, like I’ll walk into the kitchen and learn everything I can see, smell and hear in vocabulary. This is slightly tricky due to the amount of kanjis available, but with a foundation of mandarin it’s much better.</p>
<p>Finally, expressions, or how native people say shit, is learnt by browsing twitter and watching japanese shows.</p>
<p>I try to type in japanese so I get the chance to use it and don’t get rusty as I learn. That means a japanese writing is coming to this blog soon www. The 12-key layout is quite slow for me, but apparently natives use that so as a follower I’ll work hard to get familiar with it.</p>
<p>This coming weekend I’ll continue the learning of symbolic execution, promise.</p>
<p>寝る.</p>
<h2 id="2023-01-20"><a href="#2023-01-20" class="headerlink" title="2023-01-20"></a>2023-01-20</h2><p>Time passes really fast when you began to document it.</p>
<p>Feels like I’ve done absolutely nothing self-improvement related and 2 weeks have passed—-</p>
<p>The days are mainly spent on helping a client(friend?) write a program to group delivery orders based on proximity on a map, and a backend for some attendance tracking website.</p>
<p>Honestly speaking writing software is not the most exciting task for me, but it seems like that’s where the demands are at.</p>
<p>Mainly because I hate the feeling of being clueless when an error occurs while using a third party library. The context switch into understanding and debugging third party code is really tiring!</p>
<p>That’s fine when performing audits though, since the ONLY task is to understand the code.</p>
<p>I guess this is part of the training to unlock more brain usage, so I’ll bear with it.</p>
<p>Also, it’s been a few days since I learned Japanese. This shall serve as a reminder to stay on track and not feel the remorse on 12/31 2023</p>
<p>Saw a post on twitter saying how a person can only master one language in his life, because of some dogshit related to a region in the brain. Without practising empathy and “view things in different perspectives”, I think he is talking nonsense and it motivates me a little to try and prove him wrong.</p>
<p>As I read my previous whines the emotion that comes to mind is actually happiness. Maybe they are right by saying this is the happiest time of my life, but it’s really difficult to experience it in that moment.</p>
<p>By writing, I hope I can gain that realisation on the way instead of it slamming into me in my middle age.</p>
<p>新年快乐.</p>
<h2 id="2023-02-07"><a href="#2023-02-07" class="headerlink" title="2023-02-07"></a>2023-02-07</h2><p>Hello hello from February.</p>
<p>It’s only the second month and my blog update frequency is decreasing, not a good sign.</p>
<p>Honestly I had pretty high hopes for the year, set goals and what not, but haven’t been following them at all.</p>
<p>Been three weeks since I studied Japanese, haven’t exercised and time is just spent on listening to people speak(english, garbage).</p>
<p>I’m starting to feel the increased struggle in self control, as compared to 2018, the other year I set a huge goal. Perhaps this is age catching up.</p>
<p>The only plus point was the continuous study of security shit… which is already a habit and doesn’t require restrain(maybe negative even).</p>
<p>But life has many more aspects to it and it’s important to not hyperfocus on something in the expense of others. This is a common problem I observe among tech people, especially evident in the security space.</p>
<p>It can certainly be abstracted to form a theory of “Knowing your limits”. Not an absolute limit kind, but a reasonable kind.</p>
<p>Recently my body has been giving negative feedbacks, especially during sleep. The exercise routine got to start sometime.</p>
<p>Language, music, humanities and more. It’s all in the mind.</p>
<p>University applications is starting soon too. That’s a trouble to discuss next time.</p>
<p>别给太满.</p>
<h2 id="2023-02-15"><a href="#2023-02-15" class="headerlink" title="2023-02-15"></a>2023-02-15</h2><p>Just yesterday one of the team members completed his service. That was the happiest person I’ve seen in at least a year.</p>
<p>Can’t wait for my turn.</p>
<p>Recently I’ve been working on root cause analysing a mail client. Someone gave me a 1day poc of a logic bug, which you would think is pretty easy to analyse…</p>
<p>Huge ass C++ GUI app without symbols is really painful to reverse. I ended up with names like <code>weird_shit_ass_struct_holding_struct_pointing_to_array_0x155_offset</code>, when it’s probably just nested classes.</p>
<p>I also realised some of my own weaknesses. I’m unfamiliar with windbg scripting, thus unable to think of higher level solutions to automate certain debugging. My knowledge regarding messagequeues and GUI apps in general is also quite terrible, so I should probably start coding and breaking apart GUI apps. Finally I need to work on my naming, and keep it a habit to type structures in the decompiler once I decipher certain member fields so I don’t end up with quadruple type casts and magic number arithmetics in the output.</p>
<p>If I manage to analyse it and bypass the latest patch I might drop it as a blog post, otherwise I’ll have to keep quiet about the current 1day exploit.</p>
<p>Another happy news is that the exercise routine has also commenced! We’re also getting a gym in the office… but I don’t think anyone will use it. I probably won’t have the motivation to bring spare shirts everyday either.</p>
<p>As of today my hate for finance and economics. decreased drastically after a conversation with someone. Can’t believe I’m saying this but maybe I’ll start reading about finance…</p>
<p>Let’s see what life has to offer next.</p>
<p>やばい!</p>
<h2 id="2023-03-19"><a href="#2023-03-19" class="headerlink" title="2023-03-19"></a>2023-03-19</h2><p>こんばんわ from more than a month later!</p>
<p>Can and cannot believe 32 days have already passed. Days feel really slow and sluggish, but looking back its been so long since I’ve updated here.</p>
<p>Fortunately the past month has been rather peaceful and laid back. Nothing outstanding at all that I can remember, and no remarkable fuck ups. On the flip side I’ve not achieved much too. This is especially evident on the learning of Japanese language. I’ve barely made progress/studied since early February.</p>
<p>Weight lose regime is going rather well though, losing about 4 kgs in the past month or so.</p>
<p>Speaking of the things I have done, I’ve applied for my university, attended a course on fuzzing, wrote a tool to redirect filesystem API calls to being serviced in memory for device-less snapshot fuzzing(<a target="_blank" rel="noopener" href="https://github.com/Y3A/hook_fs">https://github.com/Y3A/hook_fs</a>), and researched on some installer LPEs.</p>
<p>Outside of my little bubble, the world is going mad.</p>
<p>First we have US banks collapsing signalling impending economic crisis, then GPT-4 with copilot revolutionizing data presentation and creative work. That’s a hell lot of changes in a month.</p>
<p>Although one may argue it’s merely the surfacing of long ongoing works, the surfacing do make huge impacts. Without the release and proliferation of Chat, AI field certainly would not receive as much support and pressure to concretize research into production tooling. What a time to be alive.</p>
<p>My timeline has also been flooded with AI related topics, without myself actively procuring information. Quite a lot of tech bros are stocking up on books and researching about AI. That prompted me to actually think if I should take a deep dive into AI soon(spoiler: I said yes). My math isn’t good at all, and honestly I don’t have much interest in the conventional side of computing if not for breaking stuff. But I figured out I’ll give it a try at least, after little regrets of not hopping onto the train of smart contract audits due to similar apprehension. <em>There has to be someone who audits AI for bugs right ;)</em></p>
<p>Oh well, I’m so fucking tired now. I hate naps and they take away more from me than I hope to obtain. See you in a technical post soon.</p>
<p>美妙人生的关键在于你能迷上什么.</p>
<h2 id="2023-03-27"><a href="#2023-03-27" class="headerlink" title="2023-03-27"></a>2023-03-27</h2><p>mmmmmm</p>
<p>Just a quick update before March ends~</p>
<p>Life has been rather routine. My day consists of waking up, doing pointless things at conscription, studying, playing fifa and night running. Can’t complain anything about the relative lack of responsibilities and chunks of free time, but still really looking forward to ending it. I plan to take train rides from the south to north of China, stopping by third tier counties and visiting villages. It’s gonna be a desirable break away from technology and identity. That’s if, WW3 doesn’t commence and I don’t break a leg.</p>
<p>As I mentioned previously, I’ve started to read up on some neural network stuff, starting from <a target="_blank" rel="noopener" href="http://neuralnetworksanddeeplearning.com/">http://neuralnetworksanddeeplearning.com/</a>. </p>
<p>Unfortunately my really limited exposure to mathematics led to</p>
<img src="/2099/11/11/prelude/x.jpeg" class="">

<p>And I went down a rabbit hole of <em>MATH BOOKS</em>, 3blue1brown videos and old professor lectures.</p>
<p>It’s a complicated feeling. I’m simultaneously interested and uninterested. Although the concepts and implementations are extremely mesmerizing and complex, it’s just less rewarding and more tiring to study. Hate to admit but I’m also bad at getting myself to learn something new, from scratch. I tend to stick to old and comfy things, which is bad. The goal for now will just be to try and understand the math behind the first two chapters, and write a toy neural network capable to identifying digits. That feels quite rewarding :)</p>
<p>On the topic of security, I’ve been auditing some installers for LPEs and found a couple of 0days. They aren’t extensively used though so I can’t be bothered to report. Maybe I’ll blog about finding LPEs soon, but those are low low hanging fruits and require little technical skills. The takeaway is, you are probably a hair away from system if you compromised a personal computer.</p>
<p>I also hope to reproduce and blog about some kernel CVEs soon.(After the neural network thingy!) Those are tons of fun.</p>
<p>Compared to last year, I don’t think I’m improving as fast and reading as much. It’s slightly demoralising, I’ll try to get up to pace soon!</p>
<p>σ(w⋅x+b).</p>
<h2 id="2023-04-02"><a href="#2023-04-02" class="headerlink" title="2023-04-02"></a>2023-04-02</h2><p>Hello from April!</p>
<p>Just writing a quick update because it’s really late and tomorrow is a Monday again.</p>
<p>Well unfortunately I did not commit to any of my plans written last week, including AI and CVEs and more. Instead I went to read a book called <code>Hackers and Painters</code> by Paul Graham(no regrets at all). I’m about half way through and I can absolutely declare that the high reviews really did it justice. It’s a book packed with insights and thoughts that are incredibly forward and meaningful, but at the same time easy to digest, almost like the wise old village chief holding you by your hands. The author’s predictions of the future at time of writing(2004) is so fucking(forgive me) accurate and surreal. You’ve got to see it for yourself.</p>
<p>I know the book is supposed to spread these great ideas and startup teachings, but my most striking takeaway for now is… webapps are actually really impressive(and practical). I used to look down on web programming and felt that native clients were much better. No particular reason, just the thought of web stuff being “lame” and just a bunch of markup language together. If I had spent a little more thought on that, it would have been very obvious that my viewpoint was biased and shallow and frankly dumb. The web is such an amazing creation! and webapps+browsers are so flexible and ubiquitous we take them for granted. With my newly acquired interest for the web I started learning nextjs and typescript lol, with a goal of making a C2 client/server.</p>
<p>Now you might think that I’m such a fickle and will surely become a jack of some trades(as <strong>they</strong> like to call me, 三脚猫), I’m a firm believer of following your interest. My rationale is: If I keep switching interests, eventually I’ll come back to one of my prior interests and build upon it. It’s like a cycle, and with enough time I’ll be able to max out all of them hahaha. Let’s see how far this one goes.</p>
<p>Fuck that wasn’t quick at all</p>
<p>晚安晚安!</p>
<h2 id="2023-04-24"><a href="#2023-04-24" class="headerlink" title="2023-04-24"></a>2023-04-24</h2><p>Good morning!</p>
<p>Daily update became weekly update and now monthly update 00, but I’ve made my life so boring that there’s nothing really new to talk about.</p>
<p>Lost 8kg in the past 2 months as expected, and 8 more to go. Fell horribly sick a few weeks ago, which kind of made me reconsider quite some things(always happens when I’m sick).</p>
<p>For starters I’m prioritizing health over laziness now, e.g taking fucking vitamins and sleeping early. Kind of makes sense that I should be using this body sparingly if it’s gonna last for 30 more years.</p>
<p>I’m gonna be honest and say that the japanese learning plan is going down the drain! Haven’t touched it since mid feb. Good news is one of the co-workers is starting to learn it too, and he might give me some inspirations to continue.</p>
<p>The ailment messed with my brain, and I lost interest in web development. Instead went back to working on my mini kernel. That turned out to be quite productive as I implemented processes threads and userland. Learnt some differences between linux and windows in that process(pun intended). In linux threads are just mini processes that share memory with each other. Internally they are all represented by a <code>task_struct</code> structure. That’s not the case in windows, where processes are just a container for threads. The kernel <code>EPROCESS</code> structure houses some administrative data like the pagetable and image name, but doesn’t actually execute anything. Each useful process must have at least one thread which is the runner of some code. As a windows fanboy of course I went with the windows ideology of things.</p>
<p>2 weeks later I found an interesting <a target="_blank" rel="noopener" href="https://www.cvedetails.com/cve/CVE-2023-21766/">CVE</a> regarding an information leak in one of the windows minifilter driver. It’s interesting cuz information leaks are rather useful now following the <a target="_blank" rel="noopener" href="https://twitter.com/yarden_shafir/status/1644766236415258633">announcement</a> where microsoft is planning to kill the usual kaslr bypass. However I know nothing about these drivers, so I went back to working on Pavel Yosifovich’s driver programming book, hoping to learn a thing or two before analysing this cve. I’ve got it diffed out already, and it’s a race condition due improper locking, but I don’t know enough to trigger it yet.</p>
<p>Speaking of windows internals, these books just arrived :)</p>
<img src="/2099/11/11/prelude/wintnl.jpeg" class="">

<p>The kind of gift a nerd craves during festive seasons. Reading online books just doesn’t feel the same.</p>
<p>Lastly I subscribed to netflix yesterday to watch this film called True Spirit(it was inspiring). Little did I know it offers films based on regions, and my region has absolutely nothing. Didn’t stop me from watching 4 super old films in two days though. Netflix I’m coming for you soon.</p>
<p>Work is starting tomorrow, hope waking up early can get me back into doing productive things.</p>
<p>nnsask_46</p>
<h2 id="2023-04-28"><a href="#2023-04-28" class="headerlink" title="2023-04-28"></a>2023-04-28</h2><p>Hello from not long later.</p>
<p>I certainly did not plan to write today, but I also never follow my plans so here I am.</p>
<p>While browsing twitter this afternoon I came across a post mentioning <a target="_blank" rel="noopener" href="https://www.deeplearning.ai/short-courses/chatgpt-prompt-engineering-for-developers/">this</a> course. Honestly I’m quite skeptical when it comes to prompt engineering and ChatGPT related courses/books, because everyone’s just trying to milk it for money while it’s still hot and fresh.</p>
<p>Speaking of money allow me to digress. I came across ChatGPT at around early December last year, which was quite before it spread outside the tech circle. First time using it, of course, mindblown, but that was where I stopped. Thinking back at it a few months later, so many things I could’ve done for some profit. Investment was one of them, see chinese tech company 360 Security with a 300% growth. Like almost every decent tech company on the chinese stock market saw a fair amount of growth during the first weeks of ChatGPT’s introduction into china(already a few weeks later than the west). Most tumbled afterwards but that was still an opportunity missed. Also peripheral industries like graphics card/storage/cloud computing have seen pretty good growths, see Nvidia with a 100% increase from late December last year to now. This is one of the rare opportunities where the huge information gap combined with leaps in technology allows for a nerd to outperform an economics geek. Heck, would’ve made decent money even by just selling ChatGPT accounts on Taobao!(banned chinese emails and phones from registering) Quite unfortunate to have missed it. You’ve got to do something when the opportunity presents itself. It doesn’t happen so often.</p>
<p>Coming back to the topic, I decided to give this course a try because it’s made by <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Andrew_Ng">people</a> who surely know their AI well. The course was pretty practical actually, and really straightforward. Now there are generally two types of useful courses. First being those that really blow your mind with some obscure 20 years research deepdive fancy technical dump. These courses are rare to find, tough to learn, extremely valuable but also cost a kidney. The second type is more straightforward, logical and more like a cookbook. Aforementioned course obviously belongs to the latter. Like many management courses, it’s “telling you something” instead of “go find out something”. After finishing these courses I feel like the rules taught are so logical and sensible that a cognitively competent human should be able to formulate them. I guess that’s called learning. Although the course contained useful tips, I don’t feel accomplishment going through it. It’s literally following a guide lol. On the other hand the skillcap for prompt engineering is there, and you can’t expect it to go any more technical than a conversational english course.</p>
<p>When I first started learning programming 3 years ago, my motivation was partly “learn a language that the computer speaks so I can <del>control</del> make friends with it”. It has served me pretty well and I know a handful of them. It’s <del>un</del>fortunate that the next generation wouldn’t need such a goal in mind to learn programming, since LLMs are natural language interpreters.</p>
<p>This experience kinda made me interested in AI again. If com science wants me then I’ll enroll in a math course straightaway. Otherwise goodbye I’m going back to security. Waiting season always sucks doesn’t it.</p>
<p>Not an AI assistant.</p>
<h2 id="2023-05-21"><a href="#2023-05-21" class="headerlink" title="2023-05-21"></a>2023-05-21</h2><p>Hello from late May!</p>
<p>I’m writing from camp while listening to a song by Mayday, how seasonal.</p>
<p>Recently I was forced to attend a military training course(all part of conscription) that will last a month long. That means going to camp and waking up early everyday for a month. As a subpar soldier who absolutely hates waking up early, this is truly a torturous event. Currently just finished the first week so, long way to to. To make things worse, access to other electronics apart from mobile phones are prohibited. Study plan down the drain. I’m not a fan of using my phone for anything apart from esports, because I find it small and easy to overheat. (and it’s near impossible to debug a windows kernel driver on an iphone yeah). Without going into the details of how much I dislike conscription and the military and regimentation and hierarchies, I really abhor them.</p>
<p>So what else can I do if security study has to halt? I started reading this book called 暗时间(translation: “dark” time), which talks about how one’s brain functions(on the abstract level) as well as how to think straight. It’s quite an intense book, by that I mean the content is dense and well cited examples are abundant. I’m currently less than half way through, but I can confidently recommend this book to literally anyone in any field. It’s a remarkable collection and summary of the greatest works in abstract psychology for critical thinking. IMO it’s worth the price even if you use it as a booklist to be introduced to other books.</p>
<p>Some of the ideas I’ve learnt thus far:</p>
<ol>
<li>There are lots of time where your brain is spent idle(“dark” times). For example waiting for transport, queueing for food, taking a stroll, etc. We can extract more out of the brain by using these times to reflect and think, on either problems(all life is problem solving) or ourselves. I practise this by skimming through chunks of technical text/problem statement before engaging a boring task like folding shirts. That way I can digest through the text using idle time.</li>
<li>Don’t memorise conclusions from books, because they are formed based on the writer’s own biases. Instead, remember examples/experiments so you can derive your own theories which are easier to remember. Our own theories are usually easier to remember because we try to link it with knowledge that already exists in our brain. By increasing the links, it’s more probable for a search to reach the desired knowledge. In mandarin, 条条大路通罗马.</li>
<li>Don’t assume something does not/will not exist just because you are unaware of it. It’s good to communicate with others and query for information. Pretty hard to enforce for an introvert but I’ll try.</li>
<li>The inner core of our brain that’s in charge of emotions, desires and survival, has evolved little since pre-historic times. It BELIEVES that we are still in the stone age(wooden age to be precise). This explains many of our behaviours(eating high fat food, afraid of “awkwardness”, emotional) that we want to curb but find it hard to. The Neocortex is relatively evolved, and that’s in charge of logical thinking and reasoning. When we want to quit a certain habit, that’s the rational Neocortex trying to guide us to an end goal. However, stopping these behaviours is a difficult task because the inner core is regarded as superior(survival and reproduction are indeed the top priority all along). A good way to practise controlling your “emotional” inner core is to treat it as an enemy/your child, and use the Neocortex to make decisions. Why not treat the inner core as part of yourself? Because the inner core again, dislikes admitting that it’s wrong and needs to be changed. In fact, it’s so powerful that people tend to use logic to justify their inner desires, but in fact the “logical” reason is not the true driver of their decisions. We must be weary of this behaviour, and try not to always find excuses for the emotional inner brain. In all essence, know that emotions are just signals from your pre-historic counterpart, and you have all the say to ignore or comply.</li>
<li>Innate biasness is ever present. Experiments such as the “rotating mask illusion” and your usual optical illusions explains it all. The brain has its own preset rules, and these rules can override each other based on importance. It helps the brain to quickly come to conclusions(heuristics), but can lead to biased conclusions. The only way to mitigate this is to interact with more people, understand more perspectives and read more books. Also, stay open minded. This solution might be a working solution, but it’s definitely not the only solution. Unknown does not equal to non-existent.</li>
<li>More knowledge sometimes causes less problem solving ability, especially when it comes to creative thinking. When we have general knowledge but lack critical thinking, functional fixedness sets in, causing our thoughts to be very rigid. This is evident in many “think out of the box” puzzles, such as “connect all 9 dots with 4 strokes”, “how to send the lion, rabbit and cabbage acros the river” and the Candle Problem. How to combat this? A helpful way is to break up your chain of thoughts into individual parts. Think of a decision tree. We tend to go down a certain path early in the tree without realising that the solution is in the other path. We should stop at every junction of our thoughts, try to question if that’s really a “must do”, then proceed. This is one reason why rubber ducky debugging works too. By saying our thoughts out, we are questioning our questioning process! And that is how to practise critical thinking.</li>
</ol>
<p>In the past when people ask me what I want to achieve in life, my response is</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">to be happy.</span><br></pre></td></tr></table></figure>
<p> As of today the conclusion has changed to<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">To complete my objective. For now, that is to be happy.</span><br></pre></td></tr></table></figure></p>
<p>yeah stay happy~</p>
<h2 id="2023-06-02"><a href="#2023-06-02" class="headerlink" title="2023-06-02"></a>2023-06-02</h2><p>June June June June</p>
<p>It’s another year of June without holidays, and I still can’t get used to adulthood. Every June/December I’ll start going holiday mood and crave taking a train ride.</p>
<p>I came across an interesting incident yesterday, which is interesting enough for me to document but too rudimentary for a blog post, so here it comes.</p>
<p>While working on a driver to detect remote thread creation, I thought I found a bug in my code.</p>
<p>The general logic is:   </p>
<ul>
<li>Register process and thread callbacks.   </li>
<li>Add each newly created process to a linked list.</li>
<li>For each new thread creation, if it belongs to a process in the linked list(its first thread), remove the process.</li>
<li>If the thread does not belong to any new processes and the creating process is not the same as the created thread’s process, log it as remote.</li>
</ul>
<p> The process callback goes like:<br> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">OnCreateProcessNotify</span><span class="params">(PEPROCESS Process, HANDLE Pid, PPS_CREATE_NOTIFY_INFO CreateInfo)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    UNREFERENCED_PARAMETER(Process);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (CreateInfo == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        <span class="comment">// Process exit</span></span><br><span class="line">        <span class="comment">// Edge case where process has no thread but exits, remove from list</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">auto</span> entry = g_Processes.FindProcess(Pid))</span><br><span class="line">            g_Processes.RemoveProcess(entry);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Process create</span></span><br><span class="line">    <span class="comment">// Add to new processes list</span></span><br><span class="line">    <span class="keyword">auto</span> entry = g_ProcessesPool.Alloc();</span><br><span class="line">    entry-&gt;information.pid = Pid;</span><br><span class="line">    g_Processes.AddProcess(&amp;entry-&gt;link);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>The <code>FindProcess</code> function:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LIST_ENTRY *<span class="title">ProcessesHead::FindProcess</span><span class="params">(HANDLE pid)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LIST_ENTRY *ret = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">SharedLocker&lt;ExecutiveResource&gt; <span class="title">locker</span><span class="params">(m_lock)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> cur = m_head.Flink; cur != &amp;m_head; cur = cur-&gt;Flink) &#123;</span><br><span class="line">        <span class="keyword">auto</span> linkedInfo = CONTAINING_RECORD(cur, LinkedInformation&lt;ProcessInfo&gt;, link);</span><br><span class="line">        <span class="keyword">auto</span> &amp;processInfo = linkedInfo-&gt;information;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (processInfo.pid == pid) &#123;</span><br><span class="line">            ret = cur;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> And the thread callback:<br> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">OnCreateThreadNotify</span><span class="params">(HANDLE ProcessId, HANDLE ThreadId, BOOLEAN Create)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!Create)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// We only care about thread creation</span></span><br><span class="line">    <span class="comment">// Note here ProcessId and ThreadId belongs to target thread</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> remote = PsGetCurrentProcessId() != ProcessId</span><br><span class="line">        &amp;&amp; PsInitialSystemProcess != PsGetCurrentProcess()</span><br><span class="line">        &amp;&amp; PsGetProcessId(PsInitialSystemProcess) != ProcessId;</span><br><span class="line">    <span class="keyword">if</span> (!remote)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check if thread is &quot;true remote&quot; : not first thread in a process</span></span><br><span class="line">    <span class="keyword">auto</span> entry = g_Processes.FindProcess(ProcessId);</span><br><span class="line">    <span class="keyword">if</span> (entry) &#123;</span><br><span class="line">        <span class="comment">// fake remote</span></span><br><span class="line">        g_Processes.RemoveProcess(entry);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// True remote, log it</span></span><br><span class="line">    </span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>At this point I thought I had discovered a potential race condition bug.</p>
<p>I was returning a reference to a link list element from <code>FindProcess</code> for efficiency, which is a really dumb thing to do because it completely voids the purpose of synchronisation objects. Instead, I should be returning a status for found/not found, and the <code>RemoveProcess</code> function can simply do the loop again to remove the target element, this time with an exclusive lock. (The choice of using a fucking linked list for this task is already quite illogical actually.)</p>
<p>The possible exploit scenario here would be to:</p>
<ul>
<li>load up the processes list with thousands of processes with no threads so the search becomes slow</li>
<li>create a thread for the last process to kick off the thread callback</li>
<li>kill off some processes from the start of the list</li>
<li>exit the last process</li>
</ul>
<p>If the stars line up, it’s theoretically possible to get the process callback’s <code>FindProcess</code> to return the same reference as the thread callback’s <code>FindProcess</code>. In this case both callbacks will proceed to delete the same reference, leading to a double free.</p>
<p>So I quickly hacked up a poc to play with this:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;types.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> err(msg) (printf(<span class="meta-string">&quot;[-] Error: %s(0x%08X)\n&quot;</span>, msg, GetLastError()))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ZOMBIE_PROC_COUNT 200</span></span><br><span class="line"></span><br><span class="line">HANDLE handles[ZOMBIE_PROC_COUNT];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CreateZombieProcesses</span><span class="params">(<span class="keyword">int</span> count)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STARTUPINFOW            si;</span><br><span class="line">    PROCESS_INFORMATION     pi;</span><br><span class="line">    si.cb = <span class="keyword">sizeof</span>(STARTUPINFOW);</span><br><span class="line"></span><br><span class="line">    CreateZombieProcesses(ZOMBIE_PROC_COUNT);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] %d Zombie Processes Created.\n&quot;</span>, ZOMBIE_PROC_COUNT);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] Press Anything To Continue...&quot;</span>);</span><br><span class="line">    getchar();</span><br><span class="line"></span><br><span class="line">    CreateProcessW(</span><br><span class="line">        <span class="string">L&quot;C:\\Windows\\System32\\notepad.exe&quot;</span>,</span><br><span class="line">        <span class="literal">NULL</span>,</span><br><span class="line">        <span class="literal">NULL</span>,</span><br><span class="line">        <span class="literal">NULL</span>,</span><br><span class="line">        FALSE,</span><br><span class="line">        CREATE_SUSPENDED,</span><br><span class="line">        <span class="literal">NULL</span>,</span><br><span class="line">        <span class="literal">NULL</span>,</span><br><span class="line">        &amp;si,</span><br><span class="line">        &amp;pi</span><br><span class="line">    );</span><br><span class="line">    TerminateProcess(pi.hProcess, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] Hope For BSOD!&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ZOMBIE_PROC_COUNT; i++)</span><br><span class="line">        TerminateProcess(handles[i], <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CreateZombieProcesses</span><span class="params">(<span class="keyword">int</span> count)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    PFN_NTCREATEPROCESS _NtCreateProcess = <span class="literal">NULL</span>;</span><br><span class="line">    HANDLE              proc;</span><br><span class="line">    NTSTATUS            status;</span><br><span class="line"></span><br><span class="line">    _NtCreateProcess = GetProcAddress(GetModuleHandleA(<span class="string">&quot;ntdll.dll&quot;</span>), <span class="string">&quot;NtCreateProcess&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!_NtCreateProcess) &#123;</span><br><span class="line">        err(<span class="string">&quot;GetProcAddress&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++) &#123;</span><br><span class="line">        _NtCreateProcess(&amp;proc, GENERIC_ALL, <span class="literal">NULL</span>, GetCurrentProcess(), FALSE, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">        handles[i] = proc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>By using <code>NtCreateProcess</code>, I was able to create processes with no initial threads, visible in tools like <code>ProcessHacker</code>.</p>
<img src="/2099/11/11/prelude/tds.png" class="">

<p>To my surprise, none of these empty processes triggered the process callback! Which was really weird because it should literally be a callback for when processes are created.</p>
<p>Knowing that the <code>PspCallProcessNotifyRoutines</code> function is responsible for invoking process callbacks, I spun up IDA to look for cross references to this function.</p>
<img src="/2099/11/11/prelude/processcb.png" class="">

<p>And it turns out that although Microsoft labels the function as a process callback, it’s only invoked when the first thread is created and inserted into the process.</p>
<p>MSDN Docs:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">When a process is created, the process-notify routine runs in the context of the thread that created the new process.</span><br></pre></td></tr></table></figure>
<p>Seems like Windows only regards a process as a true process when there’s an initial thread in it, which IS REALLY CONFUSING because the Windows architecture is known for strongly distinguishing threads and processes, as compared to linux where “oh everything is just a task”.</p>
<p>You can see the <code>PspCallThreadNotifyRoutines</code> function being called right after the process callback is invoked, which also means that the thread callback is inline of the process creation process(pun intended).</p>
<p>Our exploit can therefore never work, because the process is not truly created before the thread callbacks are serviced, and thus cannot be terminated. You can experiment this by registering a thread callback, sleeping for a few seconds and watch your system turn into a 1 core 500mb ram piece of garbage.</p>
<p>At this point I was quite happy that I didn’t write a critical bug, <del>only a terribly designed poc</del> :D</p>
<p>Lessons of the day:<br>Synchronisation bugs are pretty prevalent. Process callbacks aren’t really process callbacks but more like First Thread callbacks. Design your code before writing.</p>
<p>Also, I kind of miss playing ctfs. Maybe because I don’t get much adrenaline rush these days. I applied for a team last week, leader spoke a few words with me and never heard back from them since. I’m guessing that’s a silent rejection. If anyone has a recruiting active ctf team and don’t mind a really rusty player joining, please contact me!</p>
<p>pspspspspspspsp</p>
<h2 id="2023-06-03"><a href="#2023-06-03" class="headerlink" title="2023-06-03"></a>2023-06-03</h2><p>Wtf why am I writing again it’s only been a day.</p>
<p>I have no idea too. Was watching FA Cup and suddenly felt a gush of semi imposter syndrome, have no one to talk to so decided to just pen(keyboard) down some non-substance.</p>
<p>Browsed a lot of skilled peoples’ blogs today, some of which I’ve came across in 2020/2021. 3 years ago I had absolutely no clue regarding what (oh shit nice goal Gundogan) they were then researching/writing about. Now I’m still clueless about their current writings. Probably didn’t express my thoughts clearly but, I have this feeling that I’m not catching up to people at all, and everyone is just constantly moving forward. 2023 is a year of fruitless waiting, and that’s a worse feeling than failure. Waiting drains all my energy while I try to remain optimistic. I’m also terrible at not thinking of the pink elephant, therefore can’t fully context switch to focus on other stuff.</p>
<p>I have a poor memory too. Forgot almost everything I’ve learnt in the past year, and previous year, and of course even earlier before. Kind of feel like a fresh paper now. Guess I have no problem doing short term learning for a cert/exam, but I’ll just flush everything out of RAM afterwards. So now I feel like I know nothing at all, apart from the chapter I read this afternoon.</p>
<p>I wanna be a bug hunter, but can’t take the weeks of staring at code with no progress indicator. I wanna have teammates to discuss things with, but the thought of human interaction wears me out. I wanna win ctfs, but feel like an idiot researching fucking libc.</p>
<p>Probably need to 1. make proper checkpoints and targets while doing VR. 2. get used to interacting with others. 3. just start trying and not quitting.</p>
<p>I also have this image of a perfect future, where a few friends and I stay at a cosy apartment, do some security research/ctfs and play sports daily. I don’t think that’s ever gonna happen though; wishful thinking never works well for me.</p>
<p>I’ll probably be a bug hunter wannabe with no bugs, lots of superficial knowledge but no practical experience, wasting time hopping around topics, all by myself, delusional thinking I’m good but in reality garbage, no opportunities, despise everything I’ve tried a little but didn’t deep dive, maybe change a field completely.</p>
<p>Hopefully not, but that’s exactly me now.</p>
<p>2:1</p>
<h2 id="2023-06-18"><a href="#2023-06-18" class="headerlink" title="2023-06-18"></a>2023-06-18</h2><p>Hey friend, how are you doing. We’ve crossed the halfway mark of 2023! I just ended a long day of duty. Well duty sounds like I’m actually doing work, but that’s not the case. Duty is just me waking up early to report to camp and read a book for a day.</p>
<p>Today I read half of the book <em>Unlocking the Emotional Brain</em>, and as usual felt an urge to express myself(else I won’t be here :p) </p>
<p>The book is eye opening to say the least, and contains lots of case studies to elaborate its theories. I really enjoy books with case studies and examples because I get to pause and predict how the next part of the conversation could turn out to be. Authors Ecker, Hullery and Ticic proposed a rather novel framework(known as the <code>Emotional Coherence Framework</code>) that redesigns the process of therapy. In their framework, symptoms are never pathologised unlike in conventional psychology.</p>
<p>Afaik from the book, most pre-coherence psychology treats symptoms as problems that need to be controlled and suppressed. They therefore favour the use of <code>counteractive</code> methods that aid with symptom management, such as relaxation, positive thinking and chemical intervention. These techniques work by building new synapses in the brain in an attempt to suppress the old synapses that trigger the symptoms.</p>
<p>Emotional Coherence Framework on the other hand believes that symptoms are solutions to problems. If you think of every symptom as a structure, there’s always a <code>problem</code> member and a <code>solution</code> member waiting to be identified. The problem may be fictitious(assumptions) or dated(ptsd type), BUT the brain recognises it as threatening. More specifically, the brain acknowledges the existence of the problem as well as the potential other problem that the solution(in most cases also the symptom) can raise. Implicitly it makes the decision to take the symptom in order to prevent greater harm. Since a large variety of symptoms are learnings by the brain to help itself, Ecker and his team believes that they can be unlearnt.</p>
<p>At this point I started thinking about another observation. It’s not uncommon to see people trying to assume the role of a therapist, might be a friend, a parent or a mentor. The results are often poor, because they tend to focus on the pre-coherence era of suppression, and they do it quite wrongly. A common observation is they try to cut in with their own opinions. It’s almost like they’re only listening just so they can shove their thoughts in once the other party is done. Well even if you have 1000 hard facts to convince the client, the result won’t even be close to a proper session of therapy. The best that could happen in this scenario is the client gets fully convinced, logically, that his symptoms are bullshit and should reasonably be curbed. But that’s not going to help with anything. His logical neocortex may be convinced, but his implicit emotional subcortex is not involved at all. It’s kind of like muscle memory, and it will just flip as per usual the next time something triggers. Giving a lecture on facts is just not going to work(asian parents look here). You can never change another adult’s thoughts unless he is fully trusting, accepting and willing to comply. There are better(more scientific) ways, such as inducing a self-directed, conscious comparison of facts using juxtaposition, but you’ll have to read the book to find out.</p>
<p>Also here’s another random thought. Aren’t structures amazing? Literally everything in the world can be represented as structures. Starting virtually, every single action you do on a computer, every feedback you see, every app you use, can be simplified to performing just one task: updating structures. By updating a screenbuffer structure you see input on screen. By updating the keyboard buffer structure the IO manager receives keystrokes. By updating character and background structures you get fancy little games and logics. It’s similar in the real world. Think of a bottle of shampoo structure with a shampoo liquid member, a container member, a label member and a nozzle member. Structures link chunks of data to other data. The nozzle member links the shampoo bottle to the person showering, like how a switch links the lightbulb to whoever uses it. Once you fully appreciate this, you realise that structure(or “object”) oriented programming is the most natural way to work with stuff. I’m not talking about the loaded modern complex “OOP” paradigm, but simple old structure updates. These structures can be implicit: when you write a file of functions manipulating a structured field of data in C, you’re thinking OOP. That should be the starting point of every planned project.</p>
<p>I’m talking quite a lot of garbage, but trust me I’m trying really hard not to jump around.</p>
<p>Lastly, paper books smell and feel clean. I hate ebooks.</p>
<p>struct</p>
<h2 id="2023-07-10"><a href="#2023-07-10" class="headerlink" title="2023-07-10"></a>2023-07-10</h2><p><em>Blue July, bright July,<br>Month of storms and gorgeous blue;<br>Violet lightnings o’er thy sky,<br>Heavy falls of drenching dew;</em></p>
<p>Hello from July! Been a busy few days without updates, lots of working and thinking about stuff.<br>With the end of my military service approaching(100+ more days) I got to find something to do afterwards.<br>Although I keep saying I’ll lie on the bed for 9 months until I get so fucking bored, I still wanna do some real things. That being said I applied for an internship for vuln research(there weren’t any official procedures I knew so just wrote an email to them), told me I need to send in a resume which I didn’t have, went to make one and now waiting for results.<br>Frankly I don’t care at all about the pay or recognition or whatever. I just want to hack on some stuff with like minded people, and it would be striking a lottery if they are willing to share experiences of working in the field. Really hope I can get in to that.</p>
<p>The past few days were mainly consolidating my learnings on filesystem logic bugs. The techniques dated back to 2015-2020, which sounds ancient but are still very much relavent today. One thing I love about learning old techniques is that you get to see how TTPs develop over the years as these talented frontline researchers constantly push the boundary and discover cool shit. It’s really respectable.</p>
<p>While messing around with some of those, I found a really interesting 0day scenario which I’m dying to share and ask for opinions. It’s quite confusing which party the blame should be on/should care about it. So I did the greedy move and reported to all affected parties, now still under verification. Bug bounty is pretty boring to me still. You’re not really learning anything you’re just doing the same shit over and over again on different releases of different targets. Don’t mind my analogy but I find it really resembling scam phishing clients using social media, like 电诈. You profile a bunch of targets, try to understand it and find something in the first week, and drop those without obvious bugs. By that I mean web bug bounty/filesystem low hanging fruits of course. In contrast deep dive vuln research is so much more motivating and rewarding. </p>
<p>Also I’m reading a book called <code>寒江独钓——Windows 内核安全编程</code> which talks about windows drivers. Although it’s dated(2009) I find it really fascinating and eye opening and I have a great deal of respect for the author. It doesn’t contain the most technical details(by that I mean explanation on flags/behaviours), probably due to age, but it does have a lot of walkthroughs and extended discussions and even walkthroughs of extended discussion materials. I love books that goes on and talk about related case studies/techniques/stories. Unfortunately most authors are really lazy and “leaves it as an exercise to the reader”, but not this author. As an example he talks about attaching a filter driver to keyboard devices to sniff keystrokes, then extending to talk about how it’s easily detectable by scanning the device stack, and how else to do it(hooking the kbd-something driver’s major functions directly), how that can also be detected. Then he mentioned a case study about how QQ(chinese chat app) bought technology from the koreans on anti-sniffing techniques, and how those work, limitations of those and more rabbit hole topics. I guess it’s just a way of organising information that I appreciate, where each chapter is like research into a particular idea covering many possibilities and fun facts. Love it!</p>
<p>Going forward I’ll continue to work on studying/writing windows drivers, hoping to learn more internals in the process. If I get an internship then I’ll go work on that. Fingers crossed!</p>
<p>🎣</p>
<h2 id="2023-08-19"><a href="#2023-08-19" class="headerlink" title="2023-08-19"></a>2023-08-19</h2><p>Hello from August.</p>
<p>As unexpected as things can get, the past few weeks has been the most weird, fucked up and nurturing period in a very long time.</p>
<p>Without going into details, I fucked around and found out. I really did.</p>
<p>Previously I’ve always held a frivolous and carefree attitude towards everything.<br>To put it frankly I was dumb and entitled.</p>
<p>Not sure what you guys thought of your understanding of the world when you’re 19.<br>I certainly thought I knew a lot. I thought I knew what I aspire to do in life, how to do it, the dos and don’ts of society. I thought I knew it all.<br>I thought the only thing important in life is to grind on some work, family is just there for granted, who cares about authority or rules, fuck getting married or a relationship, humans are boring and noisy, I don’t have to care about anything. The worst judgement was me thinking my current life was garbage, and everything will be so much better after military service.</p>
<p>Turns out I was just a rash and stupid overgrown teenager living in my own world, and that’s going to fuck me over sooner or later.<br>Fortunately for me it came sooner.</p>
<p>If you’re like me, please re-think about it all.<br>Sometimes you really don’t need to fuck around to find out.</p>
<p>If you can wake up everyday in the comfort of a bed, able to procure sustenance twice a day, away from ailments or disability or natural disaster, have at least one friend and a loving family, can walk out and enjoy the sun, wind, grass and the scents of freedom without fearing arrest or getting chopped up, your life is fucking amazing and please treasure it.</p>
<p>Anything else, it’s up to you to change it, and you can change your life this exact moment if you desire.<br>Also, as cliche as it sounds, problems are inevitable in life.<br>You’ll never get a prolonged period of “I have absolutely nothing to worry about and I’m so relaxed” ever again.<br>That only happens once when you’re a newborn.<br>Don’t ever hope for that because it’s depressing.<br>Instead, try to seek real happiness, which is independent on the presence of problems.</p>
<p>If you’re still not convinced, try envisioning losing two fingers permanently, getting a late stage colon cancer and attending all the therapies, losing a close family member right now, getting prosecuted and attending court trials with your name all over the papers.<br>Really, let it sink in.<br>Do research, be worried, get fucking anxious and lose sleep.<br>The brain can’t differentiate between real and perceived events.<br>If you try hard enough, you <strong>will</strong> be devastated, disoriented and lose some hair.</p>
<p>But you’ll learn a lot on appreciating life. And freedom.</p>
<p>Maybe you’ll read some books, because books are the only way to hold conversations with these people who actually know their shit.</p>
<p>By <em>The Courage to be Disliked</em>, the only true happiness lies in self acceptance, confidence in others and contribution to others.<br>Staying alone and being pricky leads to nowhere.<br>Seriously, have some morals, some values, and work towards them. Unconditionally.</p>
<p>If you’ve already fucked around, don’t be afraid.<br>Finding out is a lesson, and most of the time the lesson is worth more than the consequence you’re going to pay.<br>Accept it, and move on.</p>
<p>Stepping into adulthood is not about growing a beard or earning some quick cash.<br>It’s more about the increasing lessons to bear in mind, and to give fucks to things worth giving fucks to.</p>
<p>It’s unlike me to not talk about security, so I’ll lightly add on.</p>
<p>A few days ago my bug got fixed by Microsoft, and I got my first CVE.<br>It’s a pretty mesmerizing experience.<br>For a bug that’s pretty useless(imo), ZDI accepted and paid promptly without questions, and Microsoft fixed it in like a week.<br>I’m starting to think Microsoft has some internal research going on that helped to elevate the bug, because from what I submitted there’s no way it’s a 7.8<br>Or maybe they issue CVEs by patches, because that patch is actually pretty huge.<br>See my blog post on it for more details.<br>Following that are all the nice things, having my name on the advisory aside to James Forshaw(really admire his work), followed by extremely talented researchers on X, a chat with one of the strongest research team’s CEO and more.<br>It’s really nice, and I like that feeling of contribution.<br>Try not to let opportunities fly by.</p>
<p>The theme of 2023 has changed from <strong>fruitless anticipation</strong> to <strong>growth</strong>.<br>stay legal and grateful.</p>
<h2 id="2023-09-04"><a href="#2023-09-04" class="headerlink" title="2023-09-04"></a>2023-09-04</h2><p>September.</p>
<p>Although just less than 2 months from the end of my military conscription, I’m not nearly as happy as I previously envisioned.<br>Partly because there’s things on my back, also because I’ve learnt not to anticipate.<br>Just live everyday fully, don’t think into the future.<br>It’s my responsibility to deal with my fuck ups.</p>
<p>On the bright side, I’m probably gonna get an opportunity to do research with industry professionals.<br>I’m really grateful and happy for the opportunity.<br>Doing the thing I enjoy, with like-minded people, and of actual value. Never experienced that before.<br>Even being inside the office and listening to people discussing security stuff behind just brings a smile to my face, idk.<br>Will definitely try my best to contribute to the team, and I’m eternally thankful for this first opportunity.</p>
<p>August-September is a break month for me as usual.<br>The same time last year was spent on grinding 王者荣耀, this year on 永劫无间.<br>The minimal time I’ve spent learning was looking at how to interact with COM and RPC. Those turned out to be really useful.</p>
<p>September 1st I’m back studying.<br>Coincidentally k0shl published a blog post on a Windows LPE, so I went ahead to write an exploit for that.<br>Through this I learnt 2 lessons.</p>
<ol>
<li><p>Don’t be daunted by fancy names. The component is called “Key Isolation in Cryptography New Generation”… something I’ll previously never look into because I know nothing about cryptography. Turns out the bug was just a textbook double API race condition. That rang a bell in me to always think like a magnifier. Although implementation level bugs are super cool, sometimes zooming out and focusing on the flow and object manegement can also net bugs. Also never judge a component by its name or perceived functionality. We are binary exploiters, and can find bugs if it is a binary. </p>
</li>
<li><p>Researchers have their own style, and it results in specific types of bugs. Some hook up procmon and trigger all interface/APIs. Some hunt for constructor/destructor interfaces and check for proper synchronisation. Some look for parser components and fuzz away.  I think I should be conscious of all these styles and always perform those. Like how a pentester follows a checklist, I’m starting to get a faint idea of my checklist for software bugs. Of course compared to implementation level bugs, these are all low hanging fruits. Having a proper understanding of the component is still the most important.</p>
</li>
</ol>
<p>The road ahead is kind of fuzzy(no pun intended), and I guess the best thing to do is to just go ahead.<br>如果被困在雾里看不清方向，就向前多走几步。至少雾散的时候还是前进了。<br>Forgot where I saw this from, but think it makes some sense.</p>
<p>Appreciate.</p>
<h2 id="2023-09-22"><a href="#2023-09-22" class="headerlink" title="2023-09-22"></a>2023-09-22</h2><p>Realised that I wasn’t “not happy”, but in fact I wasn’t allowing myself to be happy.<br>I had(and still have) this idea that feeling super happy is going to make my retributions catch up to me and ruin everything.<br>As dumb as it sounds, I’m quite paranoid of that.</p>
<p>On the other hand keeping myself in check is allowing me to feel more gratitude consciously.<br>I fully acknowledge the luck and blessings in my current life, and it’s as good as it can get.</p>
<p>On one hand I understand that problems and pain are inevitable and I should learn to live in harmony with them, therefore be bold and trusting in the future. However that’s also making me crave for the present, for the comfortable present to stay forever.</p>
<p>Weird right?<br>The only way to combat that is to constantly remind myself to stay in the moment.<br>The feeling of powerlessness arises when you drift beyond yourself.</p>
<p>I’m guessing you skipped all that above because you came to see my study plans these weeks.</p>
<p>Lead my team to revamp some years old spaghetti telegram bot code for conscription, and now it looks much more organized. Coding is really fun when you’re in control, of styles and everything. Every block is like an artwork.</p>
<p>During my free time I watched some talks like <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=OuL-7GPhhAQ">https://www.youtube.com/watch?v=OuL-7GPhhAQ</a> and read the source code of <code>Jackalope</code> fuzzer. I’ve written a code review for it, coming out soon.<br>Initially I wanted to write a fuzzer from scratch, but after some thoughts realised that it was not a good use of time. 1. I have no novel ideas to contribute, so I’ll just be re-inventing the wheel. 2. Modern fuzzers are customizable, and I can understand it by reading. My leader also suggested that manual review finds the best bugs, oh well.</p>
<p>Was also listening to my friend Xu talk about his job hunting experience. He slacked off during his college days, and now spends so much effort travelling around provinces to attend company open days to pass his resume to them. The attempts are hitting triple digits and still no positive callback yet. To whom it may concern, his advice is: Get some work experience at real companies during college if you can. Everyone wants workers with prior experience, but no one is willing to provide for. Society is harsh.</p>
<p>To future me:<br>Microsoft Copilot is coming out soon.<br>That’s a cool new attack surface to explore.   </p>
<h2 id="2023-10-22"><a href="#2023-10-22" class="headerlink" title="2023-10-22"></a>2023-10-22</h2><p>起</p>
<p>又过了一个月。这次是确确实实的一个月了。<br>这似乎是今年间隔最久的一次更新，自然是因为这是今年最忙碌的一个月。</p>
<p>今天的碎碎念为何一改往常？没什么理由，感觉中文写起来比较顺畅。其实平时思考➕和自己对话的时候一般都是中文，除非是在思考英文书籍或影视作品。以前更新的时候还会刻意转化成英文，现在想想倒也没必要。</p>
<p>这实际上是我个人觉得博客相比其他渠道最大的优点：没有推送服务。推送相关的业务一直都是各社媒平台着重研究的领域。为了能精准的把用户所念传达到想法类似的其他用户屏幕上。出发点挺好，实现起来不简单。人从来都是矛盾的。都想成为从始至终想法一致的稳重型，却无法避免双标。</p>
<p>扯远了。结论就是若有读者在博客上读到我今日的碎碎念，那他一定是通过主动搜索我的域名，点进第一条，翻到最底下，发现我更新了《废话合集》甚至点开了翻译功能才能使我的这段文字与他的思想融合在一起。在整个行为链中不存在任何要挟，逼迫或强行投喂等手段，自然不会引起强烈的情绪波动。举个例子。若你在推上看到某傻逼发言，你不由得会想：”吗的，艾克斯公司员工们拼死拼活加班，斥巨资精进算法，就为了让我看到你这段毫无营养的文字？“但如果你是主动浏览他的博客，你大概只会觉得这不符合自己的观点并关闭页面，说不定还能理智思考一番得到升华。</p>
<p>说到理智思考，理智思考的朋友们一定也能得出结论：我刚刚的一番屁话都是在掩盖自己的社恐与自卑，因为不敢在大家能看到的地方发言而找了个借口罢了。自从推上涨粉了之后，我开始不怎么愿意发生活贴或碎碎念了。我觉得这些人来关注我肯定不是为了看这些垃圾而是为了得到安全圈的消息或漏洞相关的poc。所以我就没地方发言了！博客终究还是缺少互动，想法必须得到碰撞，人也必须社交，这是不变的理论，不论你多讨厌多想逃避。</p>
<p>上个月算是非正式入职，工作内容大概就是将一些内核洞武器化。做了一个月还算顺利，其中也有特别炫酷的手法想记录一下，但可能会触发保密条例，暂时就不放上博客了。等正式入职了说不定有机会发出来。规划应该是会把我转去做漏洞挖掘，这实际也是我个人比较向往的岗位，更锻炼创造性。但其实从业务角度来看根本不需要那么多新鲜0day，特别是我的lpe方向，特别特别是没必要培养新手（直接挖人就完事）。资金来源大头还是产品和红队服务，7.8分0day的价值不如武器化的9.8分nday。所以是真的特别感谢老板能给我这个机会扶持我做自己喜欢的东西，明年我个人也应该会着重研究一些remote洞，创造点价值吧。</p>
<p>未来就不过多展望了。世界太多变，今日安好便是福。<br>活在触手可及的范围。</p>
<h2 id="2023-11-15"><a href="#2023-11-15" class="headerlink" title="2023-11-15"></a>2023-11-15</h2><p>算一算也入职两周了。虽然由于出游安排目前只是合同工的状态，但还是过上了朝九晚五每天报道的日子。唯一能想到的槽点就是合同工是没有正版软件和顶级设备用的，但是我倒是无所谓，能加载出代码就好。还有就是每天上班单程要一个半小时，不过这是我的问题不是公司的问题。每天做做自己的研究，中午吃完饭和工友打半小时乒乓，神仙般的日子。</p>
<p>虽然老板啥指标都没要求我，完全自由发挥，但我确实感到了点压力。入职第一周完全花在换设备修设备上。机子老是蓝屏，windows重装了不下五次，好在办法总比困难多，现在算是稳定下来了。但是由于第一周啥也没做，看着每天一起逍遥快活的工友们都能挖出洞，心里还是有点羞愧。今天正好也是微软补丁日，什么时候我的名字也能在上面有一席之地呢？这个驱动也算审计了大半个月了。说实话进展不高，读的时候就能感受到风格比较严谨，由于结构问题也不好fuzz。手动审计速度还要提升。</p>
<p>关于提升我是有想法。我觉得目前问题还是对各种驱动的了解不够深。既然要挖驱动的洞那就应该对该功能的实现有深刻的了解。我的计划是把各种驱动实现一遍，从键盘磁盘过滤，到模拟文件系统，到蓝牙接口，都应该写个小demo。不仅能帮助自己从开发者的角度思考哪里实现起来比较复杂（可能有逻辑洞），更能加快逆向的速度。当然上班的时间是不能搞这些的，所以只能周末慢慢搞起来，我觉得是值得的。</p>
<p>最近认识了不少工友，和大家都很聊得来。毕竟都是年龄相仿的人，且不存在竞争关系，聊两天就熟络了。让我印象最深的是一个本来做ios的研究员现在转做安卓了。（我感觉）他应该前两个月才转，而且已经做出点东西了。如果在目前的方向毫无进展的话，我说不定也会被指派去做linux相关的研究（叹气）。到时候能不能像他一样快速适应就成问题了。</p>
<p>写着写着突然又开始思考了。到底怎么才能挖到内存洞？？？就是fuzz和代码审计两个选择。目前的驱动如果要fuzz，唯一的可能就是找各种迷你parse函数，用snapshot fuzzing来搞。但是一直没有这么做是因为函数实在太有限了。既没有一眼看不懂的逻辑也没有层层递进的调用。每次想逆一点然后交给fuzz的时候，不知不觉已经逆了一大半了。。 在找到真正可fuzz的函数之前，应该还是会继续这样。我相信盲目的fuzz是没有回报的。那么就只剩手动审计这条路了。这并不是我的强项，因为我太容易急躁了。遇到冗长的函数就想不逆前面直接跳到后面，到头来不仅浪费了时间，还把伪代码标得一团糟。一定要记住，在培养出肌肉记忆和超强bug感应之前，老老实实的一行一行逆，从头逆到尾，复杂的就挂上调试器猜。唯一能允许的是跳着找系统API调用来推断结构体成员类。总之任何跳着来的工作都必须是为了满足理解当前这行代码，而不是为了抄近道。埋头傻干无疑是低效的，但不停地想着大局也会让人疲惫。我认为最有效的方法是每天开工前和结束后，从宏观思考这一天应该做的分析。然后分析的时候完全服从就好，别想那么多。</p>
<p>宏观上来说我已经有了审计当前驱动的思路，要的只是专注力和以上所提及的耐心。再搞他个一个月，我就不信出不了洞！如果老板说要转去搞其他的驱动，那就从现有的洞开始做variant分析。通过其他人已有的研究作为基础，了解整个驱动的功能点和曾出过洞的部件。然后再自己思考看看有没有新的突破点。</p>
<p>做研究的迷茫和不自信大多来源于缺乏思考。每天机械的分析各种函数还是出不了洞的时候就会开始怀疑自己的能力。但其实只要时不时停下来思考，想想现在还有什么其他切入点，当前所做的是否是最优选择，就没什么好迷茫的了。如果目前我在做的就是最合理的审计手法，那就放心去做就好了！每个月的补丁日就是最好的考试。如果部件看过了没找到洞，就要思考是不是对漏洞原理不够了解。如果驱动看过了部件没看过，就要思考为什么其他研究员会选择他们选择了并找到洞的切入点，以此来加深自己的bug感应。</p>
<p>年底合同就要到期了。我是很希望能被当作正式工录用继续研究，但要是做不出什么成果我也不好意思向老板开口。现在想这个没什么意义，船到桥头自然直。</p>
<p>赏金猎人，启动！</p>
<h2 id="2023-11-21"><a href="#2023-11-21" class="headerlink" title="2023-11-21"></a>2023-11-21</h2><p>好吧 i lied。并没有按照上周写的按部就班手动审计。因为看了<a target="_blank" rel="noopener" href="https://googleprojectzero.blogspot.com/2020/07/mms-exploit-part-2-effective-fuzzing-qmage.html">p0</a>的博客觉得说得很有道理。在面对一个完全陌生的format并没有源码的时候，硬逆并不明智。</p>
<p>然后就开始写fuzz。我目前fuzz的思路很简单。首先你没fuzz前就得先预想一下大概会出什么样的洞在什么操作，并有针对性的fuzz。能接上instrumentation就一定要接。不能的话就用一些程序本身的校验函数来生成输入，这点能避免很多无效的mutation。至于怎么mutate其实没那么重要。接下来就是corpus的问题。能抓多少抓多少，然后一并简化了用。如果网上没有就自己生成。这里注意熵值能拉多高就拉多高，生成的时候支持的选项全给填上，最好逆一逆看看有没有undocumented的也填上。最后就是trigger了。也是熵怎么高怎么来。先逆一逆收集一下所有支持的交互功能，然后跟sample有关的都随机调用。多开几个线程还能顺便fuzz条件竞争。fuzz的时候开一开page heap或special pool基本就行了。跟Mateusz Jurczyk学的一招就是别写死。既然fuzz本质上就是靠随机，那尽量在fuzzer里面也多加一点随机的逻辑。比如某个目标函数运行特别慢不适合fuzz，那也别完全拿掉，写成小概率会运行。</p>
<p>目前出了几个oob和dos，期待继续深入。<br>S = k ln Ω</p>
<h2 id="2023-12-26"><a href="#2023-12-26" class="headerlink" title="2023-12-26"></a>2023-12-26</h2><p>Exactly one year ago I started this Prelude section, and I’m not regretting it at all. It’s always nice to have some kind of record to look back to and say “hey i’ve gone so far”, and give yourself a pat on the back.</p>
<p>Looking back at my resolutions, I can proudly say I achieved all… but two. I intended to learn japanese but realised that I couldn’t focus on two things at once. In the end I picked security and that’s fine. Another goal was to master c++, but I realised that c++ just feels bad to write. That being said I’ve learnt enough to navigate around decompiled c++, and I can code it slowly if necessary. Wouldn’t call it a win, but I respect my choice. In January, I knew nothing about fuzzing, can’t reverse engineer shit, have no idea what is a  driver and was uncertain on whether to do red teaming or web or binary, on Windows or Linux or whatever. I had no experience finding bugs, found none and only could follow well documented trails of others. Now I’m employed to do security research, have some kernel 0days, a little intuition on how to hunt and a custom fuzzer. The point I’m trying to prove is a year is a long time, and your goals may not be as far away as you think.</p>
<p>Another thing is luck. I’m never saying stuff to maintain a humble image on this section. Everything is raw and real. I am extremely lucky to end up in this position I am now. I’m so lucky I think I might have used up my luck in the future few years. If you read the previous months’ posts you’ll get a sense of how lucky I was. It prompts me to believe in the parallel universe theory, where some me in another universe experiences the bad luck I’ve avoided. I’m really sorry for that. The takeaway here is: things can always take a turn for the worse, and there’s no end to how horrific it can get. Please be thankful of what’s present in this moment, don’t anticipate too far into the future, and accept that sufferings are always going to come and you will deal with it, like all the other people that have dealt with their share of sufferings. It may or may not be your fault, but it’s your responsibility to deal with it for yourself. Please don’t fall into the mentality that someone or something will appear to make stuff better!</p>
<p>In June I said:</p>
<p><em>I also have this image of a perfect future, where a few friends and I stay at a cosy apartment, do some security research/ctfs and play sports daily.</em></p>
<p>Now I have some amazing friends in the company, and we do security research and play table tennis daily.</p>
<p>Life has never been better, and I’m super grateful to be alive. As for the future, resolutions of 2024 will come soon.</p>
<p>Thank you 2023.<br>Happy-go-lucky</p>
<h2 id="2023-12-31"><a href="#2023-12-31" class="headerlink" title="2023-12-31"></a>2023-12-31</h2><p>新年-1天！<br>本来打算睡觉了 想了想最后一天不发点什么有点坏规矩 强忍睡意打开电脑<br>那么就来浅写一点24年的规划吧</p>
<p>上半年不出意外应该老老实实上班 完成每月指标<br>除此之外希望能钻研钻研COM，争取出几个COM相关的洞。COM对现在的我来说真的是巫术般的存在，直觉告诉我这里面肯定有很多等着被挖掘的小惊喜，就等我去深入了解一下。 kernel方面也会用自己写的fuzzer多碰碰，这个我还是蛮有信心的。目标是在p2o vancouver的时候手里还有洞能用。不然的话就争取投个conference吧，这个感觉蛮好玩。还有就是要考个驾照，在七月之前考出来。</p>
<p>下半年要入学了。<br>这个太陌生了，实在不好规划。笼统点说希望交几个朋友，希望住宿请求被通过。其他没什么好想的，还是那句船到桥头自然直。<br>空余时间研究一下remote的东西，踢踢球。暂时就这样。</p>
<p>我知道生活不会像安排的那样干净。每天要考虑的也不只有好好学习和漏洞研究这些纯粹的事情。<br>总会有你根本想不到的烦恼降临。现有的一切也会变动，可好可坏。<br>如果要从23年带一句忠告，那就是《活在触手可及的范围》。<br>只有你能触摸到的东西，包括你自己，才能带来安全感，才可控，才要珍惜。</p>
<p>还有就是做个好人类，再做个守法好公民。<br>屁话说完了。晚安！</p>
<h2 id="2024-01-21"><a href="#2024-01-21" class="headerlink" title="2024-01-21"></a>2024-01-21</h2><p>Hello from January.<br>About last week I received a message from someone saying how he found this section inspiring. I’m happy to hear that someone other than myself enjoys reading my nonsense. In that spirit I’ll continue this section for 2024 and regularly update what I’m up to. It’s also a good way to practise english since I barely use english nowadays.</p>
<p>The plan was to study COM in January, which I did for a week. Then p2o vancouver’s schedule was announced and I no longer have an entry ready, so I decided to dedicate the next &lt;2 months on auditing &lt;redacted&gt;.sys to try and get an entry. I’m optimistic, let’s see how it goes. There was going to be a series of blog posts on COM, but that will have to wait too. Besides that I’m focusing on understanding more heap internals this year so I can improve my bug-&gt;exploit conversion rate. Gonna do some deep reversing into usermode and kernelmode heap internals, and maybe make some posts on those. Some other ideas I have is to make an automated tool to find heap exploitation gadgets(sprayable allocations that yield powerful primitives), as well as a patchdiff bot. Whoever’s reading this can try these projects too if you find them cool!</p>
<p>That being said all of these are expectations that I hope to achieve in the future and have not done yet. I normally dislike writing about stuff that I haven’t finished, because it messes with your brain and tricks it into believing you’ve done the things, leading to a decrement in motivation when actually doing them. On the other hand I don’t want to feel controlled by the brain, so here I am declaring them regardless. Also because I didn’t do much since January. I watched a cdrama called 繁花, went out a few times and started learning driving, kind of a typical pre-U life. Security wise I read on some COM, wrote a 1day exploit and spent the remaining time thinking of what to do. Now I’m done thinking, and the work starts.</p>
<p>-59day</p>
<h2 id="2024-02-02"><a href="#2024-02-02" class="headerlink" title="2024-02-02"></a>2024-02-02</h2><p>These weeks felt different.<br>CNY falls on the 9th of February this year, and since 22nd Jan I’ve been thinking “the next week is CNY”. In reality there’s 3 full weeks to go. But I’m not saying time passed slowly because time flies at work. As a result the weekends also feel much longer compared to when I was in conscription.</p>
<p>Last week vnsec hosted a ctf. I gave some suggestions to one of the challenges while in beta, so I knew the quality and solvability of it. It was a realistic windows kernel pwn, without unnecessary twists or weird constraints, just like how an educational ctf should be. Unfortunately no teams solved it during the competition. That’s kind of disappointing because it could only mean most people don’t bother to do windows stuff, maybe they think it’s troublesome to set up or it’s a consensus among ctf teams to boycott windows challenges idk. The point is linux is still dominant in the ctf scene, and ctf is where most people get started doing security right? It’s difficult to think anyone started security otherwise, like drafting contracts or ROEs. By over saturating the pwn category with linux challenges, it forces people to go deep into linux stuff without having the privilege to think and choose. When they wanna switch to macos or windows there’s a certain sunk cost to it and it discourages the exploration. I think the diversity is missing. It’s unlike me to be concerned about problems of this scale, but my suggestion to newcomers is to explore and try not to get locked in to what the “meta” is, if you’re just doing ctfs to learn.</p>
<p>Also I suddenly have some thoughts regarding courses(context: expensive(relative) live trainings). For starters courses are the best thing to exist. You get condensed and easily accessible information that might come from months of research. Sometimes you get to interact with giants that created them through live lessons. An unintentional sentence could inspire you to do your own research or shift the way you approach a topic. The only downside is really just the cost. Monetary cost I mean. When you start thinking about value-for-money, or ROI, then lots of calculation is involved and you start getting hesitant. For myself at least, I’m unable to accurately put a pricetag to my time and energy. Let’s say there’s this <em>expensive</em> course out there that you could learn something, but you may learn the same from doing a month or two of deep dive. How would you decide? Maybe you can learn deeper or have better retention if you did the deep dive, maybe the course contains experience that you’re not capable of summarising by yourself, maybe it contains insider information. Who knows? The syllabus doesn’t tell, and other people don’t walk your path so it’s hard to quantify what they’ve learnt without revealing too much. I personally can’t convince myself to take those courses on my own money, despite framing it as an investment. I’ve not tagged a price range throughout the discussion because everyone values money differently and it’s pointless to discuss an absolute amount. The reader can apply the scenario to your own context and think about it. I’m still undecided on whether I should take these courses. If I (fantasy time) had the luxury to learn anything I want, I sure will take every single course out there slightly related to my field. It’s always good information, just more or less. In reality I can’t give any advice about money, or the proportion to invest, or how to invest(in yourself). I’ve not figured that out yet. Though I can confidently say try to do something to improve yourself everyday. Co-worker said “if a person improves everyday it’s really scary”. Try to be scary.</p>
<p>越来越像写鸡汤文学的人了。操<br>码字的时候无意把日期标成了2022。我大概还活在2022吧。</p>
<h2 id="2024-02-12"><a href="#2024-02-12" class="headerlink" title="2024-02-12"></a>2024-02-12</h2><p>新年快乐！<br>农历新年的博文当然要用中文发，国外友人们对不住啦。</p>
<p>本想着初一拜个年，结果初三才打开电脑，那只能初三拜了。前天开始放九天小长假，上一次放那么久的假还是在21年底结束alevel的时候。当时也就放了二十多天，（然后就被抓去服兵役了。服役的时候一年只有十四天假，让我十分怀念学生时代的寒暑假。一年能放90多天可真是太幸福了。那两年最大的念想就是退役后在家躺八个月躺到开学。躺到实在是闲得难受烦躁恶心了再出国溜达一圈，找活在海底坐火车从南到北。现实是退役无缝衔接上班💼，所以至今还未体验过闲得发慌的感觉。</p>
<p>大家过年都在干什么呢？好多同龄朋友都回国过年了。以前上学的时候过年都开学了，以后过年也要开学了，说起来今年是最适合回国过年的一年。可惜由于我家里的一些问题今年不太适合回去。要是我早生三四年大概会是很快乐的一次回国旅途吧。所以今年还是一如既往的在sg过年。行程每年都没什么变化：除夕包饺子看春晚，初一赛博拜年躺到晚，初二和家人出去玩，初三找朋友吃顿饭。然后初四大家一般都回去上班🤪，新年结束。我觉得这个节奏刚刚好，不会过得太累也不会无聊。</p>
<p>年前看了看漏洞利用，研究出了个人觉得蛮牛逼的万金油手法。大致就是可以把一个内容长度堆块大小都不可控的池溢出在low il下转为无限任意读写，并不受未来至少两个大版本削弱的影响。不知道会以什么形式跟大家分享，希望不是和某APT撞了然后人家被捕了（WNF说的就是你）。我觉得应该不少人也备好类似的利用了，毕竟要削啥大家都心知肚明，就等微软出手。到时候搞nday的可能会吃香一点，不像现在遍地走，用邻座手机👴的话说就是太原始了。</p>
<p>年后回归主线继续肝p2o。“二月了还是没有出品可能要来不及了”之类的话理论上是没错但心里绝不能这么想。毕竟这东西不是意志力能解决的。</p>
<p>最近和长辈解释我的工作的时候想出了一个非常恰当的类比：考古。<br>我觉得没有比它更像的了，你们细品。</p>
<h2 id="2024-02-18"><a href="#2024-02-18" class="headerlink" title="2024-02-18"></a>2024-02-18</h2><p>Been long since I’ve updated the main blog, but I don’t have any meaningful content that I can write at the moment without involving other stakeholders. Figured out I’ll just write some basic tips for c++ reversing because I don’t see enough about reversing being discussed for bug hunting. It’s not cool enough to live as a post on its own, so I’ll have it here. Context is plain unobfuscated microsoft driver reversing with pdb. Nothing advanced.</p>
<p>First open up the local types view in IDA.</p>
<img src="/2099/11/11/prelude/localtypeview.png" class="">
<p>This is essential because we’ll be creating many types to aid our understanding of the program.</p>
<p>Now for better organisation I like to put custom types into its own folder. Right click anywhere in the local types pane and select <code>Show Folders</code>. You can also group types according to their usages.   </p>
<img src="/2099/11/11/prelude/foldersexample.png" class="">

<p>Assuming we have the following function:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">CClfsLogFcbPhysical *__fastcall <span class="title">CClfsLogFcbPhysical::CClfsLogFcbPhysical</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        CClfsLogFcbPhysical *<span class="keyword">this</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        struct _CLFS_FCB_TABLE_HEADER *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  CClfsLogFcbCommon::CClfsLogFcbCommon(<span class="keyword">this</span>);</span><br><span class="line">  *((_QWORD *)<span class="keyword">this</span> + <span class="number">109</span>) = a2;</span><br><span class="line">  *((_WORD *)<span class="keyword">this</span> + <span class="number">332</span>) = <span class="number">0</span>;</span><br><span class="line">  *(_QWORD *)<span class="keyword">this</span> = &amp;CClfsLogFcbPhysical::`vftable<span class="number">&#x27;</span>&#123;<span class="keyword">for</span> `CClfsLogFcbCommon<span class="number">&#x27;</span>&#125;;</span><br><span class="line">  *((_QWORD *)<span class="keyword">this</span> + <span class="number">85</span>) = <span class="number">0</span>i64;</span><br><span class="line">  *((_QWORD *)<span class="keyword">this</span> + <span class="number">75</span>) = &amp;CClfsLogFcbPhysical::`vftable<span class="number">&#x27;</span>&#123;<span class="keyword">for</span> `IFcbPhysical<span class="number">&#x27;</span>&#125;;</span><br><span class="line">  *((_QWORD *)<span class="keyword">this</span> + <span class="number">86</span>) = <span class="number">0</span>i64;</span><br><span class="line">  *((_QWORD *)<span class="keyword">this</span> + <span class="number">76</span>) = &amp;CClfsLogFcbPhysical::`vftable<span class="number">&#x27;</span>&#123;<span class="keyword">for</span> `IFcbCancelIo<span class="number">&#x27;</span>&#125;;</span><br><span class="line">  *((_DWORD *)<span class="keyword">this</span> + <span class="number">226</span>) = <span class="number">0</span>;</span><br><span class="line">  *((_QWORD *)<span class="keyword">this</span> + <span class="number">77</span>) = &amp;CClfsLogFcbPhysical::`vftable<span class="number">&#x27;</span>&#123;<span class="keyword">for</span> `IPendingRequestQueue<span class="number">&#x27;</span>&#125;;</span><br><span class="line">  *((_QWORD *)<span class="keyword">this</span> + <span class="number">114</span>) = <span class="number">0</span>i64;</span><br><span class="line">  *((_QWORD *)<span class="keyword">this</span> + <span class="number">78</span>) = &amp;CClfsLogFcbPhysical::`vftable<span class="number">&#x27;</span>&#123;<span class="keyword">for</span> `IObservable<span class="number">&#x27;</span>&#125;;</span><br><span class="line">  *((_QWORD *)<span class="keyword">this</span> + <span class="number">79</span>) = &amp;CClfsLogFcbPhysical::`vftable<span class="number">&#x27;</span>&#123;<span class="keyword">for</span> `ILogManagementSupport<span class="number">&#x27;</span>&#125;;</span><br><span class="line">  *((_QWORD *)<span class="keyword">this</span> + <span class="number">115</span>) = <span class="number">0</span>i64;</span><br><span class="line">  *((_QWORD *)<span class="keyword">this</span> + <span class="number">118</span>) = <span class="number">0</span>i64;</span><br><span class="line">  *((_QWORD *)<span class="keyword">this</span> + <span class="number">157</span>) = <span class="number">0</span>i64;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>It’s not difficult to spot that this is a constructor even if the name is not present, because we see offsets being initialized to zero and many vtables referenced. Vtables exist when the class uses virtual methods.</p>
<p>A c++ code that looks like:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CClfsLogFcbCommon</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ULONG64 m_Something;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">CompareLogClientId</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    CClfsLogFcbCommon *cmn = <span class="keyword">new</span> CClfsLogFcbCommon;</span><br><span class="line">    cmn-&gt;CompareLogClientId();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Will look something like this in IDA:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="keyword">this</span> = <span class="built_in">malloc</span>(<span class="number">0x8</span>);</span><br><span class="line">CClfsLogFcbCommon::CompareClientLogId(<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure>
<p>That’s pretty readable and we can leave it as it is.<br>However if the above method is virtual, IDA will show something like:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="keyword">this</span> = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">(*(<span class="keyword">void</span> (__fastcall **))(*(_QWORD *)<span class="keyword">this</span>))(<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure>
<p>This is unacceptable as we have no function name to infer program logic from, which will hinder future reversing efforts.</p>
<p>To understand the above IDA output we’ll need to know how a vtable is layed out in memory. This will be compiler specific and I can only speak for the msvc compiler. The vtable is an array of function pointers, housing all the virtual methods of a class.</p>
<img src="/2099/11/11/prelude/vtableinmemory.png" class="">
<p>The class object in memory always begins with a pointer to its vtable.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*(_QWORD *)<span class="keyword">this</span> = &amp;CClfsLogFcbPhysical::`vftable<span class="number">&#x27;</span>&#123;<span class="keyword">for</span> `CClfsLogFcbCommon<span class="number">&#x27;</span>&#125;;</span><br></pre></td></tr></table></figure>
<p>This is why IDA dereferences the <code>this</code> pointer to find the vtable, then calls the first and only function.</p>
<p>When multiple inheritance is present such as:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span>:</span> <span class="keyword">public</span> Base1, <span class="keyword">public</span> Base2, <span class="keyword">public</span> Base3</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ULONG64 m_Something;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The class will begin with a pointer to a copy of Base1’s vtable, then Base1’s member, pointer to copy of Base2’s vtable… finally Derived’s member. If <code>Derived</code> contains any virtual functions of its own, it will be stored in the copy of Base1’s vtable, after Base1’s methods. If it overrides any inherited virtual functions, it will be stored in place in its respective vtable copy.</p>
<p>IDA doesn’t support classes, but it does support structs and struct inheritance.<br>The proper way to define a c++ class in IDA is to use the <code>__cppobj</code> prefix, which will allow IDA to properly layout the object in memory.</p>
<p>For example we can define the following for an interface:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> __<span class="title">cppobj</span> <span class="title">IFcbCancelIo</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">IFcbCancelIo_vtbl</span> *__<span class="title">vftable</span> /*<span class="title">VFT</span>*/;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>IDA expects the vtable type to be <code>CLASSNAME_vtbl</code> and name to be <code>__vftable</code> so it can properly recognise the vtable.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> /*<span class="title">VFT</span>*/ <span class="title">IFcbCancelIo_vtbl</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">void</span> (__fastcall *InsertIrp)(struct IFcbCancelIo *__hidden <span class="keyword">this</span>, struct IClfsRequestAsync *);</span><br><span class="line">  <span class="keyword">void</span> (__fastcall *RemoveIrp)(struct IFcbCancelIo *__hidden <span class="keyword">this</span>, IRP *);</span><br><span class="line">  <span class="keyword">void</span> (__fastcall *PeekNextIrp)(struct IFcbCancelIo *__hidden <span class="keyword">this</span>, IRP *, <span class="keyword">const</span> CLFS_LSN *);</span><br><span class="line">  <span class="keyword">void</span> (__fastcall *AcquireCancelLock)(struct IFcbCancelIo *__hidden <span class="keyword">this</span>, BYTE *);</span><br><span class="line">  <span class="keyword">void</span> (__fastcall *ReleaseCancelLock)(struct IFcbCancelIo *__hidden <span class="keyword">this</span>);</span><br><span class="line">  <span class="keyword">void</span> (__fastcall *CompleteIrp)(struct IFcbCancelIo *__hidden <span class="keyword">this</span>, IRP *, ULONGLONG, ULONGLONG, BYTE);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>To represent inheritance we’ll need to use struct inheritance:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> __<span class="title">cppobj</span> <span class="title">CClfsLogFcbPhysical</span>:</span> CClfsLogFcbCommon, IObservable, ILogManagementSupport</span><br><span class="line">&#123;&#125;;</span><br></pre></td></tr></table></figure>

<p>After retyping:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">CClfsLogFcbPhysical *__fastcall <span class="title">CClfsLogFcbPhysical::CClfsLogFcbPhysical</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        CClfsLogFcbPhysical *<span class="keyword">this</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        __int64 TableContext)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  CClfsLogFcbCommon::CClfsLogFcbCommon(<span class="keyword">this</span>);</span><br><span class="line">  <span class="keyword">this</span>-&gt;OldTableContext = TableContext;</span><br><span class="line">  *(_WORD *)&amp;<span class="keyword">this</span>-&gt;Unk1[<span class="number">0x18</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">this</span>-&gt;CClfsLogFcbCommon::__vftable = (CClfsLogFcbCommon_vtbl *)&amp;CClfsLogFcbPhysical::`vftable<span class="number">&#x27;</span>&#123;<span class="keyword">for</span> `CClfsLogFcbCommon<span class="number">&#x27;</span>&#125;;</span><br><span class="line">  *(_QWORD *)&amp;<span class="keyword">this</span>-&gt;Unk1[<span class="number">0x28</span>] = <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">this</span>-&gt;IFcbPhysical::__vftable = (IFcbPhysical_vtbl *)&amp;CClfsLogFcbPhysical::`vftable<span class="number">&#x27;</span>&#123;<span class="keyword">for</span> `IFcbPhysical<span class="number">&#x27;</span>&#125;;</span><br><span class="line">  *(_QWORD *)&amp;<span class="keyword">this</span>-&gt;Unk1[<span class="number">0x30</span>] = <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">this</span>-&gt;IFcbCancelIo::__vftable = (IFcbCancelIo_vtbl *)&amp;CClfsLogFcbPhysical::`vftable<span class="number">&#x27;</span>&#123;<span class="keyword">for</span> `IFcbCancelIo<span class="number">&#x27;</span>&#125;;</span><br><span class="line">  *(_DWORD *)<span class="keyword">this</span>-&gt;Unk3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">this</span>-&gt;IPendingRequestQueue::__vftable = (IPendingRequestQueue_vtbl *)&amp;CClfsLogFcbPhysical::`vftable<span class="number">&#x27;</span>&#123;<span class="keyword">for</span> `IPendingRequestQueue<span class="number">&#x27;</span>&#125;;</span><br><span class="line">  *(_QWORD *)&amp;<span class="keyword">this</span>-&gt;Unk3[<span class="number">8</span>] = <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">this</span>-&gt;IObservable::__vftable = (IObservable_vtbl *)&amp;CClfsLogFcbPhysical::`vftable<span class="number">&#x27;</span>&#123;<span class="keyword">for</span> `IObservable<span class="number">&#x27;</span>&#125;;</span><br><span class="line">  <span class="keyword">this</span>-&gt;ILogManagementSupport::__vftable = (ILogManagementSupport_vtbl *)&amp;CClfsLogFcbPhysical::`vftable<span class="number">&#x27;</span>&#123;<span class="keyword">for</span> `ILogManagementSupport<span class="number">&#x27;</span>&#125;;</span><br><span class="line">  *(_QWORD *)&amp;<span class="keyword">this</span>-&gt;Unk3[<span class="number">0x10</span>] = <span class="number">0</span>i64;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>And we get actual method names:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">initializedLogFcb = CClfsLogFcbPhysical::CClfsLogFcbPhysical(logFcbPhysical, TableContext);</span><br><span class="line">initializedLogFcb_ = initializedLogFcb;</span><br><span class="line"><span class="keyword">if</span> ( !initializedLogFcb )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">initializedLogFcb-&gt;AddRef(initializedLogFcb);</span><br></pre></td></tr></table></figure>

<p>The <code>CLASSNAME_vtbl</code> naming tells IDA how to name and type vtable functions when it sees them. The full naming form is actually <code>CLASSNAME_HEXOFFSET_vtbl</code>, where <code>HEXOFFSET</code> is 0 by default since the first vtable is always offset 0.</p>
<p>Why is this important?</p>
<p>Let’s say we have the following:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">b</span><span class="params">(<span class="keyword">int</span> x)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Base::b</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span>:</span> <span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">b</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Derived::b</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d, %d\n&quot;</span>, x, y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>And we type in IDA like:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> __<span class="title">cppobj</span> <span class="title">Derived</span>:</span> Base</span><br><span class="line">&#123;&#125;;</span><br></pre></td></tr></table></figure>
<p>Notice how we have no place to type the overriden method for the derived class. Because we’re relying on IDA struct inheritance, we have to use the <code>CLASSNAME_vtbl</code> format so IDA knows that some methods are overriden and use the derived class’s definitions. We can even go against the rules of c++ here and have different names for an overridden function, if that helps you to label your code better.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Derived_vtbl</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">void</span> (__fastcall *ArbitraryName)(struct Derived *__hidden <span class="keyword">this</span>, <span class="keyword">int</span> x, <span class="keyword">int</span> y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Although we did not include this <code>Derived_vtbl</code> anywhere in the <code>Derived</code> struct, it will automagically be identified by IDA.</p>
<p>If we are inheriting from two base classes and overriding the vtable for the second base class, we’ll create another structure <code>CLASSNAME_0008_vtbl</code>, because the second base class’s vtable is at offset 0x8.</p>
<p>That’s all :)</p>
<h2 id="2024-03-13"><a href="#2024-03-13" class="headerlink" title="2024-03-13"></a>2024-03-13</h2><p>March<br>Don’t have any good news this time! Just some happenings that I can’t talk too detailed.</p>
<p>Yesterday p2o registrations closed, and I did not manage to come up with an entry in time. It kind of sucks that I can’t contribute to my team, but I’ve figured out the reasons along the way. The problem is about switching targets. I switch targets too much, for reasons partially my own and partially uncontrollable. Maybe two months ago I said I was gonna work on &lt;redacted&gt;.sys. Well I switched like 4 targets since then, and that’s a terrible idea. One lesson learnt, deep diving produces results and switching around does not. Around less than 2 weeks left to registration I started opening random drivers in IDA to throw at the fuzzer and look for dumb bugs. Result was 2 dumb bugs but both were not good enough for the competition. Maybe I’ll submit them soon to msrc. Now it’s time to really slow down and deep dive at a target. I could be focusing on finding new attack surfaces, like some unused features that are just on the edge of the bounty scope, but I don’t find that cool. I’d prefer to focus on something many eyes have looked on, and enjoy the rigour of finding stuff others have looked but not seen.</p>
<p>The patch tuesday was a bummer too, for reasons I can’t say. Also microsoft is getting more brute at patching, also for reasons I can’t say. Aside of that pretty surprised Naceri is working in microsoft now. All I recall is him shitting on them and dropping 0days. His work was great inspiration to me though, and I wish him the best in his new role. The old gods of logic bugs: Forshaw Naceri PolarBear. </p>
<p>clfs and cldflt hasn’t been pwned for 2 months already. I bet you teams are stocking up for p2o. Baddest drivers of 2023. I’m pretty excited for the games, it’s the most involved I’ve been and will definitely be a good learning opportunity. </p>
<p>Recently I’ve been thinking a lot about methodology and note taking. Not note taking for knowledge, but bug hunting oriented notes taking. I’m certain the top researchers don’t do everything in their brains. They must have some specific methodology of noting down things. Unfortunately I don’t have the connections to ask around. Almost all my time were spent on coming up with and experimenting with different formats, different methodologies, different ways to abstract code to make it easier for the brain to mix and match.  Feels kind of like coming up with a new martial art. You’ve got to be willing to give up your existing moves, give it the time, start slow maybe against some dummy targets, and build up familiarity. Success may not come soon but it will come eventually.</p>
<h2 id="2024-04-19"><a href="#2024-04-19" class="headerlink" title="2024-04-19"></a>2024-04-19</h2><p>Have the confidence to stay logical and sober at all times. Be the overarching caregiver of the self. </p>
<h2 id="2024-04-22"><a href="#2024-04-22" class="headerlink" title="2024-04-22"></a>2024-04-22</h2><p>It’s time for cp’s IDA tips again!</p>
<h3 id="Register-Misgauge"><a href="#Register-Misgauge" class="headerlink" title="Register Misgauge"></a>Register Misgauge</h3><p>Sometimes when reversing in IDA we see this orange variables that seem to pop out of nowhere.</p>
<img src="/2099/11/11/prelude/undef.png" class="">
<p>One way to find out what these are is to read the disassembly to figure out where their values are populated. (Tip: Press <code>Tab</code> to switch to disassembly listing at current pseudocode hightlight)</p>
<img src="/2099/11/11/prelude/tracing_undef.png" class="">
<p>In this case we see <code>r11d</code> comes from <code>DWORD PTR [rsi+0x28]</code>, which comes from <code>QWORD PTR [rax]</code>, which comes from <code>QWORD PTR [r15+0x30]</code>, and <code>r15</code> is <code>rcx</code> which is the first argument to the function(not shown in image).</p>
<p>The true reason for undefined value is because IDA wrongly assumed that one of the previous functions(in this case <code>RtULongMult_0()</code>) will definitely clobber <code>r11</code>, since it’s supposed be a volatile register and nothing stops the callee from using it. Following that assumption, IDA was not able to comprehend the direct usage of this register after the function call, leading to an undefined value.</p>
<p>The fix is to redefine the offending function’s signature:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NTSTATUS __stdcall __spoils&lt;rax, rcx, r9&gt; RtlULongMult_0(ULONG ulMultiplicand, ULONG ulMultiplier, ULONG *pulResult)</span><br></pre></td></tr></table></figure>
<p>By explicitly marking the registers clobbered using the <code>__spoils</code> keyword, IDA knows <code>r11</code> is not touched and retains the previously set value.</p>
<img src="/2099/11/11/prelude/defined.png" class="">
<p>If we go back and refresh, the undefined orange highlight is gone, a new variable <code>v10</code> is defined automatically, and everything makes sense.</p>
<p>This trick was shared by a coworker, grateful to him ;)</p>
<h3 id="Shifted-Pointers"><a href="#Shifted-Pointers" class="headerlink" title="Shifted Pointers"></a>Shifted Pointers</h3><p>This is quite a common problem as well because in complex software you have structures pointing into other structures for various purposes. I don’t have a sample of real code to show now, but I modelled a realistic scenario.</p>
<p>Assuming you have some objects that are linked together using a singly linked pointer somewhere in its body.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Obj</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DWORD       Magic;</span><br><span class="line">    DWORD       Type;</span><br><span class="line">    CHAR        *Name;</span><br><span class="line">    SLIST_ENTRY Link;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Obj</span> *<span class="title">o1</span> =</span> <span class="literal">NULL</span>, *o2 = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    o1 = HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, <span class="keyword">sizeof</span>(struct Obj));</span><br><span class="line">    o2 = HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, <span class="keyword">sizeof</span>(struct Obj));</span><br><span class="line"></span><br><span class="line">    o1-&gt;Magic = o2-&gt;Magic = <span class="number">0xdeadbeef</span>;</span><br><span class="line">    o1-&gt;Type = <span class="number">0x1</span>;</span><br><span class="line">    o2-&gt;Type = <span class="number">0x2</span>;</span><br><span class="line">    o1-&gt;Link.Next = &amp;o2-&gt;Link;</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">Obj</span> *<span class="title">tmp</span> =</span> o1;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;obj type: 0x%d\n&quot;</span>, tmp-&gt;Type); <span class="comment">// do stuff with o1</span></span><br><span class="line"></span><br><span class="line">        tmp = CONTAINING_RECORD(o1-&gt;Link.Next, struct Obj, Link);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;obj type: 0x%d\n&quot;</span>, tmp-&gt;Type); <span class="comment">// do stuff with o2</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>You may think the entry should be placed at the start of the object and everything will be solved, but in the real code this object can be part of many lists, thus needing many entry fields.</p>
<p>The issue with this code is IDA does not recognize it properly, even with proper structure definitions.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  HANDLE ProcessHeap; <span class="comment">// rax</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">Obj</span> *<span class="title">o1</span>;</span> <span class="comment">// rbx</span></span><br><span class="line">  HANDLE v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">Obj</span> *<span class="title">o2</span>;</span> <span class="comment">// rax</span></span><br><span class="line">  __int64 Type; <span class="comment">// rdx</span></span><br><span class="line"></span><br><span class="line">  ProcessHeap = GetProcessHeap();</span><br><span class="line">  o1 = (struct Obj *)HeapAlloc(ProcessHeap, <span class="number">8u</span>, <span class="number">0x20</span>ui64);</span><br><span class="line">  v5 = GetProcessHeap();</span><br><span class="line">  o2 = (struct Obj *)HeapAlloc(v5, <span class="number">8u</span>, <span class="number">0x20</span>ui64);</span><br><span class="line">  o2-&gt;Magic = <span class="number">-559038737</span>;</span><br><span class="line">  o1-&gt;Type = <span class="number">1</span>;</span><br><span class="line">  o1-&gt;Magic = <span class="number">-559038737</span>;</span><br><span class="line">  o2-&gt;Type = <span class="number">2</span>;</span><br><span class="line">  Type = o1-&gt;Type;</span><br><span class="line">  o1-&gt;Link.Next = &amp;o2-&gt;Link;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;obj type: 0x%d\n&quot;</span>, Type);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;obj type: 0x%d\n&quot;</span>, HIDWORD(o1-&gt;Link.Next[<span class="number">-1</span>].Next));</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Most of it is fine, but when dereferencing <code>o2-&gt;Type</code> for the second print, IDA was unable to infer that <code>o1-&gt;Link.Next</code> points somewhere into <code>o2</code>.</p>
<p>To solve this we just need to edit the structure definition for <code>struct Obj</code>.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Obj</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> Magic;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> Type;</span><br><span class="line">  <span class="keyword">char</span> *Name;</span><br><span class="line">  SLIST_ENTRY *__shifted(Obj,<span class="number">0x10</span>) Link;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>The change tells IDA that the <code>Link</code> member points to an <code>SLIST_ENTRY</code> object, which resides at offset 0x10 of the <code>Obj</code> object.</p>
<p>Going back and refreshing fixes the decompilation output:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  HANDLE ProcessHeap; <span class="comment">// rax</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">Obj</span> *<span class="title">o1</span>;</span> <span class="comment">// rbx</span></span><br><span class="line">  HANDLE v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">Obj</span> *<span class="title">o2</span>;</span> <span class="comment">// rax</span></span><br><span class="line">  __int64 Type; <span class="comment">// rdx</span></span><br><span class="line"></span><br><span class="line">  ProcessHeap = GetProcessHeap();</span><br><span class="line">  o1 = (struct Obj *)HeapAlloc(ProcessHeap, <span class="number">8u</span>, <span class="number">0x20</span>ui64);</span><br><span class="line">  v5 = GetProcessHeap();</span><br><span class="line">  o2 = (struct Obj *)HeapAlloc(v5, <span class="number">8u</span>, <span class="number">0x20</span>ui64);</span><br><span class="line">  o2-&gt;Magic = <span class="number">-559038737</span>;</span><br><span class="line">  o1-&gt;Type = <span class="number">1</span>;</span><br><span class="line">  o1-&gt;Magic = <span class="number">-559038737</span>;</span><br><span class="line">  o2-&gt;Type = <span class="number">2</span>;</span><br><span class="line">  Type = o1-&gt;Type;</span><br><span class="line">  o1-&gt;Link = (SLIST_ENTRY *__shifted(Obj,<span class="number">0x10</span>))&amp;o2-&gt;Link;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;obj type: 0x%d\n&quot;</span>, Type);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;obj type: 0x%d\n&quot;</span>, ADJ(o1-&gt;Link)-&gt;Type);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>That’s all for today, and I hope you learnt something admist my rants and fluffs.</p>
<h2 id="2024-05-01"><a href="#2024-05-01" class="headerlink" title="2024-05-01"></a>2024-05-01</h2><p>Finally May.</p>
<p>April is probably cursed for me. Just like last April I fell horribly sick again, I think it’s gastroenteritis. Probably caused by some rancid food, and only subsided after 4 sleepless nights and constant pain. Fuck being sick. It ruins my momentum and resets everything, and I’m really down and unmotivated now. The best thing I could do now is to reflect.</p>
<p>I’m really a weak individual in terms of mental strength. A bit of lasting pain is enough to get me all sad and lose the willpower to get out of the bed and do anything. Honestly full respects to those in chronic pain or disabilities. I won’t be able to stay strong for sure. Sometimes I wonder how I’ll be like if I lose my eyes or my legs. It’s a dangerous thought exercise that always leaves me in despair. On the other hand, is anything really a problem if you’re fit and healthy? It isn’t. You healthy folks should feel empowered as you are.</p>
<p>When I don’t reflect on myself I reflect on security stuff. Do you face a similar problem? You think a lot, read a lot, have some thoughts and ideas, have a methodology/framework derived from logical reasoning, but it’s not working as well as planned. You might think it’s because the methodology is flawed or your reasoning is wrong, but listen it might be because you’re not FOLLOWING it. Sometimes you come up with a methodology after days of trying and tweaking and thinking, and you’ve not fully internalized it yet. You got to re-read your thoughts as a whole, from the beginning, with a fresh mind. Then you can work on really understanding the core of the methodology. Sometimes you do understand the methodology, but you are a lazy person by nature and you always hope to rush to easy results. You hope to do the least work possible and pray for success. You believe you can skip certain steps or quickly go over them, or give up some options. When the results are not promising, you start doubting your methodology that’s estabilished through logic and reasoning. That’s a dumb thing to do, because you didn’t even follow it fully. You’ve got to acknowledge the core of the methodology and know which steps you should instead spend extra effort on, because doing those steps actually correlate directly to finding bugs(in a superficial way). Ask yourself if you even understand your notes, and the bug patterns you’ve seen. It’s a difference between having knowledge and internalizing knowledge, and applying knowledge.</p>
<p>Gonna take a break, make a trip to the US for holiday, and hope to be back soon.(sorry boss!)</p>
<h2 id="2024-06-27"><a href="#2024-06-27" class="headerlink" title="2024-06-27"></a>2024-06-27</h2><p>谈一谈挖漏洞的技术分解。<br>在有了基础漏洞原理知识后可以做的定向提升：</p>
<ol>
<li><p>多做nday分析并记录漏洞原理。同样的漏洞规律可以出现在不同的平台，不同的部件，不同的函数。比如是否能一眼看出以下的操作有问题？</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">OBJECT_ATTRIBUTES oa = &#123;..., OBJ_CASE_INSENSITIVE, OBJ_KERNEL_HANDLE, ...&#125;;</span><br><span class="line">ZwCreateKey(..., &amp;oa, L“HKLM\\DoesntExist1\\DoesntExist2”, ...)</span><br></pre></td></tr></table></figure></li>
<li><p>找别人没看过却又有攻击意义的部件。比如很难交互或需要通过好几层调用，或环境难搭或难调试的部件，或复杂的协议。又或者鲜为人知存在但确实存在的部件。</p>
</li>
<li><p>选择了部件后，找各种部件能与可控数据交互的点。越能找到别人找不到的交互点，越好发现漏洞。一切数据类漏洞都是解析可控数据导致的。这部分的进阶还包括专注于发掘与测试可控数据熵值高的交互点。</p>
</li>
<li><p>除了数据类漏洞还有state类漏洞。这就需要专注于可控数据能改变state的操作，然后封装成一个个控制函数，比如Free(), Reset()。这和挖数据类漏洞是不同的思路。你不再关心数据是如何被解析，而是专注于如何用数据造成可控的state变化。</p>
</li>
</ol>
<p>如果你觉得自己掌握了漏洞知识却无法挖出漏洞，不妨试一试往这几个方向努力。</p>
<h2 id="2024-07-23"><a href="#2024-07-23" class="headerlink" title="2024-07-23"></a>2024-07-23</h2><p>I think it’s important to make a point that useful stuff do not need to be 0days. This is a ranking based on usefulness for cyber warfare, doesn’t directly relate to difficulty to achieve or monetary benefits.</p>
<p>For Windows at least:</p>
<ol>
<li>0Click 0day(Network/Proximity Based)</li>
<li>Server 0Click 0day(Protocols)</li>
<li>Browser Sandbox Escape 0day</li>
<li>1Click 0day(Parsing)</li>
<li>0Click 1day</li>
<li>Server 0Click 1day</li>
<li>Browser Sandbox Escape 1day</li>
<li>1Click 1day</li>
<li>LPE 0day(Medium IL)</li>
</ol>
<p>LPE from medium IL tends to be really overrated because that’s pretty much the only thing you’ll see constantly exposed to the public/reported. It’s important to keep in mind the usefulness tier list. In fact I think a stable KASLR bypass is more useful than LPE from medium. KASLR bypasses are kind of weird though, because they are not considered “serviceable” by <a target="_blank" rel="noopener" href="https://www.microsoft.com/en-us/msrc/windows-security-servicing-criteria#:~:text=Kernel%20Address%20Space%20Layout%20Randomization%20(KASLR)">definition</a>, but msrc still service and patch information disclosures that clearly cannot be used to leak “sensitive” data other than to break KASLR. It’s all good though. We had <code>NtQuerySystemInformation()</code> and we have EntryBleed.</p>
<h2 id="2024-08-22"><a href="#2024-08-22" class="headerlink" title="2024-08-22"></a>2024-08-22</h2><p>August</p>
<p>I’m getting a feeling that every year is a repetition. For the past 3 years there are certain events that are bound to happen in a certain month of the year. And they did happen again. Although it might be because I’m manifesting unconsciously and has an impact on decisions, you really need two hands to clap. At least I’m expecting them and won’t be beating myself over things, hopefully.</p>
<p>Wukong launched on the 20th. I’ve been waiting for the game since day 1, August of 2020. That was the year I matriculated into fucking high school, to put things into perspective. The game is pretty fun mechanically, but the moves do get repetitive after a while. Although there are many different combat styles, you get used to one and it’s hard to switch over, unless you feel like grinding the same boss 10 times to get used to it. Maybe I’m bad? Also there’s no map so it’s easy to get lost. It’s probably intended for the player to spend time exploring and take the journey slowly, but beating the minions don’t feel rewarding due to the repetitive mechanics mentioned. I’m also bad at figuring out which path I’ve taken, so I would appreciate a marker to make things less taxing for the mind. The storyline is interesting and has lots of lore. But the plot of “searching” for things feel less rewarding after a while(personally). The goal is not reinforced and I don’t feel a strong sense of purpose anymore. Also there are some bosses that have absolutely nothing to do with the plot, and again I don’t feel rewarded beating them. Writing this I realized the problem. I’m expecting so much satisfaction from the game, and it’s just too much for a video game. Seems like I’m fucked over by anticipation once again.</p>
<p>Another event is matriculating into university. This isn’t eventful because I didn’t go to any orientations or clubs or hostel. So I’m just tuning in to lessons and heading home. Super disconnected from the school. That makes the university a big time waster. The main reason to pursue a degree is parental pressure, and the only saving grace to convince myself is maybe I could make some friends. I should start working towards that though. Right now I’m just wasting time and money doing math. I don’t recognize the utility of traditional tertiary education in my field of work. I’m also trying to escape from parental pressure in any form. Realistically they don’t know better and they just want to feel like they do. Just hoping to attain work life balance while doing something I recognize as purposeful.</p>
<p>As usual I’ve some thoughts regarding vr. Recently I’m more aware of my concentration level/effeciency everyday. I can differentiate when I’m doing conscious and directed research vs just wasting the time away clicking stuff. As much I enjoy these stuff, it’s not easy to attain many hours of directed research. Especially when there’s no tangible output and you’re just understanding stuff. You’d be tempted to do shallow research on another target. It’s important to acknowledge that there are targets of varying difficulty level even on the same platform. The target you choose should really depend on your end goal. Take Windows for example, a functionality based service/driver is much easier to manually audit than a filesystem driver. If your goal is to achieve LPE and both are of the same value, it’s only reasonable to steer away from the filesystem driver(or fuzz it and call it a day). This is part of target selection and it’s a very underrated bit of wisdom, I personally feel is more important than auditing skills. Try to choose the most obscure, edge, unheard of component that still satisfies the goal. You see the best hunters on msrc always RCEing obscure non-default protocols, that’s the reason. They’re playing smart within the rules. On the other hand if your goal is to find a crazy bug in a core subsystem, you’ve got to manage expectations. It’s probable to go half a year without output. Can you take that? More importantly can you still be committed to do directed research daily under such conditions(lack of the “shell” high). Personally I’ll try to work on target selection.</p>
<h2 id="2024-09-09"><a href="#2024-09-09" class="headerlink" title="2024-09-09"></a>2024-09-09</h2><p>九月<br>做漏洞挖掘九个月了，感悟是越来越深。关于技法，关于思路。</p>
<p>近一个月最大的收获就是对独立安全研究整个流程认知的提升。细节上面还一无所知，但能朦胧感应到那个状态，以及粗略了解没挖之前要做什么，挖的时候要看什么 ，挖到了之后要怎么拓展。在分析了cve-2023-21674之后能具象化的理解同桌曾说过的“一个漏洞打多个”这个概念。也赞同他说的认知问题。漏洞挖掘绝对是个认知活。安全研究行业没有人会跟你细细说思路，说细节。细节都在脑子里，在私人笔记里，用来换钱。认知只能通过猜测和实验来提高。看talk，看ppt，看博客，看漏洞报告，分析nday，看大佬挖的部件走向。我经常用这些公开资源来尝试猜测大佬的思维。基本上每个月我的心法都会经历翻天覆地的改变。因为在实验了过后发现这些猜想不能说不合理，但是无法高效挖漏洞，所以不正确。随着总结出来的缺陷和更多的资源，又可以摸索出新的心法，周而复始。所以我之前发的博客关于心法和思路的部分请辩证地看待，毕竟这是一个个人成长记录博客。其实有很多词大家说出来的意思都不一样。比如“攻击面”。当你无法理解大佬们为什么一直强调某些名词的时候，可能是认知出现了问题，要及时改正。</p>
<p>发点干货。<br>我这个月能给出的最有价值的忠告就是：</p>
<ol>
<li>多分析nday</li>
<li>认知问题是无法通过思考弥补的，需要多上手多实践多抄袭多总结。包括多分析nday</li>
</ol>
<p>每天进步一点，梦想不再遥远.</p>
<h2 id="2024-09-16"><a href="#2024-09-16" class="headerlink" title="2024-09-16"></a>2024-09-16</h2><p>Attempting to formularize creative work is already heading in a wrong direction!</p>
<h2 id="2024-09-19"><a href="#2024-09-19" class="headerlink" title="2024-09-19"></a>2024-09-19</h2><p>黑盒审计应该要做到逆审分离。步骤应该是逆向-&gt;理解-&gt;审计。</p>
<p>打第一个目标的时候逆也不会逆，逆的乱七八糟。也没想着理解，纯粹用眼找oob，啥也没找到，最后上了fuzzer瞎几把fuzz出了一波。出了洞也不会做变体分析，暴殄天物。</p>
<p>打第二个目标的时候时间紧迫，目标偏偏又是闭源格式，不用说了自然是没收获。不知道在干什么，选了那么傻逼的目标。按照现在的理解肯定找个功能性驱动打了。</p>
<p>打第三个目标的时候会逆了，但是没做到逆审分离。这目标已经出过很多洞，我也预料到了它未来漏洞的走势，但是逆的时候又想着找找漏洞，边逆变找。这只适合找low hanging fruit，而且会拖延逆向速度。结果就是花了一个月还没逆到我觉得会出洞的地方，然后放弃了。结果过两个月就验证了我的想法。如果按照现在思维，肯定是果断从后面开始逆起，或者前面就是纯逆不审，赶紧逆到后面开始审。那段时期还沉迷写文档，是个函数能写二十页pdf，太浪费时间且毫无用处。</p>
<p>打第四五个目标的时候也是逆审一起来的。但是这两个都是功能性驱动，且功能非常独立。这对逆向和理解的要求不高，于是出了一波洞。再加上会粗浅的变体分析了，收益还行。肯定也算low hanging fruit，是个人都挖得到，对技术的精进作用不大。</p>
<p>打第六个目标的时候意识到了问题，好像只能挑软柿子捏。当时的改变思路是想走捷径。尝试总结归纳分析过的所有漏洞，找出一种不用理解，光看一些特征就能找出漏洞的bottom-up策略。这么干了一个月，一个洞也没出。其实这是幸运的。幸好这个目标已经久经沙场，不然可能又会陷入错误的觉悟。我的策略本质上还是找low hanging fruit。特征能看出来的东西，自动化也能轻易找到。而且false positive太多，有太多操作需要手动排查最后发现根本不是漏洞。其实如果花时间理解了目标就根本不会觉得这些操作有问题。分析nday的时候也会觉得我操这怎么可能能想得到，但其实人家只是理解了目标而已。这其中当然也收获到了一些排查漏洞的技巧，但更重要的是又该换思路了。</p>
<p>现在在打第七个目标。已经找出了需要逆的几个结构体，目前在纯逆向阶段。等这一阶段搞完就可以根据功能点进一步理解了。</p>
<p>反思复盘才会发现，原来失败的任务本质上都是因为没达到成功的条件，只是当时不知道成功的条件是什么。而成功的任务大多数是运气使然。要多利用公开资源学习他人的思路。</p>
<h2 id="2024-09-24"><a href="#2024-09-24" class="headerlink" title="2024-09-24"></a>2024-09-24</h2><p>今日的思考是牛逼的人在打高端局的时候是不是一直在主动考虑和分析很多事情。起因是昨天突然想认真玩一个《曾经玩的很牛逼但很几年没认真玩了的》游戏。发现算费也不会算，牌序也记不住。就感觉，要花好多的精神力去特意算这个东西然后还是很容易一片空白。玩得很用力，反而影响操作。但其实回想之前，我也根本没考虑这些事情。我不会主动计费算牌，甚至从来没有主动这么思考过，但还是能很清晰的知道当前状态，亏小还是亏大，对面手里有哪些牌。像是潜意识里一直在自动处理着这些信息，而且毫不费力。当别人问我怎么记的时候我也说不出所以然，因为对自己而言完全就是《凭感觉》。我是感觉牛人打高端局不会比普通人打普通局累多少。因为普通人需要花大量精神力去处理的事情，已经在他们的脑子里形成了专门的处理器，可以被动且不费力的自动分析完。这跟天赋没半毛钱关系，因为我曾经也不会，我有段时间会了，我现在又不会了。绝对是熟练度的问题。到巅峰水平我打了三年，每天平均至少五小时。游戏和安研的难度又怎能相提并论？综合考量之下，目前菜才是合理的。只要不停的肝就完事了。有一天就会发现我好像没比之前费更多力，但产出已不是一个量级的。</p>
<h2 id="2024-10-01"><a href="#2024-10-01" class="headerlink" title="2024-10-01"></a>2024-10-01</h2><p>pwn!</p>
<h2 id="2024-10-23"><a href="#2024-10-23" class="headerlink" title="2024-10-23"></a>2024-10-23</h2><p>There’s this feeling very special to vuln researchers.  That’s when you find an interesting condition in the code that looks like a bug (e.g unchecked arithmetic). It’s pretty deep down the callstack so you’re not 100% sure it’ll all work out as you plan. It’s a weird feeing because you think it’s a bug, so the logical brain tries to tell you to be excited. However you’ve experienced so many false positives and fake bugs that the emotional brain immediately recognizes this as a disappointment and feeds you stressful signals. Everytime I encounter such a case I get pretty stressed out. It’s worse when there’s like 3 conditions you think is buggy, and you jusy get overwhelmed. The cure is just to remember that you don’t have to do everything in one sitting. Take it easy. You can confirm one condition a week, and slowly finish everything. Same applies with life. Just do things one at a time, and take things easy. Due dates are really an arbitrary construct.</p>
<h2 id="2024-10-27"><a href="#2024-10-27" class="headerlink" title="2024-10-27"></a>2024-10-27</h2><p>Recently felt the effects of overstimulation, or the desensitization of receptors. Desensitization is the primary driver for greed amongst the well nourished population. People crave more stimulation for one simple reason, that existing stimulation is not stimulating anymore. What a sin it is. I realized the importance of combating desensitization. The body as a whole needs to be reset and refreshed every while. The sensory receptors needs to atrophy. The organs, driven by evolution, believe they are evolving for survival reasons. That’s really absurd in the modern setting. We feel the same(or less) pleasure receiving higher stimulus now, as compared to receiving a lower stimulus prior to desensitization, therefore there’s no reason at all to allow the receptors to evolve. It’s even more irrational to feed their cravings and make it a mission to seek higher stimulus. Because pleasure is not a competition, neither is it absolute. Pleasure is a delta, and it’s fully innate. The sole purpose of pleasure is to satisfy. The only rational thinking to pleasure is to reduce the lower bound every while, so the same accessible stimulus can do its work. So, do something drastically distinct from the norms. And do it for some time. Let the overworked receptors breakdown and revert. The art of body control.</p>
<h2 id="2024-10-31"><a href="#2024-10-31" class="headerlink" title="2024-10-31"></a>2024-10-31</h2><p>最近看某影视作品，里面经常出现的一个转折就是一个水平/地位/威严很高的角色，因为突发事件变得不能自理/死亡。丧失行动能力和语言能力后只能发出简单的音符，靠他人服侍。这种反差特别触动我。前一天还生龙活虎，天塌了也扛得住。转眼就连进食都得依靠别人。突然就想到我的父亲。父亲是个很有本事的人。生活上的大小事都能干。但是最让我敬佩的是他的常识。比如导航，地理知识，各种东西的价位，办很多事的流程。很多事情我得靠查询，做功课，甚至摸索才能获得的，他都熟记于心。给我的感觉就是个很能生存的人。生活中也是个大嗓门的，可以说强势的人。今天不由得代入进影视作品情节里。我觉得会非常非常可惜。当然以上的这些都是我带入了之后才突然意识到的。如果不看影视作品我应该是没法发现父亲的这些优点。看来对于人文的理解和感悟还是太初级。需要多观影多看书来丰富。这么一想，很多感觉理解不了，很傻逼的事情，或许是还没达到那个层次的思考。用自己的话说，器官还没进化。</p>
<h2 id="2024-11-21"><a href="#2024-11-21" class="headerlink" title="2024-11-21"></a>2024-11-21</h2><p>傻逼才不用AI!</p>
<h2 id="2024-11-28"><a href="#2024-11-28" class="headerlink" title="2024-11-28"></a>2024-11-28</h2><p>动物的原始追求是解决温饱。一天的行动都是为了果腹，解渴。有时候或许要花上一天，那累了可以自然的休息，隔天再继续。有时候运气好有了储备，可以休息几天。这几天它怎么度过呢？可能就是不停地睡觉。可能是与同类嬉戏打闹。可能是完全发呆，像牛一样反刍摇尾巴，可能是像猫一样到处溜达闻闻气味。按照这么看来，人本应是不断的行动去满足基础温饱的。日出而作日落而息。那在基础温饱满足了的情况下的闲暇时间是可以什么都不做的。这是完全合理的，因为没有需要做的事情。生存指标已经达成，干啥都行，不干啥都行。说这句话的目的不是说你不应该有追求，不应该上进。而是说如果你饿不死你可以没有追求，可以完全不上进。</p>
<h2 id="2024-12-08"><a href="#2024-12-08" class="headerlink" title="2024-12-08"></a>2024-12-08</h2><p><em>Well, I wonder. Having simple tasks—things that should be done—while continually coming up with various reasons why one can’t do them sounds like a hard way to live, doesn’t it?</em></p>
<h2 id="2024-12-11"><a href="#2024-12-11" class="headerlink" title="2024-12-11"></a>2024-12-11</h2><p>Will be going on holiday after the week, so it’s time to wrap up the year 2024. Under the inspiration of the company and colleagues, this year was fruitful for me in terms of output.</p>
<p>At around March I switched to full manual audit, because I gained a realization that fuzzing for the masses(without a million servers) is just trying to multiply lesser manual analysis effort with luck. By creating the perfect harness you have to know where the bugs are already. It was not an easy switch, because I realized, as someone said before, the human brain will do anything to avoid understanding something. That includes switching targets fast, only looking at controllable io, pattern matching etc. I spent quite some months battling these, until I reach a state to consciously to steer away from these habits. Instead, I will suggest to 1. Label/Rename/Format your code/pseudocode output as pretty as possible. Make it flow so easily into your brain like drinking water. 2. Never pattern match, don’t care about data flow, just try to reason what the program is doing. Because you don’t want to compete with fuzzers, static analyzers, developer auditors and LLMs. You cannot win on that level. Instead be on a higher level. They cannot afford to perform in depth understanding, but you can. </p>
<p>The best reward I received from switching to full manual is the ability visualize success metrics with respect to my methodology. If I’m not finding bugs, I know exactly why, and how far I am from it. There are certain criterias to finding bugs, and when you’re not finding bugs for a long time, it just means you haven’t hit the criterias for all the target you’re auditing.</p>
<p>On that note, the secrets to VR is so describable that I think a commercial LLM now(end of 2024) can certainly perform. It will make an excellent VR agent if you don’t task it to become a VR agent. Similarly, you will find great bugs if you don’t try to find bugs.</p>
<p>Lastly, it’s such a privilege to be able to work in vuln research.<br>I’m grateful to my boss Jacob for the opportunity.</p>
<h2 id="2025-01-05"><a href="#2025-01-05" class="headerlink" title="2025-01-05"></a>2025-01-05</h2><p>Holiday thoughts dump:</p>
<p>Goals:<br>One realisation I’ve gained from my holiday was to stop being goals oriented. Instead try to focus on shaping your entire force field. What I mean is have certain values, and just do things that align to them. For example curiosity, coherence, courage… etc. These are values you can demonstrate consistently, and don’t have a negative factor to it, meaning it’s not something that’s attributed with a possibility: you can always perform them without failure. This approach reduces the uncertainty of chasing goals that are not fully controllable by you, and instead focuses more on inner peace.</p>
<p>调理：<br>人内在的磁场和外貌都是相通的。人眼中好看的外貌实际上是健康的体现。需要从内至外保持健康，平稳。用科技去弥补是错误的方向。那是商业的骗局。要多运动，拉伸，运用身体的每个部位。吃的干净。冥想保持平静。</p>
<p>反思：<br>我发现自己只有在逆境之才会总结反思，想出相对更加高效的方法，并且发现用之前相对低效的方法得到的成功大多数是运气使然。细思极恐的一点是，如果不碰壁，我肯定会（错误的）誓死相信自己的方法是完全正确的。那会是多么愚昧的表现？所以第一点是不管什么方法，一定要进行大量的实践之后才能证明他是高效的，因为不可能永远运气好。而且只能证明他在当前环境是高效的。时代永远在变，不朽功法只存在小说里。第二点是在任何的成功总结出方法后，永远不要觉得自己的方法就是最好的了。很有可能还是运气。最后就是千万不要去怪环境。大概率是方法和思路出了问题而不是环境。</p>
<p>Back to work :)</p>
<h2 id="2025-02-01"><a href="#2025-02-01" class="headerlink" title="2025-02-01"></a>2025-02-01</h2><p>This CNY I tried to learn deobfuscation, because I realized my entire skill set is dependent on having code to understand. Obfuscation will render me useless. I followed <a target="_blank" rel="noopener" href="https://synthesis.to/2021/10/21/vm_based_obfuscation.html">this</a> tutorial and did a VM crackme protected by tigress. The tutorial used symbolic execution to trace a specific execution flow of the bytecode, then instrumented it to produce disassembly output. I thought it would be cool to transpile the vm opcode into x86 assembly directly, then compile and decompile in IDA to take advantage of compiler optimization as well as IDA’s decompilation technology, so that’s what I did:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">BYTE BCODE[<span class="number">221</span>] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0xD5</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x26</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0xF6</span>, <span class="number">0xD5</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x26</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0x26</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x30</span>, <span class="number">0x26</span>, <span class="number">0x0C</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0x51</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xD5</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x30</span>,</span><br><span class="line">  <span class="number">0xC2</span>, <span class="number">0xF1</span>, <span class="number">0x09</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x51</span>, <span class="number">0x19</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xD5</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x26</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0x51</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x51</span>, <span class="number">0x88</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xD5</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x26</span>, <span class="number">0x14</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0x51</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x26</span>, <span class="number">0x14</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x30</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x30</span>,</span><br><span class="line">  <span class="number">0x80</span>, <span class="number">0xF1</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x51</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x51</span>, <span class="number">0x4B</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x26</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x30</span>, <span class="number">0x26</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x30</span>, <span class="number">0x66</span>, <span class="number">0x26</span>,</span><br><span class="line">  <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0x26</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x30</span>, <span class="number">0x26</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0x26</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x30</span>, <span class="number">0x26</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0xD5</span>,</span><br><span class="line">  <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x26</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x30</span>,</span><br><span class="line">  <span class="number">0x66</span>, <span class="number">0x26</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0x51</span>, <span class="number">0xA6</span>, <span class="number">0xFF</span>,</span><br><span class="line">  <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x51</span>, <span class="number">0xA1</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x26</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x30</span>, <span class="number">0x26</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xF6</span>, <span class="number">0x51</span>,</span><br><span class="line">  <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x26</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x30</span>,</span><br><span class="line">  <span class="number">0xDD</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">JmpRec</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    BYTE InUse;</span><br><span class="line">    BYTE *Dest;</span><br><span class="line">    DWORD RandId;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">JmpRec</span> <span class="title">records</span>[32] =</span> &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;clobbers rbx and needs space on stack&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;arg1 is passed by pointer in rcx&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;buffer for calculation is passed by pointer in rdx&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;--------------------&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;push rbx&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// first pass we should collect jmp codes first</span></span><br><span class="line">    <span class="comment">// second pass do normal flow</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> passes = <span class="number">1</span>; passes &lt;= <span class="number">2</span>; passes++) &#123;</span><br><span class="line">        BYTE *PC = &amp;BCODE[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">while</span> (*PC != <span class="number">0xDD</span>) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (*PC) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x80</span>:</span><br><span class="line">                &#123;</span><br><span class="line">                    PC++;</span><br><span class="line">                    <span class="keyword">if</span> (passes == <span class="number">2</span>) &#123;</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;pop rax&quot;</span>);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;pop rbx&quot;</span>);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;cmp ebx, eax&quot;</span>);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;setbe al&quot;</span>);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;movzx rax, al&quot;</span>);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;push rax&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x30</span>:</span><br><span class="line">                &#123;</span><br><span class="line">                    PC++;</span><br><span class="line">                    <span class="keyword">if</span> (passes == <span class="number">2</span>) &#123;</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;pop rax&quot;</span>);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;mov eax, dword ptr [rax]&quot;</span>);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;push rax&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="number">0xE</span>:</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (passes == <span class="number">2</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (*(DWORD *)(PC + <span class="number">1</span>) == <span class="number">0</span>)</span><br><span class="line">                            <span class="built_in">puts</span>(<span class="string">&quot;push rcx&quot;</span>);</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                            <span class="built_in">puts</span>(<span class="string">&quot;push 0&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    PC += <span class="number">5</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x26</span>:</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (passes == <span class="number">2</span>) &#123;</span><br><span class="line">                        INT idx = *(INT *)(PC + <span class="number">1</span>);</span><br><span class="line">                        <span class="built_in">printf</span>(idx &gt;= <span class="number">0</span> ? <span class="string">&quot;lea rax, dword ptr [rdx+%d]\n&quot;</span> : <span class="string">&quot;lea rax, dword ptr [rdx-%d]\n&quot;</span>, idx);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;push rax&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    PC += <span class="number">5</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="number">0xD5</span>:</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (passes == <span class="number">2</span>)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;push %d\n&quot;</span>, *(DWORD *)(PC + <span class="number">1</span>));</span><br><span class="line">                    PC += <span class="number">5</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="number">0xF6</span>:</span><br><span class="line">                &#123;</span><br><span class="line">                    PC++;</span><br><span class="line">                    <span class="keyword">if</span> (passes == <span class="number">2</span>) &#123;</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;pop rax&quot;</span>);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;pop rbx&quot;</span>);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;mov dword ptr [rax], ebx&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x51</span>:</span><br><span class="line">                &#123;</span><br><span class="line">                    INT jmpOffs = *(INT *)(PC + <span class="number">1</span>);</span><br><span class="line">                    BYTE *jmpTarget = PC + jmpOffs + <span class="number">1</span>;</span><br><span class="line">                    BYTE found = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">                        <span class="keyword">if</span> (records[i].InUse &amp;&amp; jmpTarget == records[i].Dest) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (passes == <span class="number">2</span>)</span><br><span class="line">                                <span class="built_in">printf</span>(<span class="string">&quot;jmp LAB_%d\n&quot;</span>, records[i].RandId); <span class="comment">// reuse existing label</span></span><br><span class="line">                            found = <span class="number">1</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (!found) &#123;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">                            <span class="keyword">if</span> (!records[i].InUse) &#123;</span><br><span class="line">                                records[i].InUse = <span class="number">1</span>;</span><br><span class="line">                                records[i].Dest = jmpTarget;</span><br><span class="line">                                records[i].RandId = rand();</span><br><span class="line">                                <span class="keyword">if</span> (passes == <span class="number">2</span>)</span><br><span class="line">                                    <span class="built_in">printf</span>(<span class="string">&quot;jmp LAB_%d\n&quot;</span>, records[i].RandId); <span class="comment">// add new label</span></span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    PC += <span class="number">5</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="number">0xC2</span>:</span><br><span class="line">                &#123;</span><br><span class="line">                    PC++;</span><br><span class="line">                    <span class="keyword">if</span> (passes == <span class="number">2</span>) &#123;</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;pop rax&quot;</span>);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;pop rbx&quot;</span>);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;cmp rax, rbx&quot;</span>);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;setz al&quot;</span>);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;movzx rax, al&quot;</span>);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;push rax&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="number">0xF1</span>:</span><br><span class="line">                &#123;</span><br><span class="line">                    INT jmpOffs = *(INT *)(PC + <span class="number">1</span>);</span><br><span class="line">                    BYTE *jmpTarget = PC + jmpOffs + <span class="number">1</span>;</span><br><span class="line">                    BYTE found = <span class="number">0</span>;</span><br><span class="line">                    CHAR outp[<span class="number">0x20</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">                        <span class="keyword">if</span> (records[i].InUse &amp;&amp; jmpTarget == records[i].Dest) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (passes == <span class="number">2</span>)</span><br><span class="line">                                sprintf_s(&amp;outp, <span class="number">0x20</span>, <span class="string">&quot;jnz LAB_%d\n&quot;</span>, records[i].RandId); <span class="comment">// reuse existing label</span></span><br><span class="line">                            found = <span class="number">1</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (!found) &#123;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">                            <span class="keyword">if</span> (!records[i].InUse) &#123;</span><br><span class="line">                                records[i].InUse = <span class="number">1</span>;</span><br><span class="line">                                records[i].Dest = jmpTarget;</span><br><span class="line">                                records[i].RandId = rand();</span><br><span class="line">                                <span class="keyword">if</span> (passes == <span class="number">2</span>)</span><br><span class="line">                                    sprintf_s(&amp;outp, <span class="number">0x20</span>, <span class="string">&quot;jnz LAB_%d\n&quot;</span>, records[i].RandId); <span class="comment">// add new label</span></span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (passes == <span class="number">2</span>) &#123;</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;pop rax&quot;</span>);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;cmp eax, 0&quot;</span>);</span><br><span class="line">                        <span class="built_in">printf</span>(outp);</span><br><span class="line">                    &#125;</span><br><span class="line">                    PC += <span class="number">5</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="number">0x66</span>:</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (passes == <span class="number">2</span>) &#123;</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;pop rax&quot;</span>);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;pop rbx&quot;</span>);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;add ebx, eax&quot;</span>);</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;push rbx&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    PC++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;OPCODE NOT HANDLED: 0x%lx\n&quot;</span>, *PC);</span><br><span class="line">                    getchar();</span><br><span class="line">                    PC++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (passes == <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">                    <span class="keyword">if</span> (records[i].InUse &amp;&amp; records[i].Dest == PC) &#123;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;LAB_%d:\n&quot;</span>, records[i].RandId);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;pop rax&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;pop rbx&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;ret&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Original code:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">fib</span><span class="params">(<span class="keyword">unsigned</span> n)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> a=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">unsigned</span> b=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> s = b;</span><br><span class="line">  <span class="keyword">unsigned</span> i;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (n == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (i=<span class="number">2</span>; i&lt;=n; i++) &#123;</span><br><span class="line">    s=a+b;</span><br><span class="line">    a=b;</span><br><span class="line">    b=s;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>My decompilation:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">func</span><span class="params">(_DWORD *a1, _DWORD *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  a2[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  a2[<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">  a2[<span class="number">3</span>] = a2[<span class="number">2</span>];</span><br><span class="line">  <span class="keyword">if</span> ( *a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( a2[<span class="number">5</span>] = <span class="number">2</span>; a2[<span class="number">5</span>] &lt;= *a1; ++a2[<span class="number">5</span>] )</span><br><span class="line">    &#123;</span><br><span class="line">      a2[<span class="number">3</span>] = a2[<span class="number">1</span>] + a2[<span class="number">2</span>];</span><br><span class="line">      a2[<span class="number">1</span>] = a2[<span class="number">2</span>];</span><br><span class="line">      a2[<span class="number">2</span>] = a2[<span class="number">3</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    a2[<span class="number">4</span>] = a2[<span class="number">3</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    a2[<span class="number">4</span>] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (<span class="keyword">unsigned</span> <span class="keyword">int</span>)a2[<span class="number">4</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>I’m pretty happy with it.</p>
<p>Besides this, I was looking at some automation attempts at closed source bug hunting, to see if I can enhance any existing research with AI. I took a look at <a target="_blank" rel="noopener" href="https://www.usenix.org/conference/usenixsecurity17/technical-sessions/presentation/pan">Digtool</a> by 360. The idea is basically fuzzing with enhanced detection. The tool instruments the OS by converting it into a guest VM. Then it fuzzes code paths and detects bugs based on the instrumentation. This is an addition to Driver Verifier, because verifier can only detect pool based bugs. Digtool monitors memory access events so it can detect TOCTOU and Unprobe bugs to a certain accuracy. However, the basis is still large amount of fuzzing to trigger code usage, which means only shallow bugs TOCTOU and Unprobe bugs can be found. Those deeper code will require sensible arguments to trigger, which was not possible by automation then.</p>
<p>I believe we can use AI to generate structure aware arguments automatically now to aid this tool. Two methods I can immediately think of is to reverse companion binaries and hooking the syscall interface to identify parameters. Then smart mutation rules for each field can be generated, so the fuzzing stage only needs to execute the rules and don’t need to pass through AI again. How do we know the success rate of our mutations? We can employ a coarse metric of hooking certain points of execution and prioritizing input that hits the hook. This can be done with little overhead if virtualization is used.</p>
<p>Also, I made a <a target="_blank" rel="noopener" href="https://starlabs.sg/blog/2025/01-star-labs-2025-new-year-exploitation-challenge/">challenge</a> which no one has claimed the prize yet. Hopefully my dear reader can claim it.</p>
<h2 id="2025-03-09"><a href="#2025-03-09" class="headerlink" title="2025-03-09"></a>2025-03-09</h2><p>突然想尝试一种新的记录方式。正文还是用英语写，但是需要一些旁白或带点情绪的表达就会以这种形式出现。有种说相声的感觉</p>
<p>Came back from reverse conf a few days ago. It’s my first conference(excluding the one hosted by my company), and also first overseas conference. It was a great first experience for me, everything was well prepared from logistics to food(and it’s their first year organizing too!). 可惜长途经济+时差导致一到饭点胃还在睡觉，只能看着美食却毫无食欲，甚至听着会也昏昏欲睡。The most inspiring talk was from Markus Gaasedelen on reversing the xbox. Markus spent 4000 hours of free time reversing the xbox, and went from a hardware noob to fully uncovering the internals of a complex proprietary machine. It’s really fascinating to see where determination and time can bring you, and the limitless potential of self learning. 4000 hours of free time over 3 years, is basically working more than 3 hours everyday after work on a hobby project. I was honestly fucking inspired, and thought I’m spending too little time on research stuff.</p>
<p>Also while trying to fight jetlag, I was having really frequent dreams in the day and night. One of the dreams was really bizarre. It was my granddad(who had passed on) and I standing in the kitchen of my old house. His whole body and limbs were kind of long and twisted（对不起有点恐怖了）, and he was moving his hands in and out of the fire from the stove. I was trying to convince him that it’s dangerous. The point is, at no moment did dream me realize anything weird about the situation. Why is he back to life? Why are we in the old house? Why are his limbs like this? There are so many things wrong with the situation that could have made me realize “oh it’s a dream”, but I didn’t. My brain just followed right into the situation and assumed everything was normal. After waking up I start to think that the human mind is perhaps really willing to accept preset conditions injected by the brain and fall into autopilot mode. It’s pretty scary that at some point you stop questioning things and just act accordingly, like it’s always the ground truth. Dear reader are you accepting any thoughts or situations in your life on autopilot? I haven’t thought of a way to combat this yet. We could try all day awareness proposed by the lucid dreaming community. Whenever you’re put into a situation try to trace logically the events that led you to be in the situation, then ask yourself if those events are normal and why. Always give yourself the opportunity to spot uncoherent situations and act accordingly.</p>
<p>在长途飞机上总是会思考一些平时不会想到的问题。比如我在互联网上是否太过暴露自己内心的想法。甚至有一刻想把博客下线。但是又想了下博客已经是相当收敛的发声方式了。思想在碰撞中才被赋予意义。对不对？</p>
<h2 id="2025-03-17"><a href="#2025-03-17" class="headerlink" title="2025-03-17"></a>2025-03-17</h2><p>Today I realized I’m losing grip on the sense of adrenaline rush: the raw ecstasy that drove me to do security research. I used to feel really excited trying to research something, and like “roleplay” being a security researcher because of pure joy. I would be willing to try everything and break stuff and do  everything I can to hack. Recently I’ve been just doing things methodologically, very organized and reserved, and feels like more of a “best effort” job. This is probably a drawback from trying to find a unified theory to code auditing. I would try to strictly follow my theory and guide to auditing, and it’s severely limiting the freedom of my thoughts to the point where it’s becoming a checklist. My priority became “how to come up with a guide to code audit such that everyone can follow it and hack every target given enough time”. But we all know checklists are boring and restrictive and your motivation will quickly shift from the “happiness of learning the target” to “finishing the checklist”. This is kind of a problem because it means I can’t fully tap on the unconscious brain’s processing anymore, because security research is no longer tied to a raw emotion. Maybe it’s also money and KPI and the external stuff clouding my thoughts. I only realized this from looking at one of the interns work. He would work from day to night, and only take a short lunch break. He seemed really just interested in hacking, nothing else. No money? fine. No gossip? fine. No internet fame? fine too. Just want to hack. It’s pretty inspiring. I used to be like that too, and I really want to find back the feeling of ecstasy. The abstract sense of self improvement when learning security. I can still remember that feeling, just gonna find a way to trigger it again.</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
      

      

      
        
<div class="share-btn share-icons tooltip-left">
  <div class="tooltip tooltip-east">
    <span class="tooltip-item">
      <a href="javascript:;" class="share-sns share-outer">
        <i class="icon icon-share"></i>
      </a>
    </span>
    <span class="tooltip-content">
      <div class="share-wrap">
        <div class="share-icons">
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="icon icon-weibo"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="icon icon-weixin"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="icon icon-qq"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="icon icon-douban"></i>
          </a>
          <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a>
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="icon icon-facebook"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="icon icon-twitter"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="icon icon-google"></i>
          </a>
        </div>
      </div>
    </span>
  </div>
</div>

<div class="page-modal wx-share js-wx-box">
    <a class="close js-modal-close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//pan.baidu.com/share/qrcode?url=http://example.com/2099/11/11/prelude/" alt="微信分享二维码">
    </div>
</div>

<div class="mask js-mask"></div>
      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

  
<nav id="article-nav">
  
  
    <a href="/2025/03/25/cve-2024-26170/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">CVE-2024-26170</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>


<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>



  
  
  

  

  

  


          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2025 cp
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: false,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		toc_hide_index: true,
		root: "/",
		innerArchive: true,
		showTags: false
	}
</script>

<script>!function(t){function n(e){if(r[e])return r[e].exports;var i=r[e]={exports:{},id:e,loaded:!1};return t[e].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var r={};n.m=t,n.c=r,n.p="./",n(0)}([function(t,n,r){r(195),t.exports=r(191)},function(t,n,r){var e=r(3),i=r(52),o=r(27),u=r(28),c=r(53),f="prototype",a=function(t,n,r){var s,l,h,v,p=t&a.F,d=t&a.G,y=t&a.S,g=t&a.P,b=t&a.B,m=d?e:y?e[n]||(e[n]={}):(e[n]||{})[f],x=d?i:i[n]||(i[n]={}),w=x[f]||(x[f]={});d&&(r=n);for(s in r)l=!p&&m&&void 0!==m[s],h=(l?m:r)[s],v=b&&l?c(h,e):g&&"function"==typeof h?c(Function.call,h):h,m&&u(m,s,h,t&a.U),x[s]!=h&&o(x,s,v),g&&w[s]!=h&&(w[s]=h)};e.core=i,a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,t.exports=a},function(t,n,r){var e=r(6);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n,r){var e=r(126)("wks"),i=r(76),o=r(3).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n,r){var e=r(94),i=r(33);t.exports=function(t){return e(i(t))}},function(t,n,r){t.exports=!r(4)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(2),i=r(167),o=r(50),u=Object.defineProperty;n.f=r(10)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){t.exports=!r(18)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(14),i=r(22);t.exports=r(12)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(20),i=r(58),o=r(42),u=Object.defineProperty;n.f=r(12)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){var e=r(40)("wks"),i=r(23),o=r(5).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n,r){var e=r(67),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){var e=r(46);t.exports=function(t){return Object(e(t))}},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,r){var e=r(63),i=r(34);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(21);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n,r){var e=r(11),i=r(66);t.exports=r(10)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(3),i=r(27),o=r(24),u=r(76)("src"),c="toString",f=Function[c],a=(""+f).split(c);r(52).inspectSource=function(t){return f.call(t)},(t.exports=function(t,n,r,c){var f="function"==typeof r;f&&(o(r,"name")||i(r,"name",n)),t[n]!==r&&(f&&(o(r,u)||i(r,u,t[n]?""+t[n]:a.join(String(n)))),t===e?t[n]=r:c?t[n]?t[n]=r:i(t,n,r):(delete t[n],i(t,n,r)))})(Function.prototype,c,function(){return"function"==typeof this&&this[u]||f.call(this)})},function(t,n,r){var e=r(1),i=r(4),o=r(46),u=function(t,n,r,e){var i=String(o(t)),u="<"+n;return""!==r&&(u+=" "+r+'="'+String(e).replace(/"/g,"&quot;")+'"'),u+">"+i+"</"+n+">"};t.exports=function(t,n){var r={};r[t]=n(u),e(e.P+e.F*i(function(){var n=""[t]('"');return n!==n.toLowerCase()||n.split('"').length>3}),"String",r)}},function(t,n,r){var e=r(115),i=r(46);t.exports=function(t){return e(i(t))}},function(t,n,r){var e=r(116),i=r(66),o=r(30),u=r(50),c=r(24),f=r(167),a=Object.getOwnPropertyDescriptor;n.f=r(10)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(24),i=r(17),o=r(145)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(14).f,i=r(8),o=r(15)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(40)("keys"),i=r(23);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(5),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n,r){var e=r(21);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(36),u=r(44),c=r(14).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){n.f=r(15)},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n,r){var e=r(4);t.exports=function(t,n){return!!t&&e(function(){n?t.call(null,function(){},1):t.call(null)})}},function(t,n,r){var e=r(53),i=r(115),o=r(17),u=r(16),c=r(203);t.exports=function(t,n){var r=1==t,f=2==t,a=3==t,s=4==t,l=6==t,h=5==t||l,v=n||c;return function(n,c,p){for(var d,y,g=o(n),b=i(g),m=e(c,p,3),x=u(b.length),w=0,S=r?v(n,x):f?v(n,0):void 0;x>w;w++)if((h||w in b)&&(d=b[w],y=m(d,w,g),t))if(r)S[w]=y;else if(y)switch(t){case 3:return!0;case 5:return d;case 6:return w;case 2:S.push(d)}else if(s)return!1;return l?-1:a||s?s:S}}},function(t,n,r){var e=r(1),i=r(52),o=r(4);t.exports=function(t,n){var r=(i.Object||{})[t]||Object[t],u={};u[t]=n(r),e(e.S+e.F*o(function(){r(1)}),"Object",u)}},function(t,n,r){var e=r(6);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(91),u=r(13),c="prototype",f=function(t,n,r){var a,s,l,h=t&f.F,v=t&f.G,p=t&f.S,d=t&f.P,y=t&f.B,g=t&f.W,b=v?i:i[n]||(i[n]={}),m=b[c],x=v?e:p?e[n]:(e[n]||{})[c];v&&(r=n);for(a in r)(s=!h&&x&&void 0!==x[a])&&a in b||(l=s?x[a]:r[a],b[a]=v&&"function"!=typeof x[a]?r[a]:y&&s?o(l,e):g&&x[a]==l?function(t){var n=function(n,r,e){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,r)}return new t(n,r,e)}return t.apply(this,arguments)};return n[c]=t[c],n}(l):d&&"function"==typeof l?o(Function.call,l):l,d&&((b.virtual||(b.virtual={}))[a]=l,t&f.R&&m&&!m[a]&&u(m,a,l)))};f.F=1,f.G=2,f.S=4,f.P=8,f.B=16,f.W=32,f.U=64,f.R=128,t.exports=f},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n,r){var e=r(26);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(183),i=r(1),o=r(126)("metadata"),u=o.store||(o.store=new(r(186))),c=function(t,n,r){var i=u.get(t);if(!i){if(!r)return;u.set(t,i=new e)}var o=i.get(n);if(!o){if(!r)return;i.set(n,o=new e)}return o},f=function(t,n,r){var e=c(n,r,!1);return void 0!==e&&e.has(t)},a=function(t,n,r){var e=c(n,r,!1);return void 0===e?void 0:e.get(t)},s=function(t,n,r,e){c(r,e,!0).set(t,n)},l=function(t,n){var r=c(t,n,!1),e=[];return r&&r.forEach(function(t,n){e.push(n)}),e},h=function(t){return void 0===t||"symbol"==typeof t?t:String(t)},v=function(t){i(i.S,"Reflect",t)};t.exports={store:u,map:c,has:f,get:a,set:s,keys:l,key:h,exp:v}},function(t,n,r){"use strict";if(r(10)){var e=r(69),i=r(3),o=r(4),u=r(1),c=r(127),f=r(152),a=r(53),s=r(68),l=r(66),h=r(27),v=r(73),p=r(67),d=r(16),y=r(75),g=r(50),b=r(24),m=r(180),x=r(114),w=r(6),S=r(17),_=r(137),O=r(70),E=r(32),P=r(71).f,j=r(154),F=r(76),M=r(7),A=r(48),N=r(117),T=r(146),I=r(155),k=r(80),L=r(123),R=r(74),C=r(130),D=r(160),U=r(11),W=r(31),G=U.f,B=W.f,V=i.RangeError,z=i.TypeError,q=i.Uint8Array,K="ArrayBuffer",J="Shared"+K,Y="BYTES_PER_ELEMENT",H="prototype",$=Array[H],X=f.ArrayBuffer,Q=f.DataView,Z=A(0),tt=A(2),nt=A(3),rt=A(4),et=A(5),it=A(6),ot=N(!0),ut=N(!1),ct=I.values,ft=I.keys,at=I.entries,st=$.lastIndexOf,lt=$.reduce,ht=$.reduceRight,vt=$.join,pt=$.sort,dt=$.slice,yt=$.toString,gt=$.toLocaleString,bt=M("iterator"),mt=M("toStringTag"),xt=F("typed_constructor"),wt=F("def_constructor"),St=c.CONSTR,_t=c.TYPED,Ot=c.VIEW,Et="Wrong length!",Pt=A(1,function(t,n){return Tt(T(t,t[wt]),n)}),jt=o(function(){return 1===new q(new Uint16Array([1]).buffer)[0]}),Ft=!!q&&!!q[H].set&&o(function(){new q(1).set({})}),Mt=function(t,n){if(void 0===t)throw z(Et);var r=+t,e=d(t);if(n&&!m(r,e))throw V(Et);return e},At=function(t,n){var r=p(t);if(r<0||r%n)throw V("Wrong offset!");return r},Nt=function(t){if(w(t)&&_t in t)return t;throw z(t+" is not a typed array!")},Tt=function(t,n){if(!(w(t)&&xt in t))throw z("It is not a typed array constructor!");return new t(n)},It=function(t,n){return kt(T(t,t[wt]),n)},kt=function(t,n){for(var r=0,e=n.length,i=Tt(t,e);e>r;)i[r]=n[r++];return i},Lt=function(t,n,r){G(t,n,{get:function(){return this._d[r]}})},Rt=function(t){var n,r,e,i,o,u,c=S(t),f=arguments.length,s=f>1?arguments[1]:void 0,l=void 0!==s,h=j(c);if(void 0!=h&&!_(h)){for(u=h.call(c),e=[],n=0;!(o=u.next()).done;n++)e.push(o.value);c=e}for(l&&f>2&&(s=a(s,arguments[2],2)),n=0,r=d(c.length),i=Tt(this,r);r>n;n++)i[n]=l?s(c[n],n):c[n];return i},Ct=function(){for(var t=0,n=arguments.length,r=Tt(this,n);n>t;)r[t]=arguments[t++];return r},Dt=!!q&&o(function(){gt.call(new q(1))}),Ut=function(){return gt.apply(Dt?dt.call(Nt(this)):Nt(this),arguments)},Wt={copyWithin:function(t,n){return D.call(Nt(this),t,n,arguments.length>2?arguments[2]:void 0)},every:function(t){return rt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return C.apply(Nt(this),arguments)},filter:function(t){return It(this,tt(Nt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return et(Nt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return it(Nt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Z(Nt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return ut(Nt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return ot(Nt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return vt.apply(Nt(this),arguments)},lastIndexOf:function(t){return st.apply(Nt(this),arguments)},map:function(t){return Pt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return lt.apply(Nt(this),arguments)},reduceRight:function(t){return ht.apply(Nt(this),arguments)},reverse:function(){for(var t,n=this,r=Nt(n).length,e=Math.floor(r/2),i=0;i<e;)t=n[i],n[i++]=n[--r],n[r]=t;return n},some:function(t){return nt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return pt.call(Nt(this),t)},subarray:function(t,n){var r=Nt(this),e=r.length,i=y(t,e);return new(T(r,r[wt]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,d((void 0===n?e:y(n,e))-i))}},Gt=function(t,n){return It(this,dt.call(Nt(this),t,n))},Bt=function(t){Nt(this);var n=At(arguments[1],1),r=this.length,e=S(t),i=d(e.length),o=0;if(i+n>r)throw V(Et);for(;o<i;)this[n+o]=e[o++]},Vt={entries:function(){return at.call(Nt(this))},keys:function(){return ft.call(Nt(this))},values:function(){return ct.call(Nt(this))}},zt=function(t,n){return w(t)&&t[_t]&&"symbol"!=typeof n&&n in t&&String(+n)==String(n)},qt=function(t,n){return zt(t,n=g(n,!0))?l(2,t[n]):B(t,n)},Kt=function(t,n,r){return!(zt(t,n=g(n,!0))&&w(r)&&b(r,"value"))||b(r,"get")||b(r,"set")||r.configurable||b(r,"writable")&&!r.writable||b(r,"enumerable")&&!r.enumerable?G(t,n,r):(t[n]=r.value,t)};St||(W.f=qt,U.f=Kt),u(u.S+u.F*!St,"Object",{getOwnPropertyDescriptor:qt,defineProperty:Kt}),o(function(){yt.call({})})&&(yt=gt=function(){return vt.call(this)});var Jt=v({},Wt);v(Jt,Vt),h(Jt,bt,Vt.values),v(Jt,{slice:Gt,set:Bt,constructor:function(){},toString:yt,toLocaleString:Ut}),Lt(Jt,"buffer","b"),Lt(Jt,"byteOffset","o"),Lt(Jt,"byteLength","l"),Lt(Jt,"length","e"),G(Jt,mt,{get:function(){return this[_t]}}),t.exports=function(t,n,r,f){f=!!f;var a=t+(f?"Clamped":"")+"Array",l="Uint8Array"!=a,v="get"+t,p="set"+t,y=i[a],g=y||{},b=y&&E(y),m=!y||!c.ABV,S={},_=y&&y[H],j=function(t,r){var e=t._d;return e.v[v](r*n+e.o,jt)},F=function(t,r,e){var i=t._d;f&&(e=(e=Math.round(e))<0?0:e>255?255:255&e),i.v[p](r*n+i.o,e,jt)},M=function(t,n){G(t,n,{get:function(){return j(this,n)},set:function(t){return F(this,n,t)},enumerable:!0})};m?(y=r(function(t,r,e,i){s(t,y,a,"_d");var o,u,c,f,l=0,v=0;if(w(r)){if(!(r instanceof X||(f=x(r))==K||f==J))return _t in r?kt(y,r):Rt.call(y,r);o=r,v=At(e,n);var p=r.byteLength;if(void 0===i){if(p%n)throw V(Et);if((u=p-v)<0)throw V(Et)}else if((u=d(i)*n)+v>p)throw V(Et);c=u/n}else c=Mt(r,!0),u=c*n,o=new X(u);for(h(t,"_d",{b:o,o:v,l:u,e:c,v:new Q(o)});l<c;)M(t,l++)}),_=y[H]=O(Jt),h(_,"constructor",y)):L(function(t){new y(null),new y(t)},!0)||(y=r(function(t,r,e,i){s(t,y,a);var o;return w(r)?r instanceof X||(o=x(r))==K||o==J?void 0!==i?new g(r,At(e,n),i):void 0!==e?new g(r,At(e,n)):new g(r):_t in r?kt(y,r):Rt.call(y,r):new g(Mt(r,l))}),Z(b!==Function.prototype?P(g).concat(P(b)):P(g),function(t){t in y||h(y,t,g[t])}),y[H]=_,e||(_.constructor=y));var A=_[bt],N=!!A&&("values"==A.name||void 0==A.name),T=Vt.values;h(y,xt,!0),h(_,_t,a),h(_,Ot,!0),h(_,wt,y),(f?new y(1)[mt]==a:mt in _)||G(_,mt,{get:function(){return a}}),S[a]=y,u(u.G+u.W+u.F*(y!=g),S),u(u.S,a,{BYTES_PER_ELEMENT:n,from:Rt,of:Ct}),Y in _||h(_,Y,n),u(u.P,a,Wt),R(a),u(u.P+u.F*Ft,a,{set:Bt}),u(u.P+u.F*!N,a,Vt),u(u.P+u.F*(_.toString!=yt),a,{toString:yt}),u(u.P+u.F*o(function(){new y(1).slice()}),a,{slice:Gt}),u(u.P+u.F*(o(function(){return[1,2].toLocaleString()!=new y([1,2]).toLocaleString()})||!o(function(){_.toLocaleString.call([1,2])})),a,{toLocaleString:Ut}),k[a]=N?A:T,e||N||h(_,bt,T)}}else t.exports=function(){}},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n,r){var e=r(21),i=r(5).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n,r){t.exports=!r(12)&&!r(18)(function(){return 7!=Object.defineProperty(r(57)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){"use strict";var e=r(36),i=r(51),o=r(64),u=r(13),c=r(8),f=r(35),a=r(96),s=r(38),l=r(103),h=r(15)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n,r){var e=r(20),i=r(100),o=r(34),u=r(39)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(57)("iframe"),e=o.length;for(n.style.display="none",r(93).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(63),i=r(34).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(8),i=r(9),o=r(90)(!1),u=r(39)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){t.exports=r(13)},function(t,n,r){var e=r(76)("meta"),i=r(6),o=r(24),u=r(11).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(4)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n){t.exports=function(t,n,r,e){if(!(t instanceof n)||void 0!==e&&e in t)throw TypeError(r+": incorrect invocation!");return t}},function(t,n){t.exports=!1},function(t,n,r){var e=r(2),i=r(173),o=r(133),u=r(145)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(132)("iframe"),e=o.length;for(n.style.display="none",r(135).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(175),i=r(133).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n,r){var e=r(175),i=r(133);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(28);t.exports=function(t,n,r){for(var i in n)e(t,i,n[i],r);return t}},function(t,n,r){"use strict";var e=r(3),i=r(11),o=r(10),u=r(7)("species");t.exports=function(t){var n=e[t];o&&n&&!n[u]&&i.f(n,u,{configurable:!0,get:function(){return this}})}},function(t,n,r){var e=r(67),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n,r){var e=r(33);t.exports=function(t){return Object(e(t))}},function(t,n,r){var e=r(7)("unscopables"),i=Array.prototype;void 0==i[e]&&r(27)(i,e,{}),t.exports=function(t){i[e][t]=!0}},function(t,n,r){var e=r(53),i=r(169),o=r(137),u=r(2),c=r(16),f=r(154),a={},s={},n=t.exports=function(t,n,r,l,h){var v,p,d,y,g=h?function(){return t}:f(t),b=e(r,l,n?2:1),m=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(v=c(t.length);v>m;m++)if((y=n?b(u(p=t[m])[0],p[1]):b(t[m]))===a||y===s)return y}else for(d=g.call(t);!(p=d.next()).done;)if((y=i(d,b,p.value,n))===a||y===s)return y};n.BREAK=a,n.RETURN=s},function(t,n){t.exports={}},function(t,n,r){var e=r(11).f,i=r(24),o=r(7)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(1),i=r(46),o=r(4),u=r(150),c="["+u+"]",f="​",a=RegExp("^"+c+c+"*"),s=RegExp(c+c+"*$"),l=function(t,n,r){var i={},c=o(function(){return!!u[t]()||f[t]()!=f}),a=i[t]=c?n(h):u[t];r&&(i[r]=a),e(e.P+e.F*c,"String",i)},h=l.trim=function(t,n){return t=String(i(t)),1&n&&(t=t.replace(a,"")),2&n&&(t=t.replace(s,"")),t};t.exports=l},function(t,n,r){t.exports={default:r(86),__esModule:!0}},function(t,n,r){t.exports={default:r(87),__esModule:!0}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var i=r(84),o=e(i),u=r(83),c=e(u),f="function"==typeof c.default&&"symbol"==typeof o.default?function(t){return typeof t}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":typeof t};n.default="function"==typeof c.default&&"symbol"===f(o.default)?function(t){return void 0===t?"undefined":f(t)}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":void 0===t?"undefined":f(t)}},function(t,n,r){r(110),r(108),r(111),r(112),t.exports=r(25).Symbol},function(t,n,r){r(109),r(113),t.exports=r(44).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,r){var e=r(9),i=r(106),o=r(105);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){var e=r(88);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(19),i=r(62),o=r(37);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){t.exports=r(5).document&&document.documentElement},function(t,n,r){var e=r(56);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n,r){var e=r(56);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(60),i=r(22),o=r(38),u={};r(13)(u,r(15)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,r){var e=r(19),i=r(9);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){var e=r(23)("meta"),i=r(21),o=r(8),u=r(14).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(18)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n,r){var e=r(14),i=r(20),o=r(19);t.exports=r(12)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(37),i=r(22),o=r(9),u=r(42),c=r(8),f=r(58),a=Object.getOwnPropertyDescriptor;n.f=r(12)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(9),i=r(61).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(8),i=r(77),o=r(39)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,r){var e=r(41),i=r(33);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(41),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n,r){var e=r(41),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){"use strict";var e=r(89),i=r(97),o=r(35),u=r(9);t.exports=r(59)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){},function(t,n,r){"use strict";var e=r(104)(!0);r(59)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";var e=r(5),i=r(8),o=r(12),u=r(51),c=r(64),f=r(99).KEY,a=r(18),s=r(40),l=r(38),h=r(23),v=r(15),p=r(44),d=r(43),y=r(98),g=r(92),b=r(95),m=r(20),x=r(9),w=r(42),S=r(22),_=r(60),O=r(102),E=r(101),P=r(14),j=r(19),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(61).f=O.f=Z,r(37).f=X,r(62).f=tt,o&&!r(36)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(13)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){r(43)("asyncIterator")},function(t,n,r){r(43)("observable")},function(t,n,r){r(107);for(var e=r(5),i=r(13),o=r(35),u=r(15)("toStringTag"),c=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],f=0;f<5;f++){var a=c[f],s=e[a],l=s&&s.prototype;l&&!l[u]&&i(l,u,a),o[a]=o.Array}},function(t,n,r){var e=r(45),i=r(7)("toStringTag"),o="Arguments"==e(function(){return arguments}()),u=function(t,n){try{return t[n]}catch(t){}};t.exports=function(t){var n,r,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=u(n=Object(t),i))?r:o?e(n):"Object"==(c=e(n))&&"function"==typeof n.callee?"Arguments":c}},function(t,n,r){var e=r(45);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(30),i=r(16),o=r(75);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){"use strict";var e=r(3),i=r(1),o=r(28),u=r(73),c=r(65),f=r(79),a=r(68),s=r(6),l=r(4),h=r(123),v=r(81),p=r(136);t.exports=function(t,n,r,d,y,g){var b=e[t],m=b,x=y?"set":"add",w=m&&m.prototype,S={},_=function(t){var n=w[t];o(w,t,"delete"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"has"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!s(t)?void 0:n.call(this,0===t?0:t)}:"add"==t?function(t){return n.call(this,0===t?0:t),this}:function(t,r){return n.call(this,0===t?0:t,r),this})};if("function"==typeof m&&(g||w.forEach&&!l(function(){(new m).entries().next()}))){var O=new m,E=O[x](g?{}:-0,1)!=O,P=l(function(){O.has(1)}),j=h(function(t){new m(t)}),F=!g&&l(function(){for(var t=new m,n=5;n--;)t[x](n,n);return!t.has(-0)});j||(m=n(function(n,r){a(n,m,t);var e=p(new b,n,m);return void 0!=r&&f(r,y,e[x],e),e}),m.prototype=w,w.constructor=m),(P||F)&&(_("delete"),_("has"),y&&_("get")),(F||E)&&_(x),g&&w.clear&&delete w.clear}else m=d.getConstructor(n,t,y,x),u(m.prototype,r),c.NEED=!0;return v(m,t),S[t]=m,i(i.G+i.W+i.F*(m!=b),S),g||d.setStrong(m,t,y),m}},function(t,n,r){"use strict";var e=r(27),i=r(28),o=r(4),u=r(46),c=r(7);t.exports=function(t,n,r){var f=c(t),a=r(u,f,""[t]),s=a[0],l=a[1];o(function(){var n={};return n[f]=function(){return 7},7!=""[t](n)})&&(i(String.prototype,t,s),e(RegExp.prototype,f,2==n?function(t,n){return l.call(t,this,n)}:function(t){return l.call(t,this)}))}
},function(t,n,r){"use strict";var e=r(2);t.exports=function(){var t=e(this),n="";return t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),t.sticky&&(n+="y"),n}},function(t,n){t.exports=function(t,n,r){var e=void 0===r;switch(n.length){case 0:return e?t():t.call(r);case 1:return e?t(n[0]):t.call(r,n[0]);case 2:return e?t(n[0],n[1]):t.call(r,n[0],n[1]);case 3:return e?t(n[0],n[1],n[2]):t.call(r,n[0],n[1],n[2]);case 4:return e?t(n[0],n[1],n[2],n[3]):t.call(r,n[0],n[1],n[2],n[3])}return t.apply(r,n)}},function(t,n,r){var e=r(6),i=r(45),o=r(7)("match");t.exports=function(t){var n;return e(t)&&(void 0!==(n=t[o])?!!n:"RegExp"==i(t))}},function(t,n,r){var e=r(7)("iterator"),i=!1;try{var o=[7][e]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,n){if(!n&&!i)return!1;var r=!1;try{var o=[7],u=o[e]();u.next=function(){return{done:r=!0}},o[e]=function(){return u},t(o)}catch(t){}return r}},function(t,n,r){t.exports=r(69)||!r(4)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete r(3)[t]})},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(3),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n,r){for(var e,i=r(3),o=r(27),u=r(76),c=u("typed_array"),f=u("view"),a=!(!i.ArrayBuffer||!i.DataView),s=a,l=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(e=i[h[l++]])?(o(e.prototype,c,!0),o(e.prototype,f,!0)):s=!1;t.exports={ABV:a,CONSTR:s,TYPED:c,VIEW:f}},function(t,n){"use strict";var r={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&-1==t.indexOf("KHTML"),mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:-1==t.indexOf("Safari"),weixin:-1==t.indexOf("MicroMessenger")}}()};t.exports=r},function(t,n,r){"use strict";var e=r(85),i=function(t){return t&&t.__esModule?t:{default:t}}(e),o=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):r[t]||t}function n(t){return e[t]}var r={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},e={};for(var u in r)e[r[u]]=u;return r["&apos;"]="'",e["'"]="&#39;",{encode:function(t){return t?(""+t).replace(/['<> "&]/g,n).replace(/\r?\n/g,"<br/>").replace(/\s/g,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(/<br\s*\/?>/gi,"\n").replace(/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,t).replace(/\u00a0/g," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r+=2)n.push(String.fromCharCode("0x"+t.slice(r,r+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,r=t.length;r>n;n++)t[n]=o.encodeObject(t[n]);else if("object"==(void 0===t?"undefined":(0,i.default)(t)))for(var e in t)t[e]=o.encodeObject(t[e]);else if("string"==typeof t)return o.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=o},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=function(t){for(var n=e(this),r=o(n.length),u=arguments.length,c=i(u>1?arguments[1]:void 0,r),f=u>2?arguments[2]:void 0,a=void 0===f?r:i(f,r);a>c;)n[c++]=t;return n}},function(t,n,r){"use strict";var e=r(11),i=r(66);t.exports=function(t,n,r){n in t?e.f(t,n,i(0,r)):t[n]=r}},function(t,n,r){var e=r(6),i=r(3).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n,r){var e=r(7)("match");t.exports=function(t){var n=/./;try{"/./"[t](n)}catch(r){try{return n[e]=!1,!"/./"[t](n)}catch(t){}}return!0}},function(t,n,r){t.exports=r(3).document&&document.documentElement},function(t,n,r){var e=r(6),i=r(144).set;t.exports=function(t,n,r){var o,u=n.constructor;return u!==r&&"function"==typeof u&&(o=u.prototype)!==r.prototype&&e(o)&&i&&i(t,o),t}},function(t,n,r){var e=r(80),i=r(7)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(e.Array===t||o[i]===t)}},function(t,n,r){var e=r(45);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(70),i=r(66),o=r(81),u={};r(27)(u,r(7)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n,r){"use strict";var e=r(69),i=r(1),o=r(28),u=r(27),c=r(24),f=r(80),a=r(139),s=r(81),l=r(32),h=r(7)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n){var r=Math.expm1;t.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:r},function(t,n){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,n,r){var e=r(3),i=r(151).set,o=e.MutationObserver||e.WebKitMutationObserver,u=e.process,c=e.Promise,f="process"==r(45)(u);t.exports=function(){var t,n,r,a=function(){var e,i;for(f&&(e=u.domain)&&e.exit();t;){i=t.fn,t=t.next;try{i()}catch(e){throw t?r():n=void 0,e}}n=void 0,e&&e.enter()};if(f)r=function(){u.nextTick(a)};else if(o){var s=!0,l=document.createTextNode("");new o(a).observe(l,{characterData:!0}),r=function(){l.data=s=!s}}else if(c&&c.resolve){var h=c.resolve();r=function(){h.then(a)}}else r=function(){i.call(e,a)};return function(e){var i={fn:e,next:void 0};n&&(n.next=i),t||(t=i,r()),n=i}}},function(t,n,r){var e=r(6),i=r(2),o=function(t,n){if(i(t),!e(n)&&null!==n)throw TypeError(n+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,e){try{e=r(53)(Function.call,r(31).f(Object.prototype,"__proto__").set,2),e(t,[]),n=!(t instanceof Array)}catch(t){n=!0}return function(t,r){return o(t,r),n?t.__proto__=r:e(t,r),t}}({},!1):void 0),check:o}},function(t,n,r){var e=r(126)("keys"),i=r(76);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(2),i=r(26),o=r(7)("species");t.exports=function(t,n){var r,u=e(t).constructor;return void 0===u||void 0==(r=e(u)[o])?n:i(r)}},function(t,n,r){var e=r(67),i=r(46);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(122),i=r(46);t.exports=function(t,n,r){if(e(n))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(t))}},function(t,n,r){"use strict";var e=r(67),i=r(46);t.exports=function(t){var n=String(i(this)),r="",o=e(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(n+=n))1&o&&(r+=n);return r}},function(t,n){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,n,r){var e,i,o,u=r(53),c=r(121),f=r(135),a=r(132),s=r(3),l=s.process,h=s.setImmediate,v=s.clearImmediate,p=s.MessageChannel,d=0,y={},g="onreadystatechange",b=function(){var t=+this;if(y.hasOwnProperty(t)){var n=y[t];delete y[t],n()}},m=function(t){b.call(t.data)};h&&v||(h=function(t){for(var n=[],r=1;arguments.length>r;)n.push(arguments[r++]);return y[++d]=function(){c("function"==typeof t?t:Function(t),n)},e(d),d},v=function(t){delete y[t]},"process"==r(45)(l)?e=function(t){l.nextTick(u(b,t,1))}:p?(i=new p,o=i.port2,i.port1.onmessage=m,e=u(o.postMessage,o,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts?(e=function(t){s.postMessage(t+"","*")},s.addEventListener("message",m,!1)):e=g in a("script")?function(t){f.appendChild(a("script"))[g]=function(){f.removeChild(this),b.call(t)}}:function(t){setTimeout(u(b,t,1),0)}),t.exports={set:h,clear:v}},function(t,n,r){"use strict";var e=r(3),i=r(10),o=r(69),u=r(127),c=r(27),f=r(73),a=r(4),s=r(68),l=r(67),h=r(16),v=r(71).f,p=r(11).f,d=r(130),y=r(81),g="ArrayBuffer",b="DataView",m="prototype",x="Wrong length!",w="Wrong index!",S=e[g],_=e[b],O=e.Math,E=e.RangeError,P=e.Infinity,j=S,F=O.abs,M=O.pow,A=O.floor,N=O.log,T=O.LN2,I="buffer",k="byteLength",L="byteOffset",R=i?"_b":I,C=i?"_l":k,D=i?"_o":L,U=function(t,n,r){var e,i,o,u=Array(r),c=8*r-n-1,f=(1<<c)-1,a=f>>1,s=23===n?M(2,-24)-M(2,-77):0,l=0,h=t<0||0===t&&1/t<0?1:0;for(t=F(t),t!=t||t===P?(i=t!=t?1:0,e=f):(e=A(N(t)/T),t*(o=M(2,-e))<1&&(e--,o*=2),t+=e+a>=1?s/o:s*M(2,1-a),t*o>=2&&(e++,o/=2),e+a>=f?(i=0,e=f):e+a>=1?(i=(t*o-1)*M(2,n),e+=a):(i=t*M(2,a-1)*M(2,n),e=0));n>=8;u[l++]=255&i,i/=256,n-=8);for(e=e<<n|i,c+=n;c>0;u[l++]=255&e,e/=256,c-=8);return u[--l]|=128*h,u},W=function(t,n,r){var e,i=8*r-n-1,o=(1<<i)-1,u=o>>1,c=i-7,f=r-1,a=t[f--],s=127&a;for(a>>=7;c>0;s=256*s+t[f],f--,c-=8);for(e=s&(1<<-c)-1,s>>=-c,c+=n;c>0;e=256*e+t[f],f--,c-=8);if(0===s)s=1-u;else{if(s===o)return e?NaN:a?-P:P;e+=M(2,n),s-=u}return(a?-1:1)*e*M(2,s-n)},G=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},B=function(t){return[255&t]},V=function(t){return[255&t,t>>8&255]},z=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},q=function(t){return U(t,52,8)},K=function(t){return U(t,23,4)},J=function(t,n,r){p(t[m],n,{get:function(){return this[r]}})},Y=function(t,n,r,e){var i=+r,o=l(i);if(i!=o||o<0||o+n>t[C])throw E(w);var u=t[R]._b,c=o+t[D],f=u.slice(c,c+n);return e?f:f.reverse()},H=function(t,n,r,e,i,o){var u=+r,c=l(u);if(u!=c||c<0||c+n>t[C])throw E(w);for(var f=t[R]._b,a=c+t[D],s=e(+i),h=0;h<n;h++)f[a+h]=s[o?h:n-h-1]},$=function(t,n){s(t,S,g);var r=+n,e=h(r);if(r!=e)throw E(x);return e};if(u.ABV){if(!a(function(){new S})||!a(function(){new S(.5)})){S=function(t){return new j($(this,t))};for(var X,Q=S[m]=j[m],Z=v(j),tt=0;Z.length>tt;)(X=Z[tt++])in S||c(S,X,j[X]);o||(Q.constructor=S)}var nt=new _(new S(2)),rt=_[m].setInt8;nt.setInt8(0,2147483648),nt.setInt8(1,2147483649),!nt.getInt8(0)&&nt.getInt8(1)||f(_[m],{setInt8:function(t,n){rt.call(this,t,n<<24>>24)},setUint8:function(t,n){rt.call(this,t,n<<24>>24)}},!0)}else S=function(t){var n=$(this,t);this._b=d.call(Array(n),0),this[C]=n},_=function(t,n,r){s(this,_,b),s(t,S,b);var e=t[C],i=l(n);if(i<0||i>e)throw E("Wrong offset!");if(r=void 0===r?e-i:h(r),i+r>e)throw E(x);this[R]=t,this[D]=i,this[C]=r},i&&(J(S,k,"_l"),J(_,I,"_b"),J(_,k,"_l"),J(_,L,"_o")),f(_[m],{getInt8:function(t){return Y(this,1,t)[0]<<24>>24},getUint8:function(t){return Y(this,1,t)[0]},getInt16:function(t){var n=Y(this,2,t,arguments[1]);return(n[1]<<8|n[0])<<16>>16},getUint16:function(t){var n=Y(this,2,t,arguments[1]);return n[1]<<8|n[0]},getInt32:function(t){return G(Y(this,4,t,arguments[1]))},getUint32:function(t){return G(Y(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return W(Y(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return W(Y(this,8,t,arguments[1]),52,8)},setInt8:function(t,n){H(this,1,t,B,n)},setUint8:function(t,n){H(this,1,t,B,n)},setInt16:function(t,n){H(this,2,t,V,n,arguments[2])},setUint16:function(t,n){H(this,2,t,V,n,arguments[2])},setInt32:function(t,n){H(this,4,t,z,n,arguments[2])},setUint32:function(t,n){H(this,4,t,z,n,arguments[2])},setFloat32:function(t,n){H(this,4,t,K,n,arguments[2])},setFloat64:function(t,n){H(this,8,t,q,n,arguments[2])}});y(S,g),y(_,b),c(_[m],u.VIEW,!0),n[g]=S,n[b]=_},function(t,n,r){var e=r(3),i=r(52),o=r(69),u=r(182),c=r(11).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){var e=r(114),i=r(7)("iterator"),o=r(80);t.exports=r(52).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[e(t)]}},function(t,n,r){"use strict";var e=r(78),i=r(170),o=r(80),u=r(30);t.exports=r(140)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){function r(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=r},function(t,n){function r(t,n){if(t.classList)t.classList.remove(n);else{var r=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(r," ")}}t.exports=r},function(t,n){function r(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function i(t){if(s===setTimeout)return setTimeout(t,0);if((s===r||!s)&&setTimeout)return s=setTimeout,setTimeout(t,0);try{return s(t,0)}catch(n){try{return s.call(null,t,0)}catch(n){return s.call(this,t,0)}}}function o(t){if(l===clearTimeout)return clearTimeout(t);if((l===e||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(n){try{return l.call(null,t)}catch(n){return l.call(this,t)}}}function u(){d&&v&&(d=!1,v.length?p=v.concat(p):y=-1,p.length&&c())}function c(){if(!d){var t=i(u);d=!0;for(var n=p.length;n;){for(v=p,p=[];++y<n;)v&&v[y].run();y=-1,n=p.length}v=null,d=!1,o(t)}}function f(t,n){this.fun=t,this.array=n}function a(){}var s,l,h=t.exports={};!function(){try{s="function"==typeof setTimeout?setTimeout:r}catch(t){s=r}try{l="function"==typeof clearTimeout?clearTimeout:e}catch(t){l=e}}();var v,p=[],d=!1,y=-1;h.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];p.push(new f(t,n)),1!==p.length||d||i(c)},f.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=a,h.addListener=a,h.once=a,h.off=a,h.removeListener=a,h.removeAllListeners=a,h.emit=a,h.prependListener=a,h.prependOnceListener=a,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,n,r){var e=r(45);t.exports=function(t,n){if("number"!=typeof t&&"Number"!=e(t))throw TypeError(n);return+t}},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=[].copyWithin||function(t,n){var r=e(this),u=o(r.length),c=i(t,u),f=i(n,u),a=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===a?u:i(a,u))-f,u-c),l=1;for(f<c&&c<f+s&&(l=-1,f+=s-1,c+=s-1);s-- >0;)f in r?r[c]=r[f]:delete r[c],c+=l,f+=l;return r}},function(t,n,r){var e=r(79);t.exports=function(t,n){var r=[];return e(t,!1,r.push,r,n),r}},function(t,n,r){var e=r(26),i=r(17),o=r(115),u=r(16);t.exports=function(t,n,r,c,f){e(n);var a=i(t),s=o(a),l=u(a.length),h=f?l-1:0,v=f?-1:1;if(r<2)for(;;){if(h in s){c=s[h],h+=v;break}if(h+=v,f?h<0:l<=h)throw TypeError("Reduce of empty array with no initial value")}for(;f?h>=0:l>h;h+=v)h in s&&(c=n(c,s[h],h,a));return c}},function(t,n,r){"use strict";var e=r(26),i=r(6),o=r(121),u=[].slice,c={},f=function(t,n,r){if(!(n in c)){for(var e=[],i=0;i<n;i++)e[i]="a["+i+"]";c[n]=Function("F,a","return new F("+e.join(",")+")")}return c[n](t,r)};t.exports=Function.bind||function(t){var n=e(this),r=u.call(arguments,1),c=function(){var e=r.concat(u.call(arguments));return this instanceof c?f(n,e.length,e):o(n,e,t)};return i(n.prototype)&&(c.prototype=n.prototype),c}},function(t,n,r){"use strict";var e=r(11).f,i=r(70),o=r(73),u=r(53),c=r(68),f=r(46),a=r(79),s=r(140),l=r(170),h=r(74),v=r(10),p=r(65).fastKey,d=v?"_s":"size",y=function(t,n){var r,e=p(n);if("F"!==e)return t._i[e];for(r=t._f;r;r=r.n)if(r.k==n)return r};t.exports={getConstructor:function(t,n,r,s){var l=t(function(t,e){c(t,l,n,"_i"),t._i=i(null),t._f=void 0,t._l=void 0,t[d]=0,void 0!=e&&a(e,r,t[s],t)});return o(l.prototype,{clear:function(){for(var t=this,n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[d]=0},delete:function(t){var n=this,r=y(n,t);if(r){var e=r.n,i=r.p;delete n._i[r.i],r.r=!0,i&&(i.n=e),e&&(e.p=i),n._f==r&&(n._f=e),n._l==r&&(n._l=i),n[d]--}return!!r},forEach:function(t){c(this,l,"forEach");for(var n,r=u(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!y(this,t)}}),v&&e(l.prototype,"size",{get:function(){return f(this[d])}}),l},def:function(t,n,r){var e,i,o=y(t,n);return o?o.v=r:(t._l=o={i:i=p(n,!0),k:n,v:r,p:e=t._l,n:void 0,r:!1},t._f||(t._f=o),e&&(e.n=o),t[d]++,"F"!==i&&(t._i[i]=o)),t},getEntry:y,setStrong:function(t,n,r){s(t,n,function(t,n){this._t=t,this._k=n,this._l=void 0},function(){for(var t=this,n=t._k,r=t._l;r&&r.r;)r=r.p;return t._t&&(t._l=r=r?r.n:t._t._f)?"keys"==n?l(0,r.k):"values"==n?l(0,r.v):l(0,[r.k,r.v]):(t._t=void 0,l(1))},r?"entries":"values",!r,!0),h(n)}}},function(t,n,r){var e=r(114),i=r(161);t.exports=function(t){return function(){if(e(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,n,r){"use strict";var e=r(73),i=r(65).getWeak,o=r(2),u=r(6),c=r(68),f=r(79),a=r(48),s=r(24),l=a(5),h=a(6),v=0,p=function(t){return t._l||(t._l=new d)},d=function(){this.a=[]},y=function(t,n){return l(t.a,function(t){return t[0]===n})};d.prototype={get:function(t){var n=y(this,t);if(n)return n[1]},has:function(t){return!!y(this,t)},set:function(t,n){var r=y(this,t);r?r[1]=n:this.a.push([t,n])},delete:function(t){var n=h(this.a,function(n){return n[0]===t});return~n&&this.a.splice(n,1),!!~n}},t.exports={getConstructor:function(t,n,r,o){var a=t(function(t,e){c(t,a,n,"_i"),t._i=v++,t._l=void 0,void 0!=e&&f(e,r,t[o],t)});return e(a.prototype,{delete:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).delete(t):n&&s(n,this._i)&&delete n[this._i]},has:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).has(t):n&&s(n,this._i)}}),a},def:function(t,n,r){var e=i(o(n),!0);return!0===e?p(t).set(n,r):e[t._i]=r,t},ufstore:p}},function(t,n,r){t.exports=!r(10)&&!r(4)(function(){return 7!=Object.defineProperty(r(132)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(6),i=Math.floor;t.exports=function(t){return!e(t)&&isFinite(t)&&i(t)===t}},function(t,n,r){var e=r(2);t.exports=function(t,n,r,i){try{return i?n(e(r)[0],r[1]):n(r)}catch(n){var o=t.return;throw void 0!==o&&e(o.call(t)),n}}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,n,r){"use strict";var e=r(72),i=r(125),o=r(116),u=r(17),c=r(115),f=Object.assign;t.exports=!f||r(4)(function(){var t={},n={},r=Symbol(),e="abcdefghijklmnopqrst";return t[r]=7,e.split("").forEach(function(t){n[t]=t}),7!=f({},t)[r]||Object.keys(f({},n)).join("")!=e})?function(t,n){for(var r=u(t),f=arguments.length,a=1,s=i.f,l=o.f;f>a;)for(var h,v=c(arguments[a++]),p=s?e(v).concat(s(v)):e(v),d=p.length,y=0;d>y;)l.call(v,h=p[y++])&&(r[h]=v[h]);return r}:f},function(t,n,r){var e=r(11),i=r(2),o=r(72);t.exports=r(10)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(30),i=r(71).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(24),i=r(30),o=r(117)(!1),u=r(145)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){var e=r(72),i=r(30),o=r(116).f;t.exports=function(t){return function(n){for(var r,u=i(n),c=e(u),f=c.length,a=0,s=[];f>a;)o.call(u,r=c[a++])&&s.push(t?[r,u[r]]:u[r]);return s}}},function(t,n,r){var e=r(71),i=r(125),o=r(2),u=r(3).Reflect;t.exports=u&&u.ownKeys||function(t){var n=e.f(o(t)),r=i.f;return r?n.concat(r(t)):n}},function(t,n,r){var e=r(3).parseFloat,i=r(82).trim;t.exports=1/e(r(150)+"-0")!=-1/0?function(t){var n=i(String(t),3),r=e(n);return 0===r&&"-"==n.charAt(0)?-0:r}:e},function(t,n,r){var e=r(3).parseInt,i=r(82).trim,o=r(150),u=/^[\-+]?0[xX]/;t.exports=8!==e(o+"08")||22!==e(o+"0x16")?function(t,n){var r=i(String(t),3);return e(r,n>>>0||(u.test(r)?16:10))}:e},function(t,n){t.exports=Object.is||function(t,n){return t===n?0!==t||1/t==1/n:t!=t&&n!=n}},function(t,n,r){var e=r(16),i=r(149),o=r(46);t.exports=function(t,n,r,u){var c=String(o(t)),f=c.length,a=void 0===r?" ":String(r),s=e(n);if(s<=f||""==a)return c;var l=s-f,h=i.call(a,Math.ceil(l/a.length));return h.length>l&&(h=h.slice(0,l)),u?h+c:c+h}},function(t,n,r){n.f=r(7)},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var n=e.getEntry(this,t);return n&&n.v},set:function(t,n){return e.def(this,0===t?0:t,n)}},e,!0)},function(t,n,r){r(10)&&"g"!=/./g.flags&&r(11).f(RegExp.prototype,"flags",{configurable:!0,get:r(120)})},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t=0===t?0:t,t)}},e)},function(t,n,r){"use strict";var e,i=r(48)(0),o=r(28),u=r(65),c=r(172),f=r(166),a=r(6),s=u.getWeak,l=Object.isExtensible,h=f.ufstore,v={},p=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},d={get:function(t){if(a(t)){var n=s(t);return!0===n?h(this).get(t):n?n[this._i]:void 0}},set:function(t,n){return f.def(this,t,n)}},y=t.exports=r(118)("WeakMap",p,d,f,!0,!0);7!=(new y).set((Object.freeze||Object)(v),7).get(v)&&(e=f.getConstructor(p),c(e.prototype,d),u.NEED=!0,i(["delete","has","get","set"],function(t){var n=y.prototype,r=n[t];o(n,t,function(n,i){if(a(n)&&!l(n)){this._f||(this._f=new e);var o=this._f[t](n,i);return"set"==t?this:o}return r.call(this,n,i)})}))},,,,function(t,n){"use strict";function r(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){document.querySelectorAll(".article-entry a:not(.article-more-a)").forEach(function(t){var n=t.getAttribute("target");n&&""!==n||t.setAttribute("target","_blank")})}if(yiliaConfig&&yiliaConfig.toc_hide_index){document.querySelectorAll(".toc-number").forEach(function(t){t.style.display="none"})}var n=document.querySelector("#js-aboutme");n&&0!==n.length&&(n.innerHTML=n.innerText)}t.exports={init:r}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}function i(t,n){var r=/\/|index.html/g;return t.replace(r,"")===n.replace(r,"")}function o(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,r=0,e=t.length;r<e;r++){var o=t[r];i(n,o.getAttribute("href"))&&(0,h.default)(o,"active")}}function u(t){for(var n=t.offsetLeft,r=t.offsetParent;null!==r;)n+=r.offsetLeft,r=r.offsetParent;return n}function c(t){for(var n=t.offsetTop,r=t.offsetParent;null!==r;)n+=r.offsetTop,r=r.offsetParent;return n}function f(t,n,r,e,i){var o=u(t),f=c(t)-n;if(f-r<=i){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,d.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(r||f)+"px",a.style.left=o+"px",a.style.zIndex=e||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");f(t,document.body.scrollTop,-63,2,0),f(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}var l=r(156),h=e(l),v=r(157),p=(e(v),r(382)),d=e(p),y=r(128),g=e(y),b=r(190),m=e(b),x=r(129);(function(){g.default.versions.mobile&&window.screen.width<800&&(o(),s())})(),(0,x.addLoadEvent)(function(){m.default.init()}),t.exports={}},,,,function(t,n,r){(function(t){"use strict";function n(t,n,r){t[n]||Object[e](t,n,{writable:!0,configurable:!0,value:r})}if(r(381),r(391),r(198),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var e="defineProperty";n(String.prototype,"padLeft","".padStart),n(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&n(Array,t,Function.call.bind([][t]))})}).call(n,function(){return this}())},,,function(t,n,r){r(210),t.exports=r(52).RegExp.escape},,,,function(t,n,r){var e=r(6),i=r(138),o=r(7)("species");t.exports=function(t){var n;return i(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)||(n=void 0),e(n)&&null===(n=n[o])&&(n=void 0)),void 0===n?Array:n}},function(t,n,r){var e=r(202);t.exports=function(t,n){return new(e(t))(n)}},function(t,n,r){"use strict";var e=r(2),i=r(50),o="number";t.exports=function(t){if("string"!==t&&t!==o&&"default"!==t)throw TypeError("Incorrect hint");return i(e(this),t!=o)}},function(t,n,r){var e=r(72),i=r(125),o=r(116);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){var e=r(72),i=r(30);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){"use strict";var e=r(208),i=r(121),o=r(26);t.exports=function(){for(var t=o(this),n=arguments.length,r=Array(n),u=0,c=e._,f=!1;n>u;)(r[u]=arguments[u++])===c&&(f=!0);return function(){var e,o=this,u=arguments.length,a=0,s=0;if(!f&&!u)return i(t,r,o);if(e=r.slice(),f)for(;n>a;a++)e[a]===c&&(e[a]=arguments[s++]);for(;u>s;)e.push(arguments[s++]);return i(t,e,o)}}},function(t,n,r){t.exports=r(3)},function(t,n){t.exports=function(t,n){var r=n===Object(n)?function(t){return n[t]}:n;return function(n){return String(n).replace(t,r)}}},function(t,n,r){var e=r(1),i=r(209)(/[\\^$*+?.()|[\]{}]/g,"\\$&");e(e.S,"RegExp",{escape:function(t){return i(t)}})},function(t,n,r){var e=r(1);e(e.P,"Array",{copyWithin:r(160)}),r(78)("copyWithin")},function(t,n,r){"use strict";var e=r(1),i=r(48)(4);e(e.P+e.F*!r(47)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.P,"Array",{fill:r(130)}),r(78)("fill")},function(t,n,r){"use strict";var e=r(1),i=r(48)(2);e(e.P+e.F*!r(47)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(6),o="findIndex",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(5),o="find",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(0),o=r(47)([].forEach,!0);e(e.P+e.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(53),i=r(1),o=r(17),u=r(169),c=r(137),f=r(16),a=r(131),s=r(154);i(i.S+i.F*!r(123)(function(t){Array.from(t)}),"Array",{from:function(t){var n,r,i,l,h=o(t),v="function"==typeof this?this:Array,p=arguments.length,d=p>1?arguments[1]:void 0,y=void 0!==d,g=0,b=s(h);if(y&&(d=e(d,p>2?arguments[2]:void 0,2)),void 0==b||v==Array&&c(b))for(n=f(h.length),r=new v(n);n>g;g++)a(r,g,y?d(h[g],g):h[g]);else for(l=b.call(h),r=new v;!(i=l.next()).done;g++)a(r,g,y?u(l,d,[i.value,g],!0):i.value);return r.length=g,r}})},function(t,n,r){"use strict";var e=r(1),i=r(117)(!1),o=[].indexOf,u=!!o&&1/[1].indexOf(1,-0)<0;e(e.P+e.F*(u||!r(47)(o)),"Array",{indexOf:function(t){return u?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.S,"Array",{isArray:r(138)})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=[].join;e(e.P+e.F*(r(115)!=Object||!r(47)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=r(67),u=r(16),c=[].lastIndexOf,f=!!c&&1/[1].lastIndexOf(1,-0)<0;e(e.P+e.F*(f||!r(47)(c)),"Array",{lastIndexOf:function(t){if(f)return c.apply(this,arguments)||0;var n=i(this),r=u(n.length),e=r-1;for(arguments.length>1&&(e=Math.min(e,o(arguments[1]))),e<0&&(e=r+e);e>=0;e--)if(e in n&&n[e]===t)return e||0;return-1}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(1);e(e.P+e.F*!r(47)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(131);e(e.S+e.F*r(4)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,n=arguments.length,r=new("function"==typeof this?this:Array)(n);n>t;)i(r,t,arguments[t++]);return r.length=n,r}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(135),o=r(45),u=r(75),c=r(16),f=[].slice;e(e.P+e.F*r(4)(function(){i&&f.call(i)}),"Array",{slice:function(t,n){var r=c(this.length),e=o(this);if(n=void 0===n?r:n,"Array"==e)return f.call(this,t,n);for(var i=u(t,r),a=u(n,r),s=c(a-i),l=Array(s),h=0;h<s;h++)l[h]="String"==e?this.charAt(i+h):this[i+h];return l}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(3);e(e.P+e.F*!r(47)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(26),o=r(17),u=r(4),c=[].sort,f=[1,2,3];e(e.P+e.F*(u(function(){f.sort(void 0)})||!u(function(){f.sort(null)})||!r(47)(c)),"Array",{sort:function(t){return void 0===t?c.call(o(this)):c.call(o(this),i(t))}})},function(t,n,r){r(74)("Array")},function(t,n,r){var e=r(1);e(e.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=Date.prototype.getTime,u=function(t){return t>9?t:"0"+t};e(e.P+e.F*(i(function(){return"0385-07-25T07:06:39.999Z"!=new Date(-5e13-1).toISOString()})||!i(function(){new Date(NaN).toISOString()})),"Date",{toISOString:function(){
if(!isFinite(o.call(this)))throw RangeError("Invalid time value");var t=this,n=t.getUTCFullYear(),r=t.getUTCMilliseconds(),e=n<0?"-":n>9999?"+":"";return e+("00000"+Math.abs(n)).slice(e?-6:-4)+"-"+u(t.getUTCMonth()+1)+"-"+u(t.getUTCDate())+"T"+u(t.getUTCHours())+":"+u(t.getUTCMinutes())+":"+u(t.getUTCSeconds())+"."+(r>99?r:"0"+u(r))+"Z"}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50);e(e.P+e.F*r(4)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var n=i(this),r=o(n);return"number"!=typeof r||isFinite(r)?n.toISOString():null}})},function(t,n,r){var e=r(7)("toPrimitive"),i=Date.prototype;e in i||r(27)(i,e,r(204))},function(t,n,r){var e=Date.prototype,i="Invalid Date",o="toString",u=e[o],c=e.getTime;new Date(NaN)+""!=i&&r(28)(e,o,function(){var t=c.call(this);return t===t?u.call(this):i})},function(t,n,r){var e=r(1);e(e.P,"Function",{bind:r(163)})},function(t,n,r){"use strict";var e=r(6),i=r(32),o=r(7)("hasInstance"),u=Function.prototype;o in u||r(11).f(u,o,{value:function(t){if("function"!=typeof this||!e(t))return!1;if(!e(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,n,r){var e=r(11).f,i=r(66),o=r(24),u=Function.prototype,c="name",f=Object.isExtensible||function(){return!0};c in u||r(10)&&e(u,c,{configurable:!0,get:function(){try{var t=this,n=(""+t).match(/^\s*function ([^ (]*)/)[1];return o(t,c)||!f(t)||e(t,c,i(5,n)),n}catch(t){return""}}})},function(t,n,r){var e=r(1),i=r(171),o=Math.sqrt,u=Math.acosh;e(e.S+e.F*!(u&&710==Math.floor(u(Number.MAX_VALUE))&&u(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,n,r){function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}var i=r(1),o=Math.asinh;i(i.S+i.F*!(o&&1/o(0)>0),"Math",{asinh:e})},function(t,n,r){var e=r(1),i=Math.atanh;e(e.S+e.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,n,r){var e=r(1),i=r(142);e(e.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,n,r){var e=r(1),i=Math.exp;e(e.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,n,r){var e=r(1),i=r(141);e(e.S+e.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,n,r){var e=r(1),i=r(142),o=Math.pow,u=o(2,-52),c=o(2,-23),f=o(2,127)*(2-c),a=o(2,-126),s=function(t){return t+1/u-1/u};e(e.S,"Math",{fround:function(t){var n,r,e=Math.abs(t),o=i(t);return e<a?o*s(e/a/c)*a*c:(n=(1+c/u)*e,r=n-(n-e),r>f||r!=r?o*(1/0):o*r)}})},function(t,n,r){var e=r(1),i=Math.abs;e(e.S,"Math",{hypot:function(t,n){for(var r,e,o=0,u=0,c=arguments.length,f=0;u<c;)r=i(arguments[u++]),f<r?(e=f/r,o=o*e*e+1,f=r):r>0?(e=r/f,o+=e*e):o+=r;return f===1/0?1/0:f*Math.sqrt(o)}})},function(t,n,r){var e=r(1),i=Math.imul;e(e.S+e.F*r(4)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,n){var r=65535,e=+t,i=+n,o=r&e,u=r&i;return 0|o*u+((r&e>>>16)*u+o*(r&i>>>16)<<16>>>0)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log10:function(t){return Math.log(t)/Math.LN10}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log1p:r(171)})},function(t,n,r){var e=r(1);e(e.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,n,r){var e=r(1);e(e.S,"Math",{sign:r(142)})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S+e.F*r(4)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S,"Math",{tanh:function(t){var n=i(t=+t),r=i(-t);return n==1/0?1:r==1/0?-1:(n-r)/(o(t)+o(-t))}})},function(t,n,r){var e=r(1);e(e.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(45),u=r(136),c=r(50),f=r(4),a=r(71).f,s=r(31).f,l=r(11).f,h=r(82).trim,v="Number",p=e[v],d=p,y=p.prototype,g=o(r(70)(y))==v,b="trim"in String.prototype,m=function(t){var n=c(t,!1);if("string"==typeof n&&n.length>2){n=b?n.trim():h(n,3);var r,e,i,o=n.charCodeAt(0);if(43===o||45===o){if(88===(r=n.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(n.charCodeAt(1)){case 66:case 98:e=2,i=49;break;case 79:case 111:e=8,i=55;break;default:return+n}for(var u,f=n.slice(2),a=0,s=f.length;a<s;a++)if((u=f.charCodeAt(a))<48||u>i)return NaN;return parseInt(f,e)}}return+n};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var n=arguments.length<1?0:t,r=this;return r instanceof p&&(g?f(function(){y.valueOf.call(r)}):o(r)!=v)?u(new d(m(n)),r,p):m(n)};for(var x,w=r(10)?a(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;w.length>S;S++)i(d,x=w[S])&&!i(p,x)&&l(p,x,s(d,x));p.prototype=y,y.constructor=p,r(28)(e,v,p)}},function(t,n,r){var e=r(1);e(e.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,n,r){var e=r(1),i=r(3).isFinite;e(e.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,n,r){var e=r(1);e(e.S,"Number",{isInteger:r(168)})},function(t,n,r){var e=r(1);e(e.S,"Number",{isNaN:function(t){return t!=t}})},function(t,n,r){var e=r(1),i=r(168),o=Math.abs;e(e.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,n,r){var e=r(1);e(e.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,n,r){var e=r(1);e(e.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,n,r){var e=r(1),i=r(178);e(e.S+e.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.S+e.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,n,r){"use strict";var e=r(1),i=r(67),o=r(159),u=r(149),c=1..toFixed,f=Math.floor,a=[0,0,0,0,0,0],s="Number.toFixed: incorrect invocation!",l="0",h=function(t,n){for(var r=-1,e=n;++r<6;)e+=t*a[r],a[r]=e%1e7,e=f(e/1e7)},v=function(t){for(var n=6,r=0;--n>=0;)r+=a[n],a[n]=f(r/t),r=r%t*1e7},p=function(){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==a[t]){var r=String(a[t]);n=""===n?r:n+u.call(l,7-r.length)+r}return n},d=function(t,n,r){return 0===n?r:n%2==1?d(t,n-1,r*t):d(t*t,n/2,r)},y=function(t){for(var n=0,r=t;r>=4096;)n+=12,r/=4096;for(;r>=2;)n+=1,r/=2;return n};e(e.P+e.F*(!!c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(4)(function(){c.call({})})),"Number",{toFixed:function(t){var n,r,e,c,f=o(this,s),a=i(t),g="",b=l;if(a<0||a>20)throw RangeError(s);if(f!=f)return"NaN";if(f<=-1e21||f>=1e21)return String(f);if(f<0&&(g="-",f=-f),f>1e-21)if(n=y(f*d(2,69,1))-69,r=n<0?f*d(2,-n,1):f/d(2,n,1),r*=4503599627370496,(n=52-n)>0){for(h(0,r),e=a;e>=7;)h(1e7,0),e-=7;for(h(d(10,e,1),0),e=n-1;e>=23;)v(1<<23),e-=23;v(1<<e),h(1,1),v(2),b=p()}else h(0,r),h(1<<-n,0),b=p()+u.call(l,a);return a>0?(c=b.length,b=g+(c<=a?"0."+u.call(l,a-c)+b:b.slice(0,c-a)+"."+b.slice(c-a))):b=g+b,b}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=r(159),u=1..toPrecision;e(e.P+e.F*(i(function(){return"1"!==u.call(1,void 0)})||!i(function(){u.call({})})),"Number",{toPrecision:function(t){var n=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?u.call(n):u.call(n,t)}})},function(t,n,r){var e=r(1);e(e.S+e.F,"Object",{assign:r(172)})},function(t,n,r){var e=r(1);e(e.S,"Object",{create:r(70)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperties:r(173)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperty:r(11).f})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("freeze",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(30),i=r(31).f;r(49)("getOwnPropertyDescriptor",function(){return function(t,n){return i(e(t),n)}})},function(t,n,r){r(49)("getOwnPropertyNames",function(){return r(174).f})},function(t,n,r){var e=r(17),i=r(32);r(49)("getPrototypeOf",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6);r(49)("isExtensible",function(t){return function(n){return!!e(n)&&(!t||t(n))}})},function(t,n,r){var e=r(6);r(49)("isFrozen",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(6);r(49)("isSealed",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(1);e(e.S,"Object",{is:r(180)})},function(t,n,r){var e=r(17),i=r(72);r(49)("keys",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("preventExtensions",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("seal",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(1);e(e.S,"Object",{setPrototypeOf:r(144).set})},function(t,n,r){"use strict";var e=r(114),i={};i[r(7)("toStringTag")]="z",i+""!="[object z]"&&r(28)(Object.prototype,"toString",function(){return"[object "+e(this)+"]"},!0)},function(t,n,r){var e=r(1),i=r(178);e(e.G+e.F*(parseFloat!=i),{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.G+e.F*(parseInt!=i),{parseInt:i})},function(t,n,r){"use strict";var e,i,o,u=r(69),c=r(3),f=r(53),a=r(114),s=r(1),l=r(6),h=r(26),v=r(68),p=r(79),d=r(146),y=r(151).set,g=r(143)(),b="Promise",m=c.TypeError,x=c.process,w=c[b],x=c.process,S="process"==a(x),_=function(){},O=!!function(){try{var t=w.resolve(1),n=(t.constructor={})[r(7)("species")]=function(t){t(_,_)};return(S||"function"==typeof PromiseRejectionEvent)&&t.then(_)instanceof n}catch(t){}}(),E=function(t,n){return t===n||t===w&&n===o},P=function(t){var n;return!(!l(t)||"function"!=typeof(n=t.then))&&n},j=function(t){return E(w,t)?new F(t):new i(t)},F=i=function(t){var n,r;this.promise=new t(function(t,e){if(void 0!==n||void 0!==r)throw m("Bad Promise constructor");n=t,r=e}),this.resolve=h(n),this.reject=h(r)},M=function(t){try{t()}catch(t){return{error:t}}},A=function(t,n){if(!t._n){t._n=!0;var r=t._c;g(function(){for(var e=t._v,i=1==t._s,o=0;r.length>o;)!function(n){var r,o,u=i?n.ok:n.fail,c=n.resolve,f=n.reject,a=n.domain;try{u?(i||(2==t._h&&I(t),t._h=1),!0===u?r=e:(a&&a.enter(),r=u(e),a&&a.exit()),r===n.promise?f(m("Promise-chain cycle")):(o=P(r))?o.call(r,c,f):c(r)):f(e)}catch(t){f(t)}}(r[o++]);t._c=[],t._n=!1,n&&!t._h&&N(t)})}},N=function(t){y.call(c,function(){var n,r,e,i=t._v;if(T(t)&&(n=M(function(){S?x.emit("unhandledRejection",i,t):(r=c.onunhandledrejection)?r({promise:t,reason:i}):(e=c.console)&&e.error&&e.error("Unhandled promise rejection",i)}),t._h=S||T(t)?2:1),t._a=void 0,n)throw n.error})},T=function(t){if(1==t._h)return!1;for(var n,r=t._a||t._c,e=0;r.length>e;)if(n=r[e++],n.fail||!T(n.promise))return!1;return!0},I=function(t){y.call(c,function(){var n;S?x.emit("rejectionHandled",t):(n=c.onrejectionhandled)&&n({promise:t,reason:t._v})})},k=function(t){var n=this;n._d||(n._d=!0,n=n._w||n,n._v=t,n._s=2,n._a||(n._a=n._c.slice()),A(n,!0))},L=function(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw m("Promise can't be resolved itself");(n=P(t))?g(function(){var e={_w:r,_d:!1};try{n.call(t,f(L,e,1),f(k,e,1))}catch(t){k.call(e,t)}}):(r._v=t,r._s=1,A(r,!1))}catch(t){k.call({_w:r,_d:!1},t)}}};O||(w=function(t){v(this,w,b,"_h"),h(t),e.call(this);try{t(f(L,this,1),f(k,this,1))}catch(t){k.call(this,t)}},e=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},e.prototype=r(73)(w.prototype,{then:function(t,n){var r=j(d(this,w));return r.ok="function"!=typeof t||t,r.fail="function"==typeof n&&n,r.domain=S?x.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&A(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),F=function(){var t=new e;this.promise=t,this.resolve=f(L,t,1),this.reject=f(k,t,1)}),s(s.G+s.W+s.F*!O,{Promise:w}),r(81)(w,b),r(74)(b),o=r(52)[b],s(s.S+s.F*!O,b,{reject:function(t){var n=j(this);return(0,n.reject)(t),n.promise}}),s(s.S+s.F*(u||!O),b,{resolve:function(t){if(t instanceof w&&E(t.constructor,this))return t;var n=j(this);return(0,n.resolve)(t),n.promise}}),s(s.S+s.F*!(O&&r(123)(function(t){w.all(t).catch(_)})),b,{all:function(t){var n=this,r=j(n),e=r.resolve,i=r.reject,o=M(function(){var r=[],o=0,u=1;p(t,!1,function(t){var c=o++,f=!1;r.push(void 0),u++,n.resolve(t).then(function(t){f||(f=!0,r[c]=t,--u||e(r))},i)}),--u||e(r)});return o&&i(o.error),r.promise},race:function(t){var n=this,r=j(n),e=r.reject,i=M(function(){p(t,!1,function(t){n.resolve(t).then(r.resolve,e)})});return i&&e(i.error),r.promise}})},function(t,n,r){var e=r(1),i=r(26),o=r(2),u=(r(3).Reflect||{}).apply,c=Function.apply;e(e.S+e.F*!r(4)(function(){u(function(){})}),"Reflect",{apply:function(t,n,r){var e=i(t),f=o(r);return u?u(e,n,f):c.call(e,n,f)}})},function(t,n,r){var e=r(1),i=r(70),o=r(26),u=r(2),c=r(6),f=r(4),a=r(163),s=(r(3).Reflect||{}).construct,l=f(function(){function t(){}return!(s(function(){},[],t)instanceof t)}),h=!f(function(){s(function(){})});e(e.S+e.F*(l||h),"Reflect",{construct:function(t,n){o(t),u(n);var r=arguments.length<3?t:o(arguments[2]);if(h&&!l)return s(t,n,r);if(t==r){switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3])}var e=[null];return e.push.apply(e,n),new(a.apply(t,e))}var f=r.prototype,v=i(c(f)?f:Object.prototype),p=Function.apply.call(t,v,n);return c(p)?p:v}})},function(t,n,r){var e=r(11),i=r(1),o=r(2),u=r(50);i(i.S+i.F*r(4)(function(){Reflect.defineProperty(e.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,n,r){o(t),n=u(n,!0),o(r);try{return e.f(t,n,r),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(31).f,o=r(2);e(e.S,"Reflect",{deleteProperty:function(t,n){var r=i(o(t),n);return!(r&&!r.configurable)&&delete t[n]}})},function(t,n,r){"use strict";var e=r(1),i=r(2),o=function(t){this._t=i(t),this._i=0;var n,r=this._k=[];for(n in t)r.push(n)};r(139)(o,"Object",function(){var t,n=this,r=n._k;do{if(n._i>=r.length)return{value:void 0,done:!0}}while(!((t=r[n._i++])in n._t));return{value:t,done:!1}}),e(e.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,n,r){var e=r(31),i=r(1),o=r(2);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,n){return e.f(o(t),n)}})},function(t,n,r){var e=r(1),i=r(32),o=r(2);e(e.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,n,r){function e(t,n){var r,c,s=arguments.length<3?t:arguments[2];return a(t)===s?t[n]:(r=i.f(t,n))?u(r,"value")?r.value:void 0!==r.get?r.get.call(s):void 0:f(c=o(t))?e(c,n,s):void 0}var i=r(31),o=r(32),u=r(24),c=r(1),f=r(6),a=r(2);c(c.S,"Reflect",{get:e})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{has:function(t,n){return n in t}})},function(t,n,r){var e=r(1),i=r(2),o=Object.isExtensible;e(e.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{ownKeys:r(177)})},function(t,n,r){var e=r(1),i=r(2),o=Object.preventExtensions;e(e.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(144);i&&e(e.S,"Reflect",{setPrototypeOf:function(t,n){i.check(t,n);try{return i.set(t,n),!0}catch(t){return!1}}})},function(t,n,r){function e(t,n,r){var f,h,v=arguments.length<4?t:arguments[3],p=o.f(s(t),n);if(!p){if(l(h=u(t)))return e(h,n,r,v);p=a(0)}return c(p,"value")?!(!1===p.writable||!l(v)||(f=o.f(v,n)||a(0),f.value=r,i.f(v,n,f),0)):void 0!==p.set&&(p.set.call(v,r),!0)}var i=r(11),o=r(31),u=r(32),c=r(24),f=r(1),a=r(66),s=r(2),l=r(6);f(f.S,"Reflect",{set:e})},function(t,n,r){var e=r(3),i=r(136),o=r(11).f,u=r(71).f,c=r(122),f=r(120),a=e.RegExp,s=a,l=a.prototype,h=/a/g,v=/a/g,p=new a(h)!==h;if(r(10)&&(!p||r(4)(function(){return v[r(7)("match")]=!1,a(h)!=h||a(v)==v||"/a/i"!=a(h,"i")}))){a=function(t,n){var r=this instanceof a,e=c(t),o=void 0===n;return!r&&e&&t.constructor===a&&o?t:i(p?new s(e&&!o?t.source:t,n):s((e=t instanceof a)?t.source:t,e&&o?f.call(t):n),r?this:l,a)};for(var d=u(s),y=0;d.length>y;)!function(t){t in a||o(a,t,{configurable:!0,get:function(){return s[t]},set:function(n){s[t]=n}})}(d[y++]);l.constructor=a,a.prototype=l,r(28)(e,"RegExp",a)}r(74)("RegExp")},function(t,n,r){r(119)("match",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("replace",2,function(t,n,r){return[function(e,i){"use strict";var o=t(this),u=void 0==e?void 0:e[n];return void 0!==u?u.call(e,o,i):r.call(String(o),e,i)},r]})},function(t,n,r){r(119)("search",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("split",2,function(t,n,e){"use strict";var i=r(122),o=e,u=[].push,c="split",f="length",a="lastIndex";if("c"=="abbc"[c](/(b)*/)[1]||4!="test"[c](/(?:)/,-1)[f]||2!="ab"[c](/(?:ab)*/)[f]||4!="."[c](/(.?)(.?)/)[f]||"."[c](/()()/)[f]>1||""[c](/.?/)[f]){var s=void 0===/()??/.exec("")[1];e=function(t,n){var r=String(this);if(void 0===t&&0===n)return[];if(!i(t))return o.call(r,t,n);var e,c,l,h,v,p=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),y=0,g=void 0===n?4294967295:n>>>0,b=new RegExp(t.source,d+"g");for(s||(e=new RegExp("^"+b.source+"$(?!\\s)",d));(c=b.exec(r))&&!((l=c.index+c[0][f])>y&&(p.push(r.slice(y,c.index)),!s&&c[f]>1&&c[0].replace(e,function(){for(v=1;v<arguments[f]-2;v++)void 0===arguments[v]&&(c[v]=void 0)}),c[f]>1&&c.index<r[f]&&u.apply(p,c.slice(1)),h=c[0][f],y=l,p[f]>=g));)b[a]===c.index&&b[a]++;return y===r[f]?!h&&b.test("")||p.push(""):p.push(r.slice(y)),p[f]>g?p.slice(0,g):p}}else"0"[c](void 0,0)[f]&&(e=function(t,n){return void 0===t&&0===n?[]:o.call(this,t,n)});return[function(r,i){var o=t(this),u=void 0==r?void 0:r[n];return void 0!==u?u.call(r,o,i):e.call(String(o),r,i)},e]})},function(t,n,r){"use strict";r(184);var e=r(2),i=r(120),o=r(10),u="toString",c=/./[u],f=function(t){r(28)(RegExp.prototype,u,t,!0)};r(4)(function(){return"/a/b"!=c.call({source:"a",flags:"b"})})?f(function(){var t=e(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):c.name!=u&&f(function(){return c.call(this)})},function(t,n,r){"use strict";r(29)("anchor",function(t){return function(n){return t(this,"a","name",n)}})},function(t,n,r){"use strict";r(29)("big",function(t){return function(){return t(this,"big","","")}})},function(t,n,r){"use strict";r(29)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,n,r){"use strict";r(29)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!1);e(e.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="endsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{endsWith:function(t){var n=o(this,t,u),r=arguments.length>1?arguments[1]:void 0,e=i(n.length),f=void 0===r?e:Math.min(i(r),e),a=String(t);return c?c.call(n,a,f):n.slice(f-a.length,f)===a}})},function(t,n,r){"use strict";r(29)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,n,r){"use strict";r(29)("fontcolor",function(t){return function(n){return t(this,"font","color",n)}})},function(t,n,r){"use strict";r(29)("fontsize",function(t){return function(n){return t(this,"font","size",n)}})},function(t,n,r){var e=r(1),i=r(75),o=String.fromCharCode,u=String.fromCodePoint;e(e.S+e.F*(!!u&&1!=u.length),"String",{fromCodePoint:function(t){for(var n,r=[],e=arguments.length,u=0;e>u;){if(n=+arguments[u++],i(n,1114111)!==n)throw RangeError(n+" is not a valid code point");r.push(n<65536?o(n):o(55296+((n-=65536)>>10),n%1024+56320))}return r.join("")}})},function(t,n,r){"use strict";var e=r(1),i=r(148),o="includes";e(e.P+e.F*r(134)(o),"String",{includes:function(t){return!!~i(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,n,r){"use strict";r(29)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,n,r){"use strict";var e=r(147)(!0);r(140)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";r(29)("link",function(t){return function(n){return t(this,"a","href",n)}})},function(t,n,r){var e=r(1),i=r(30),o=r(16);e(e.S,"String",{raw:function(t){for(var n=i(t.raw),r=o(n.length),e=arguments.length,u=[],c=0;r>c;)u.push(String(n[c++])),c<e&&u.push(String(arguments[c]));return u.join("")}})},function(t,n,r){var e=r(1);e(e.P,"String",{repeat:r(149)})},function(t,n,r){"use strict";r(29)("small",function(t){return function(){return t(this,"small","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="startsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{startsWith:function(t){var n=o(this,t,u),r=i(Math.min(arguments.length>1?arguments[1]:void 0,n.length)),e=String(t);return c?c.call(n,e,r):n.slice(r,r+e.length)===e}})},function(t,n,r){"use strict";r(29)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,n,r){"use strict";r(29)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,n,r){"use strict";r(29)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,n,r){"use strict";r(82)("trim",function(t){return function(){return t(this,3)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(10),u=r(1),c=r(28),f=r(65).KEY,a=r(4),s=r(126),l=r(81),h=r(76),v=r(7),p=r(182),d=r(153),y=r(206),g=r(205),b=r(138),m=r(2),x=r(30),w=r(50),S=r(66),_=r(70),O=r(174),E=r(31),P=r(11),j=r(72),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(71).f=O.f=Z,r(116).f=X,r(125).f=tt,o&&!r(69)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(27)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){"use strict";var e=r(1),i=r(127),o=r(152),u=r(2),c=r(75),f=r(16),a=r(6),s=r(3).ArrayBuffer,l=r(146),h=o.ArrayBuffer,v=o.DataView,p=i.ABV&&s.isView,d=h.prototype.slice,y=i.VIEW,g="ArrayBuffer";e(e.G+e.W+e.F*(s!==h),{ArrayBuffer:h}),e(e.S+e.F*!i.CONSTR,g,{isView:function(t){return p&&p(t)||a(t)&&y in t}}),e(e.P+e.U+e.F*r(4)(function(){return!new h(2).slice(1,void 0).byteLength}),g,{slice:function(t,n){if(void 0!==d&&void 0===n)return d.call(u(this),t);for(var r=u(this).byteLength,e=c(t,r),i=c(void 0===n?r:n,r),o=new(l(this,h))(f(i-e)),a=new v(this),s=new v(o),p=0;e<i;)s.setUint8(p++,a.getUint8(e++));return o}}),r(74)(g)},function(t,n,r){var e=r(1);e(e.G+e.W+e.F*!r(127).ABV,{DataView:r(152).DataView})},function(t,n,r){r(55)("Float32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Float64",8,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}},!0)},function(t,n,r){"use strict";var e=r(166);r(118)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t,!0)}},e,!1,!0)},function(t,n,r){"use strict";var e=r(1),i=r(117)(!0);e(e.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)("includes")},function(t,n,r){var e=r(1),i=r(143)(),o=r(3).process,u="process"==r(45)(o);e(e.G,{asap:function(t){var n=u&&o.domain;i(n?n.bind(t):t)}})},function(t,n,r){var e=r(1),i=r(45);e(e.S,"Error",{isError:function(t){return"Error"===i(t)}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Map",{toJSON:r(165)("Map")})},function(t,n,r){var e=r(1);e(e.S,"Math",{iaddh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o+(e>>>0)+((i&u|(i|u)&~(i+u>>>0))>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{imulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>16,f=i>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>16)+((o*f>>>0)+(a&r)>>16)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{isubh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o-(e>>>0)-((~i&u|~(i^u)&i-u>>>0)>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{umulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>>16,f=i>>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>>16)+((o*f>>>0)+(a&r)>>>16)}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineGetter__:function(t,n){u.f(i(this),t,{get:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineSetter__:function(t,n){u.f(i(this),t,{set:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){var e=r(1),i=r(176)(!0);e(e.S,"Object",{entries:function(t){return i(t)}})},function(t,n,r){var e=r(1),i=r(177),o=r(30),u=r(31),c=r(131);e(e.S,"Object",{getOwnPropertyDescriptors:function(t){for(var n,r=o(t),e=u.f,f=i(r),a={},s=0;f.length>s;)c(a,n=f[s++],e(r,n));return a}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupGetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.get}while(r=u(r))}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupSetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.set}while(r=u(r))}})},function(t,n,r){var e=r(1),i=r(176)(!1);e(e.S,"Object",{values:function(t){return i(t)}})},function(t,n,r){"use strict";var e=r(1),i=r(3),o=r(52),u=r(143)(),c=r(7)("observable"),f=r(26),a=r(2),s=r(68),l=r(73),h=r(27),v=r(79),p=v.RETURN,d=function(t){return null==t?void 0:f(t)},y=function(t){var n=t._c;n&&(t._c=void 0,n())},g=function(t){return void 0===t._o},b=function(t){g(t)||(t._o=void 0,y(t))},m=function(t,n){a(t),this._c=void 0,this._o=t,t=new x(this);try{var r=n(t),e=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){e.unsubscribe()}:f(r),this._c=r)}catch(n){return void t.error(n)}g(this)&&y(this)};m.prototype=l({},{unsubscribe:function(){b(this)}});var x=function(t){this._s=t};x.prototype=l({},{next:function(t){var n=this._s;if(!g(n)){var r=n._o;try{var e=d(r.next);if(e)return e.call(r,t)}catch(t){try{b(n)}finally{throw t}}}},error:function(t){var n=this._s;if(g(n))throw t;var r=n._o;n._o=void 0;try{var e=d(r.error);if(!e)throw t;t=e.call(r,t)}catch(t){try{y(n)}finally{throw t}}return y(n),t},complete:function(t){var n=this._s;if(!g(n)){var r=n._o;n._o=void 0;try{var e=d(r.complete);t=e?e.call(r,t):void 0}catch(t){try{y(n)}finally{throw t}}return y(n),t}}});var w=function(t){s(this,w,"Observable","_f")._f=f(t)};l(w.prototype,{subscribe:function(t){return new m(t,this._f)},forEach:function(t){var n=this;return new(o.Promise||i.Promise)(function(r,e){f(t);var i=n.subscribe({next:function(n){try{return t(n)}catch(t){e(t),i.unsubscribe()}},error:e,complete:r})})}}),l(w,{from:function(t){var n="function"==typeof this?this:w,r=d(a(t)[c]);if(r){var e=a(r.call(t));return e.constructor===n?e:new n(function(t){return e.subscribe(t)})}return new n(function(n){var r=!1;return u(function(){if(!r){try{if(v(t,!1,function(t){if(n.next(t),r)return p})===p)return}catch(t){if(r)throw t;return void n.error(t)}n.complete()}}),function(){r=!0}})},of:function(){for(var t=0,n=arguments.length,r=Array(n);t<n;)r[t]=arguments[t++];return new("function"==typeof this?this:w)(function(t){var n=!1;return u(function(){if(!n){for(var e=0;e<r.length;++e)if(t.next(r[e]),n)return;t.complete()}}),function(){n=!0}})}}),h(w.prototype,c,function(){return this}),e(e.G,{Observable:w}),r(74)("Observable")},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.set;e.exp({defineMetadata:function(t,n,r,e){u(t,n,i(r),o(e))}})},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.map,c=e.store;e.exp({deleteMetadata:function(t,n){var r=arguments.length<3?void 0:o(arguments[2]),e=u(i(n),r,!1);if(void 0===e||!e.delete(t))return!1;if(e.size)return!0;var f=c.get(n);return f.delete(r),!!f.size||c.delete(n)}})},function(t,n,r){var e=r(185),i=r(161),o=r(54),u=r(2),c=r(32),f=o.keys,a=o.key,s=function(t,n){var r=f(t,n),o=c(t);if(null===o)return r;var u=s(o,n);return u.length?r.length?i(new e(r.concat(u))):u:r};o.exp({getMetadataKeys:function(t){return s(u(t),arguments.length<2?void 0:a(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.get,f=e.key,a=function(t,n,r){if(u(t,n,r))return c(t,n,r);var e=o(n);return null!==e?a(t,e,r):void 0};e.exp({getMetadata:function(t,n){return a(t,i(n),arguments.length<3?void 0:f(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.keys,u=e.key;e.exp({getOwnMetadataKeys:function(t){
return o(i(t),arguments.length<2?void 0:u(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.get,u=e.key;e.exp({getOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.key,f=function(t,n,r){if(u(t,n,r))return!0;var e=o(n);return null!==e&&f(t,e,r)};e.exp({hasMetadata:function(t,n){return f(t,i(n),arguments.length<3?void 0:c(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.has,u=e.key;e.exp({hasOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(26),u=e.key,c=e.set;e.exp({metadata:function(t,n){return function(r,e){c(t,n,(void 0!==e?i:o)(r),u(e))}}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Set",{toJSON:r(165)("Set")})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!0);e(e.P,"String",{at:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(46),o=r(16),u=r(122),c=r(120),f=RegExp.prototype,a=function(t,n){this._r=t,this._s=n};r(139)(a,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),e(e.P,"String",{matchAll:function(t){if(i(this),!u(t))throw TypeError(t+" is not a regexp!");var n=String(this),r="flags"in f?String(t.flags):c.call(t),e=new RegExp(t.source,~r.indexOf("g")?r:"g"+r);return e.lastIndex=o(t.lastIndex),new a(e,n)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,n,r){"use strict";r(82)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,n,r){"use strict";r(82)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,n,r){r(153)("asyncIterator")},function(t,n,r){r(153)("observable")},function(t,n,r){var e=r(1);e(e.S,"System",{global:r(3)})},function(t,n,r){for(var e=r(155),i=r(28),o=r(3),u=r(27),c=r(80),f=r(7),a=f("iterator"),s=f("toStringTag"),l=c.Array,h=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],v=0;v<5;v++){var p,d=h[v],y=o[d],g=y&&y.prototype;if(g){g[a]||u(g,a,l),g[s]||u(g,s,d),c[d]=l;for(p in e)g[p]||i(g,p,e[p],!0)}}},function(t,n,r){var e=r(1),i=r(151);e(e.G+e.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,n,r){var e=r(3),i=r(1),o=r(121),u=r(207),c=e.navigator,f=!!c&&/MSIE .\./.test(c.userAgent),a=function(t){return f?function(n,r){return t(o(u,[].slice.call(arguments,2),"function"==typeof n?n:Function(n)),r)}:t};i(i.G+i.B+i.F*f,{setTimeout:a(e.setTimeout),setInterval:a(e.setInterval)})},function(t,n,r){r(330),r(269),r(271),r(270),r(273),r(275),r(280),r(274),r(272),r(282),r(281),r(277),r(278),r(276),r(268),r(279),r(283),r(284),r(236),r(238),r(237),r(286),r(285),r(256),r(266),r(267),r(257),r(258),r(259),r(260),r(261),r(262),r(263),r(264),r(265),r(239),r(240),r(241),r(242),r(243),r(244),r(245),r(246),r(247),r(248),r(249),r(250),r(251),r(252),r(253),r(254),r(255),r(317),r(322),r(329),r(320),r(312),r(313),r(318),r(323),r(325),r(308),r(309),r(310),r(311),r(314),r(315),r(316),r(319),r(321),r(324),r(326),r(327),r(328),r(231),r(233),r(232),r(235),r(234),r(220),r(218),r(224),r(221),r(227),r(229),r(217),r(223),r(214),r(228),r(212),r(226),r(225),r(219),r(222),r(211),r(213),r(216),r(215),r(230),r(155),r(302),r(307),r(184),r(303),r(304),r(305),r(306),r(287),r(183),r(185),r(186),r(342),r(331),r(332),r(337),r(340),r(341),r(335),r(338),r(336),r(339),r(333),r(334),r(288),r(289),r(290),r(291),r(292),r(295),r(293),r(294),r(296),r(297),r(298),r(299),r(301),r(300),r(343),r(369),r(372),r(371),r(373),r(374),r(370),r(375),r(376),r(354),r(357),r(353),r(351),r(352),r(355),r(356),r(346),r(368),r(377),r(345),r(347),r(349),r(348),r(350),r(359),r(360),r(362),r(361),r(364),r(363),r(365),r(366),r(367),r(344),r(358),r(380),r(379),r(378),t.exports=r(52)},function(t,n){function r(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var r=t.nextSibling;return r?t.parentNode.insertBefore(n,r):t.parentNode.appendChild(n)}t.exports=r},,,,,,,,,function(t,n,r){(function(n,r){!function(n){"use strict";function e(t,n,r,e){var i=n&&n.prototype instanceof o?n:o,u=Object.create(i.prototype),c=new p(e||[]);return u._invoke=s(t,r,c),u}function i(t,n,r){try{return{type:"normal",arg:t.call(n,r)}}catch(t){return{type:"throw",arg:t}}}function o(){}function u(){}function c(){}function f(t){["next","throw","return"].forEach(function(n){t[n]=function(t){return this._invoke(n,t)}})}function a(t){function n(r,e,o,u){var c=i(t[r],t,e);if("throw"!==c.type){var f=c.arg,a=f.value;return a&&"object"==typeof a&&m.call(a,"__await")?Promise.resolve(a.__await).then(function(t){n("next",t,o,u)},function(t){n("throw",t,o,u)}):Promise.resolve(a).then(function(t){f.value=t,o(f)},u)}u(c.arg)}function e(t,r){function e(){return new Promise(function(e,i){n(t,r,e,i)})}return o=o?o.then(e,e):e()}"object"==typeof r&&r.domain&&(n=r.domain.bind(n));var o;this._invoke=e}function s(t,n,r){var e=P;return function(o,u){if(e===F)throw new Error("Generator is already running");if(e===M){if("throw"===o)throw u;return y()}for(r.method=o,r.arg=u;;){var c=r.delegate;if(c){var f=l(c,r);if(f){if(f===A)continue;return f}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(e===P)throw e=M,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);e=F;var a=i(t,n,r);if("normal"===a.type){if(e=r.done?M:j,a.arg===A)continue;return{value:a.arg,done:r.done}}"throw"===a.type&&(e=M,r.method="throw",r.arg=a.arg)}}}function l(t,n){var r=t.iterator[n.method];if(r===g){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=g,l(t,n),"throw"===n.method))return A;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var e=i(r,t.iterator,n.arg);if("throw"===e.type)return n.method="throw",n.arg=e.arg,n.delegate=null,A;var o=e.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=g),n.delegate=null,A):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,A)}function h(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function v(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function p(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(h,this),this.reset(!0)}function d(t){if(t){var n=t[w];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,e=function n(){for(;++r<t.length;)if(m.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=g,n.done=!0,n};return e.next=e}}return{next:y}}function y(){return{value:g,done:!0}}var g,b=Object.prototype,m=b.hasOwnProperty,x="function"==typeof Symbol?Symbol:{},w=x.iterator||"@@iterator",S=x.asyncIterator||"@@asyncIterator",_=x.toStringTag||"@@toStringTag",O="object"==typeof t,E=n.regeneratorRuntime;if(E)return void(O&&(t.exports=E));E=n.regeneratorRuntime=O?t.exports:{},E.wrap=e;var P="suspendedStart",j="suspendedYield",F="executing",M="completed",A={},N={};N[w]=function(){return this};var T=Object.getPrototypeOf,I=T&&T(T(d([])));I&&I!==b&&m.call(I,w)&&(N=I);var k=c.prototype=o.prototype=Object.create(N);u.prototype=k.constructor=c,c.constructor=u,c[_]=u.displayName="GeneratorFunction",E.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===u||"GeneratorFunction"===(n.displayName||n.name))},E.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,_ in t||(t[_]="GeneratorFunction")),t.prototype=Object.create(k),t},E.awrap=function(t){return{__await:t}},f(a.prototype),a.prototype[S]=function(){return this},E.AsyncIterator=a,E.async=function(t,n,r,i){var o=new a(e(t,n,r,i));return E.isGeneratorFunction(n)?o:o.next().then(function(t){return t.done?t.value:o.next()})},f(k),k[_]="Generator",k.toString=function(){return"[object Generator]"},E.keys=function(t){var n=[];for(var r in t)n.push(r);return n.reverse(),function r(){for(;n.length;){var e=n.pop();if(e in t)return r.value=e,r.done=!1,r}return r.done=!0,r}},E.values=d,p.prototype={constructor:p,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(v),!t)for(var n in this)"t"===n.charAt(0)&&m.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){function n(n,e){return o.type="throw",o.arg=t,r.next=n,e&&(r.method="next",r.arg=g),!!e}if(this.done)throw t;for(var r=this,e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=m.call(i,"catchLoc"),c=m.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc<=this.prev&&m.call(e,"finallyLoc")&&this.prev<e.finallyLoc){var i=e;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=n,i?(this.method="next",this.next=i.finallyLoc,A):this.complete(o)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),A},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),v(r),A}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var e=r.completion;if("throw"===e.type){var i=e.arg;v(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:d(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=g),A}}}("object"==typeof n?n:"object"==typeof window?window:"object"==typeof self?self:this)}).call(n,function(){return this}(),r(158))}])</script><script src="/./main.0cf68a.js"></script><script>!function(){!function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)}("/slider.e37972.js")}()</script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">All Posts</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">Links</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">About</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">pwn</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">windows</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">kernel</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">promotion</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">ctf</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">heap</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">cve</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">pkexec</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">fuzzing</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">reads</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">web</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">prototype pollution</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">HTB</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">browser</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">v8</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">redteam</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">activedirectory</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">prompteng</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">injection</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">shellcoding</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">sudo</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">symex</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、请确保node版本大于6.2<br/>2、在博客根目录（注意不是yilia根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            3、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: false
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="http://eeeeeeeeeeeeeeeea.cn/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>晨晨</a>
            </li>
          
            <li class="search-li">
              <a href="https://peacesh4wn.github.io/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>sh4wn</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">赐我孩童般的好奇</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>